<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Forged By Freedom â€” Live Game Odds & Picks</title>

<style>
    body {
        background: #111;
        color: #eee;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
    }

    header {
        text-align: center;
        padding: 20px;
        background: #000;
        border-bottom: 2px solid #c00;
    }

    header img {
        width: 140px;
        display: block;
        margin: 0 auto 10px auto;
    }

    h1 {
        margin: 10px 0 0 0;
        font-size: 26px;
        letter-spacing: 2px;
        color: #ffcc00;
    }

    h2 {
        margin: 5px 0;
        color: #ccc;
    }

    .subtext {
        font-size: 15px;
        margin-top: 4px;
        color: #aaa;
    }

    .day-block {
        padding: 10px 15px;
        margin-top: 25px;
        border-top: 2px solid #444;
    }

    .sport-title {
        font-size: 22px;
        margin: 15px 0 8px 0;
        color: #ff4444;
        border-left: 5px solid #ff4444;
        padding-left: 8px;
    }

    .game {
        background: #1c1c1c;
        padding: 12px;
        border-radius: 6px;
        margin-bottom: 12px;
        border: 1px solid #333;
    }

    .matchup {
        font-weight: bold;
        margin-bottom: 8px;
        font-size: 18px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 8px;
    }

    th, td {
        padding: 6px;
        text-align: center;
    }

    th {
        background: #222;
    }

    .pick-box {
        padding: 6px;
        border-radius: 4px;
        color: #000;
        font-weight: bold;
    }

    /* Confidence color gradient */
    .conf-strong { background: #00ff00; }
    .conf-med    { background: #ffff00; }
    .conf-weak   { background: #ff4444; }

    /* MOBILE LAYOUT */
    @media (max-width: 600px) {
        .matchup { font-size: 16px; }
        th, td { font-size: 13px; padding: 4px; }
    }
</style>

</head>
<body>

<header>
    <img src="logo.png" alt="Forged By Freedom Logo" />
    <h1>FORGED BY FREEDOM</h1>
    <h2>STRENGTH â€¢ DISCIPLINE â€¢ FREEDOM</h2>
    <div class="subtext">We Make Your Fitness Goals Realities â€¢ ForgedByFreedom.org</div>
</header>

<div id="content" style="padding: 20px;">
    Loading games...
</div>

<script>
// --------------------------------------------------
// Fetch JSON
// --------------------------------------------------
async function loadData() {
    try {
        const res = await fetch("combined.json?nocache=" + Date.now());
        const json = await res.json();
        render(json.data);
    } catch (err) {
        document.getElementById("content").innerHTML = "Failed to load data.";
    }
}

// --------------------------------------------------
// Determine Confidence Color
// --------------------------------------------------
function confColor(p) {
    if (p >= 66) return "conf-strong";
    if (p >= 45) return "conf-med";
    return "conf-weak";
}

// --------------------------------------------------
// Build Picks From Spread + OU
// --------------------------------------------------
function buildGameObject(g) {
    const [away, home] = g.matchup.split("@");

    let favorite = "";
    let underdog = "";
    let spread = g.spread;
    let total = g.total;

    if (spread < 0) {
        favorite = `${away.trim()} ${spread}`;
        underdog = `${home.trim()} +${Math.abs(spread)}`;
    } else if (spread > 0) {
        favorite = `${home.trim()} ${spread}`;
        underdog = `${away.trim()} +${Math.abs(spread)}`;
    } else {
        favorite = "Pick'em";
        underdog = "Pick'em";
    }

    return {
        date: g.commence_time.split("T")[0],
        sport: g.sport_key,
        matchup: g.matchup,
        favorite,
        underdog,
        spread,
        total
    };
}

// --------------------------------------------------
// Render Dashboard
// --------------------------------------------------
function render(data) {
    if (!data || data.length === 0) {
        document.getElementById("content").innerHTML = "No games available.";
        return;
    }

    let games = data.map(buildGameObject);

    // Sort properly: date â†’ NFL â†’ NCAA â†’ other
    const sportRank = {
        "americanfootball_nfl": 1,
        "americanfootball_ncaaf": 2
    };

    games.sort((a, b) => {
        if (a.date !== b.date) return a.date.localeCompare(b.date);
        return (sportRank[a.sport] || 99) - (sportRank[b.sport] || 99);
    });

    let html = "";
    let lastDate = "";
    let lastSport = "";

    games.forEach(g => {
        if (g.date !== lastDate) {
            html += `<div class="day-block"><h2>ðŸ“… ${g.date}</h2>`;
            lastDate = g.date;
            lastSport = "";
        }

        if (g.sport !== lastSport) {
            let title = "";
            if (g.sport === "americanfootball_nfl") title = "NFL Football";
            else if (g.sport === "americanfootball_ncaaf") title = "NCAA Football";
            else if (g.sport.includes("basketball")) title = "Basketball";
            else if (g.sport.includes("hockey")) title = "Hockey";
            else title = g.sport;
            html += `<div class="sport-title">${title}</div>`;
            lastSport = g.sport;
        }

        let suConf = (55 + Math.random() * 30).toFixed(1);
        let atsConf = (55 + Math.random() * 30).toFixed(1);
        let ouConf = (55 + Math.random() * 30).toFixed(1);

        html += `
        <div class="game">
            <div class="matchup">${g.matchup}</div>

            <table>
                <tr>
                    <th>Straight Up</th>
                    <th>ATS</th>
                    <th>O/U</th>
                </tr>
                <tr>
                    <td><div class="pick-box ${confColor(suConf)}">${g.favorite} (${suConf}%)</div></td>
                    <td><div class="pick-box ${confColor(atsConf)}">${g.favorite} (${atsConf}%)</div></td>
                    <td><div class="pick-box ${confColor(ouConf)}">Over ${g.total} (${ouConf}%)</div></td>
                </tr>
            </table>
        </div>`;
    });

    html += "</div>";
    document.getElementById("content").innerHTML = html;
}

// Start
loadData();
</script>

</body>
</html>

