<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Forged by Freedom â€” Live Game Odds & Picks</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#0d1117;color:#e6edf3;margin:0}
  header{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;background:#141a22;padding:1rem;border-bottom:2px solid #feca1b}
  header img{height:60px;width:60px;border-radius:50%;object-fit:cover;margin-right:10px}
  h1{color:#feca1b;font-size:1.8rem;margin:0;text-align:center}
  h3{color:#00c6ff;margin:4px 0;text-align:center}
  h3 a{color:#00c6ff;text-decoration:none}
  .legend{display:flex;justify-content:center;gap:20px;margin:1rem auto;flex-wrap:wrap}
  .legend-item{display:flex;align-items:center;gap:6px;font-size:.9rem}
  .color-box{width:20px;height:20px;border-radius:3px}
  .day-section{margin:2rem auto;width:92%;border-top:2px solid #feca1b;padding-top:1rem}
  .sport-header{text-align:left;color:#feca1b;font-size:1.3rem;border-bottom:1px solid #444;padding-bottom:.3rem;margin-top:1rem}
  table{width:100%;margin:1rem auto;border-collapse:collapse;background:#18222d;border-radius:10px;overflow:hidden}
  th,td{padding:10px;border-bottom:1px solid #333;text-align:center}
  th{background:#243447;color:#feca1b}
  tr:nth-child(even){background:#1c2833}
  #performance{background:#141a22;border:1px solid #333;margin:20px auto;width:80%;border-radius:10px;padding:10px;color:#feca1b;text-align:center}
  footer{margin:2rem 0;color:#aaa;font-size:.9rem;text-align:center}
</style>
</head>
<body>
<header>
  <img src="logo.png" alt="Forged by Freedom Logo">
  <div>
    <h1>Forged by Freedom â€” Live Game Odds & Picks</h1>
    <h3>Strength Â· Discipline Â· Freedom Â· We make your fitness goals realities!</h3>
    <h3><a href="https://forgedbyfreedom.org">ForgedByFreedom.org</a></h3>
  </div>
</header>

<div class="legend">
  <div class="legend-item"><div class="color-box" style="background:#00e676"></div> Strong (â‰¥70%)</div>
  <div class="legend-item"><div class="color-box" style="background:#ffeb3b"></div> Solid (55â€“69%)</div>
  <div class="legend-item"><div class="color-box" style="background:#ff5722"></div> Weak (<55%)</div>
</div>

<div id="performance">Loading weekly performanceâ€¦</div>
<div id="oddsContainer"><p style="text-align:center;">Loading gamesâ€¦</p></div>
<footer>Updated automatically Â· Powered by Forged by Freedom Data</footer>

<script>
function confidenceColor(v){
  if(v>=70) return '#00e676';
  if(v>=55) return '#ffeb3b';
  return '#ff5722';
}
function clamp(v,min,max){return Math.max(min,Math.min(max,v))}

const SPORT_BASE_TOTAL={americanfootball_nfl:45,americanfootball_ncaaf:55,basketball_nba:225,icehockey_nhl:6,baseball_mlb:9};
const SPORT_MULTIPLIER={americanfootball_nfl:1.08,americanfootball_ncaaf:1.04,basketball_nba:1.0,baseball_mlb:0.95,icehockey_nhl:0.9};

async function loadAll(){
  const [oddsRes,perfRes]=await Promise.allSettled([
    fetch("combined.json"),fetch("performance_log.json")
  ]);
  const odds=oddsRes.status==="fulfilled"?await oddsRes.value.json():{data:[]};
  const perf=perfRes.status==="fulfilled"?await perfRes.value.json():[];
  const latest=perf.length?perf.at(-1):{SU_accuracy:68,ATS_accuracy:62,OU_accuracy:58};
  const games=odds.data||[];
  const cont=document.getElementById("oddsContainer");
  cont.innerHTML="";

  if(!games.length){
    cont.innerHTML="<p style='text-align:center;'>No games available.</p>";
    return;
  }

  const byDay={};
  for(const g of games){
    const d=new Date(g.commence_time).toLocaleDateString(undefined,{weekday:'long',month:'short',day:'numeric'});
    (byDay[d]??=[]).push(g);
  }

  const sportOrder=["americanfootball_nfl","americanfootball_ncaaf"];

  for(const day of Object.keys(byDay).sort((a,b)=>new Date(a)-new Date(b))){
    const daySec=document.createElement("div");
    daySec.className="day-section";
    daySec.innerHTML=`<h2 style="color:#00c6ff;">${day}</h2>`;
    cont.appendChild(daySec);

    const bySport={};
    for(const g of byDay[day]) (bySport[g.sport_key]??=[]).push(g);

    for(const sport of Object.keys(bySport).sort((a,b)=>{
      const A=sportOrder.indexOf(a),B=sportOrder.indexOf(b);
      return (B-A)||(a>b?1:-1);
    })){
      const sportTitle=sport.replace("americanfootball_","").toUpperCase();
      const sportHeader=document.createElement("div");
      sportHeader.className="sport-header";
      sportHeader.textContent=sportTitle;
      daySec.appendChild(sportHeader);

      const table=document.createElement("table");
      table.innerHTML=`<thead><tr>
        <th>Matchup</th><th>Straight Up</th><th>ATS</th><th>Over/Under</th><th>Book</th>
      </tr></thead><tbody></tbody>`;
      const tb=table.querySelector("tbody");

      const baseTot=SPORT_BASE_TOTAL[sport]||50;
      const mult=SPORT_MULTIPLIER[sport]||1.0;
      const suAcc=latest.SU_accuracy||68, atsAcc=latest.ATS_accuracy||62, ouAcc=latest.OU_accuracy||58;

      for(const g of bySport[sport]){
        const sp=(typeof g.fav_spread==="number")?g.fav_spread:0;
        const tot=g.total??baseTot;

        const su=clamp((100-(Math.abs(sp)*4))*mult*(suAcc/100),45,98);
        const ats=clamp((100-(Math.abs(sp)*6))*mult*(atsAcc/100),40,95);
        const ou=clamp((100-(Math.abs(tot-baseTot)*1.2))*mult*(ouAcc/100),40,90);

        const ouPick=Math.random()>0.5?"Over":"Under";
        const spreadTxt=sp===0?"PK":(sp>0?`+${sp}`:sp.toString());

        tb.innerHTML+=`
          <tr>
            <td>${g.matchup}</td>
            <td style="color:${confidenceColor(su)}">${g.favorite_team??'-'} (${su.toFixed(1)}%)</td>
            <td style="color:${confidenceColor(ats)}">${g.favorite_team??'-'} ${spreadTxt} (${ats.toFixed(1)}%)</td>
            <td style="color:${confidenceColor(ou)}">${ouPick} ${g.total??'-'} (${ou.toFixed(1)}%)</td>
            <td>${g.book}</td>
          </tr>`;
      }
      daySec.appendChild(table);
    }
  }
}

async function loadPerformance(){
  try{
    const r=await fetch("performance_log.json");
    const logs=await r.json();
    const last=logs.at(-1);
    const div=document.getElementById("performance");
    div.innerHTML=last?`
      <h2>ðŸ“Š Weekly Accuracy</h2>
      <p>Straight Up (SU): ${last.SU_accuracy}%</p>
      <p>Against the Spread (ATS): ${last.ATS_accuracy}%</p>
      <p>Over/Under (O/U): ${last.OU_accuracy}%</p>
      <p><small>Games Checked: ${last.games_checked}</small></p>`:
      "<p>No accuracy data logged yet.</p>";
  }catch(e){console.error(e);}
}

loadAll();
loadPerformance();
</script>
</body>
</html>

