<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forged By Freedom Betting Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body{
    margin:0; padding:0;
    background:#000; color:#fff;
    font-family: Arial, sans-serif;
  }

  .header{
    text-align:center;
    padding:30px 10px 20px 10px;
    border-bottom:1px solid #222;
  }

  .glow{
    color:#ff8c00;
    text-shadow:0 0 12px #ff8c00,0 0 20px #ff6600,0 0 30px #ff4500;
    animation:pulse 2.5s infinite ease-in-out;
  }
  @keyframes pulse{
    0%{ text-shadow:0 0 10px #ff8c00; }
    50%{ text-shadow:0 0 25px #ff4500; }
    100%{ text-shadow:0 0 10px #ff8c00; }
  }

  a{ color:#ff8c00; text-decoration:none; }
  a:hover{ text-decoration:underline; }

  .stats-row{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
    padding:12px;
    max-width:1100px; margin:0 auto;
  }
  .stat-box{
    border:1px solid #222;
    background:#050505;
    padding:12px;
    text-align:center;
    border-radius:8px;
  }
  .stat-label{ font-size:13px; color:#aaa; }
  .stat-value{ font-size:28px; font-weight:bold; margin-top:4px; }

  .filters{
    display:flex; flex-wrap:wrap;
    justify-content:center;
    gap:8px;
    padding:10px 12px;
    border-top:1px solid #111;
    border-bottom:1px solid #111;
    background:#020202;
    position:sticky; top:0; z-index:5;
  }
  .filter-btn{
    cursor:pointer;
    padding:7px 12px;
    border-radius:999px;
    border:1px solid #333;
    font-size:13px;
    color:#ddd;
    background:#000;
    user-select:none;
  }
  .filter-btn.active{
    color:#000; background:#ff8c00; border-color:#ff8c00;
    font-weight:bold;
  }

  .picks-wrap{
    max-width:1100px; margin:12px auto 0 auto;
    padding:0 12px;
  }
  .picks-title{
    font-size:18px; margin:10px 0;
    color:#ff8c00; text-align:center;
  }
  .picks-box{
    border:1px solid #222;
    background:#050505;
    padding:10px;
    border-radius:8px;
  }
  .pick-item{
    border-bottom:1px solid #222;
    padding:8px 4px;
    font-size:14px;
  }
  .pick-item:last-child{ border-bottom:none; }
  .pick-strong{ color:#ff8c00; font-weight:bold; }

  .grid{
    max-width:1100px; margin:12px auto;
    padding:0 12px 30px 12px;
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
  }
  .game-card{
    border:1px solid #222;
    background:#050505;
    padding:12px;
    border-radius:8px;
  }
  .matchup{
    font-size:16px; font-weight:bold;
    margin-bottom:6px;
  }
  .line{
    font-size:14px; margin-top:3px;
  }
  .muted{ color:#999; font-size:12px; margin-top:3px; }
  .tag{ color:#ff8c00; font-weight:bold; margin-right:6px; }

  @media (max-width:900px){
    .stats-row{ grid-template-columns:1fr; }
    .grid{ grid-template-columns:1fr; }
  }
</style>
</head>
<body>

<div class="header">
  <div class="glow" style="font-size:18px;">
    üèà Live Odds + Picks Updated Every 15 Minutes ‚Ä¢ For Entertainment Only
  </div>

  <div class="glow" style="font-size:20px; margin-top:8px;">
    Provided to you by
    <a href="https://forgedbyfreedom.org" target="_blank">ForgedByFreedom.org</a>
  </div>

  <div class="glow" style="font-size:34px; margin-top:8px;">
    FORGED BY FREEDOM STRENGTH AND NUTRITION
  </div>

  <div class="glow" style="font-size:20px; margin-top:5px;">
    STRENGTH ‚Äì DISCIPLINE ‚Äì FREEDOM
  </div>

  <div style="margin-top:10px; font-size:15px; color:#ccc;">
    Visit us for all your fitness, nutrition and supplement program needs
    <br><br>
    <span style="font-size:13px; color:#666;">For entertainment purposes only</span>
  </div>
</div>

<div class="stats-row">
  <div class="stat-box">
    <div class="stat-label">Total Games</div>
    <div id="stat-total" class="stat-value">0</div>
  </div>
  <div class="stat-box">
    <div class="stat-label">Favorites Tagged</div>
    <div id="stat-favs" class="stat-value">0</div>
  </div>
  <div class="stat-box">
    <div class="stat-label">Picks Available</div>
    <div id="stat-picks" class="stat-value">0</div>
  </div>
</div>

<div class="filters" id="filters"></div>

<div class="picks-wrap">
  <div class="picks-title">üî• TODAY‚ÄôS PICKS (AUTO)</div>
  <div class="picks-box" id="picks-box">
    <div class="muted" style="text-align:center; padding:8px;">
      No picks yet ‚Äî will populate automatically when predictions.json builds.
    </div>
  </div>
</div>

<div class="grid" id="grid"></div>

<script>
const DATA_URL = "https://data.forgedbyfreedom.org/combined.json";
const REFRESH_MS = 15 * 60 * 1000;

let allGames = [];
let activeSport = "ALL";

async function loadJson(url){
  const r = await fetch(url, {cache:"no-store"});
  if(!r.ok) return null;
  return await r.json();
}

function sportLabel(s){
  return (s || "ALL").toUpperCase();
}

function safeTeam(t){
  if(!t) return "";
  if(typeof t === "string") return t;
  return t.name || t.abbr || "";
}

function getOddsLine(g){
  const o = g.odds || {};
  if(o.details) return o.details;
  if(o.spread != null){
    const fav = (o.spread < 0) ? safeTeam(g.home_team) : safeTeam(g.away_team);
    return `${fav} ${o.spread}`;
  }
  return "N/A";
}

function getPredictionText(g){
  const p = g.prediction || {};
  if(!p || typeof p !== "object") return "No prediction yet";

  return p.pick || p.bet || p.winner || p.recommendation || "No prediction yet";
}

function isPickGame(g){
  const p = g.prediction || {};
  if(!p || typeof p !== "object") return false;
  const txt = (p.pick || p.bet || p.winner || p.recommendation || "").toString().trim();
  return txt.length > 0;
}

function buildFilters(){
  const sports = new Set(["ALL"]);
  allGames.forEach(g => sports.add((g.sport || "").toUpperCase()));
  const filters = document.getElementById("filters");
  filters.innerHTML = "";

  [...sports].sort().forEach(s=>{
    const btn = document.createElement("div");
    btn.className = "filter-btn" + (s===activeSport ? " active":"");
    btn.textContent = s;
    btn.onclick = ()=>{
      activeSport = s;
      document.querySelectorAll(".filter-btn").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      render();
    };
    filters.appendChild(btn);
  });
}

function updateStats(){
  document.getElementById("stat-total").textContent = allGames.length;

  const favs = allGames.filter(g=>{
    return (g.favorite || g.fav_team || (g.flags||[]).includes("favorite"));
  }).length;
  document.getElementById("stat-favs").textContent = favs;

  const picks = allGames.filter(isPickGame).length;
  document.getElementById("stat-picks").textContent = picks;
}

function renderPicks(){
  const picksBox = document.getElementById("picks-box");
  const picks = allGames.filter(isPickGame);

  if(!picks.length){
    picksBox.innerHTML = `
      <div class="muted" style="text-align:center; padding:8px;">
        No picks yet ‚Äî will populate automatically when predictions.json builds.
      </div>`;
    return;
  }

  picksBox.innerHTML = "";
  picks.slice(0,50).forEach(g=>{
    const item = document.createElement("div");
    item.className = "pick-item";
    item.innerHTML = `
      <div class="pick-strong">${getPredictionText(g)}</div>
      <div>${safeTeam(g.away_team)} @ ${safeTeam(g.home_team)}</div>
      <div class="muted">Odds: ${getOddsLine(g)} | Total: ${g.odds?.total ?? "N/A"}</div>
    `;
    picksBox.appendChild(item);
  });
}

function renderGrid(games){
  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  games.forEach(g=>{
    const away = safeTeam(g.away_team);
    const home = safeTeam(g.home_team);
    const oddsLine = getOddsLine(g);
    const spread = g.odds?.spread ?? "N/A";
    const total = g.odds?.total ?? "N/A";
    const pred = getPredictionText(g);

    const w = g.weather || {};
    const wr = g.weatherRisk || {};
    let weatherTxt = "N/A";
    if(w.indoor) weatherTxt = "Indoor / N/A";
    else if(w.error) weatherTxt = w.error;
    else weatherTxt = `Wind ${w.windSpeedMph ?? "?"}mph ‚Ä¢ Rain ${w.rainChancePct ?? "?"}% ‚Ä¢ Temp ${w.temperatureF ?? "?"}F`;

    let riskTxt = "";
    if(wr.overallRisk != null){
      riskTxt = `Risk ${wr.overallRisk} (${(wr.tags||[]).join(", ")})`;
    }else if(wr.error){
      riskTxt = `Risk error: ${wr.error}`;
    }

    const favTag = g.favorite || (g.fav_team ? `${g.fav_team}` : "");

    const card = document.createElement("div");
    card.className = "game-card";
    card.innerHTML = `
      <div class="matchup">${away} @ ${home}</div>
      <div class="line"><span class="tag">${favTag}</span>${oddsLine}</div>
      <div class="line">Spread: ${spread} | Total: ${total}</div>
      <div class="line">Prediction: ${pred}</div>
      <div class="line">Weather: ${weatherTxt}</div>
      ${riskTxt ? `<div class="muted">${riskTxt}</div>` : ""}
      <div class="muted">Time: ${g.date_local || g.date_utc || ""}</div>
    `;
    grid.appendChild(card);
  });
}

function render(){
  const filtered = (activeSport==="ALL")
    ? allGames
    : allGames.filter(g => (g.sport || "").toUpperCase()===activeSport);

  renderPicks();
  renderGrid(filtered);
}

async function boot(){
  const combined = await loadJson(DATA_URL);
  if(!combined || !combined.data){
    document.getElementById("grid").innerHTML =
      "<div class='muted' style='padding:15px;'>No games available.</div>";
    return;
  }
  allGames = combined.data;
  updateStats();
  buildFilters();
  render();
}

boot();
setInterval(boot, REFRESH_MS);
</script>

</body>
</html>
