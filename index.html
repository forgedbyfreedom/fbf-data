<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Forged by Freedom â€” NFL Statistical Summary</title>

<!-- Tailwind via CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<script>
async function loadData() {
  try {
    // Use raw.githubusercontent.com to avoid redirects/CORS issues
    const res = await fetch(
      "https://raw.githubusercontent.com/forgedbyfreedom/fbf-data/main/combined.json"
    );

    if (!res.ok) throw new Error("HTTP " + res.status);

    const raw = await res.json();
    console.log("RAW JSON:", raw);  // <-- check this in the console

    const data = raw.data || [];
    if (!Array.isArray(data)) throw new Error("Unexpected JSON format");

    // sort by favorite moneyline (lowest number = strongest favorite)
    data.sort((a, b) => (a.ml_fav || 9999) - (b.ml_fav || 9999));

    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";

    data.forEach((row) => {
      if (!row.matchup || !row.sport_key || !row.sport_key.includes("nfl"))
        return;

      const favProb = row.ml_fav
        ? (100 / (row.ml_fav + 100)) * 100
        : null;
      const dogProb = row.ml_dog
        ? (100 / (row.ml_dog + 100)) * 100
        : null;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="px-3 py-2 text-sm text-left">${row.matchup}</td>
        <td class="px-3 py-2 text-sm text-right">${row.spread ?? ""}</td>
        <td class="px-3 py-2 text-sm text-right">${row.total ?? ""}</td>
        <td class="px-3 py-2 text-sm text-right">${
          favProb ? favProb.toFixed(1) + "%" : ""
        }</td>
        <td class="px-3 py-2 text-sm text-right">${
          dogProb ? dogProb.toFixed(1) + "%" : ""
        }</td>
        <td class="px-3 py-2 text-sm text-right">${row.ml_fav ?? ""}</td>
        <td class="px-3 py-2 text-sm text-right">${row.ml_dog ?? ""}</td>
        <td class="px-3 py-2 text-sm text-right">${row.book ?? ""}</td>
        <td class="px-3 py-2 text-sm text-right">${new Date(
          row.commence_time
        ).toLocaleString()}</td>
      `;
      tbody.appendChild(tr);
    });

    document.getElementById("status").textContent =
