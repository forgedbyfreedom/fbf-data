<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forged By Freedom Betting Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    :root{
        --bg:#000;
        --panel:#0b0b0b;
        --panel2:#121212;
        --line:#222;
        --txt:#fff;
        --muted:#aaa;
        --orange:#ff8c00;
    }
    body{
        margin:0; padding:0;
        background:var(--bg);
        color:var(--txt);
        font-family: Arial, sans-serif;
    }

    /* HEADER */
    .header{
        text-align:center;
        padding: 24px 10px 18px 10px;
        border-bottom:1px solid var(--line);
        background: #000;
        position: sticky;
        top:0; z-index:10;
    }
    .glow{
        color:var(--orange);
        text-shadow:0 0 12px var(--orange),0 0 20px #ff6600,0 0 30px #ff4500;
        animation:pulse 2.5s infinite ease-in-out;
    }
    @keyframes pulse{
        0%{text-shadow:0 0 10px var(--orange);}
        50%{text-shadow:0 0 25px #ff4500;}
        100%{text-shadow:0 0 10px var(--orange);}
    }
    a{color:var(--orange);text-decoration:none;}
    a:hover{text-decoration:underline;}

    .subline{
        margin-top:6px; font-size:14px; color:#ddd;
    }
    .note{
        margin-top:8px; font-size:12px; color:#666;
    }

    /* SUMMARY BOXES */
    .summary{
        display:grid;
        grid-template-columns: repeat(3, 1fr);
        gap:10px;
        padding:12px;
        max-width:1100px;
        margin:0 auto;
    }
    .sum-card{
        background:var(--panel);
        border:1px solid var(--line);
        border-radius:8px;
        padding:12px 10px;
        text-align:center;
    }
    .sum-title{
        font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:1px;
    }
    .sum-val{
        margin-top:6px; font-size:28px; font-weight:bold; color:var(--orange);
    }

    /* FILTERS */
    .filters{
        display:flex;
        justify-content:center;
        flex-wrap:wrap;
        gap:8px;
        padding: 6px 10px 14px;
        border-bottom:1px solid var(--line);
        background:#000;
    }
    .filter-btn{
        padding:7px 12px;
        background:var(--panel2);
        border:1px solid var(--line);
        border-radius:999px;
        color:#fff;
        cursor:pointer;
        font-size:13px;
        transition:all .15s ease;
    }
    .filter-btn.active{
        background:var(--orange);
        color:#000;
        font-weight:bold;
        border-color:var(--orange);
    }

    /* SPORT SECTION */
    .sport-block{
        max-width:1200px;
        margin:0 auto;
        padding: 0 8px 20px;
    }
    .sport-title{
        font-size:20px;
        margin:22px 0 10px;
        text-align:center;
        color:var(--orange);
        font-weight:bold;
        letter-spacing:.5px;
    }

    /* 3-COLUMN GRID */
    .grid{
        display:grid;
        grid-template-columns: repeat(3, minmax(0,1fr));
        gap:12px;
    }
    @media(max-width:1000px){
        .grid{grid-template-columns: repeat(2, minmax(0,1fr));}
        .summary{grid-template-columns: repeat(2,1fr);}
    }
    @media(max-width:650px){
        .grid{grid-template-columns: 1fr;}
        .summary{grid-template-columns: 1fr;}
    }

    .card{
        background:var(--panel);
        border:1px solid var(--line);
        border-radius:10px;
        padding:12px;
    }
    .topline{
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap:8px;
        font-size:13px; color:var(--muted);
    }
    .teams{
        margin-top:8px;
        display:grid;
        grid-template-columns: 22px 1fr;
        row-gap:6px; column-gap:8px;
        font-size:15px;
        font-weight:bold;
    }
    .teams img{width:22px;height:22px;object-fit:contain;}

    .favline{
        margin-top:8px;
        font-weight:bold;
        color:var(--orange);
        font-size:14px;
    }

    .lineitem{
        margin-top:6px; font-size:13px; color:#ddd;
    }
    .muted{color:var(--muted);}
    .pill{
        display:inline-block;
        padding:2px 7px;
        border-radius:999px;
        background:var(--panel2);
        border:1px solid var(--line);
        font-size:11px;
        margin-right:4px;
        color:#eee;
    }
    .pick-pill{
        background:var(--orange);
        color:#000;
        font-weight:bold;
        border-color:var(--orange);
    }
</style>
</head>
<body>

<div class="header">
    <div class="glow" style="font-size:15px;">
        üèà Live Odds + Picks Updated Every 15 Minutes ‚Ä¢ For Entertainment Only
    </div>

    <div class="glow" style="font-size:18px; margin-top:6px;">
        Provided to you by
        <a href="https://forgedbyfreedom.org" target="_blank">ForgedByFreedom.org</a>
    </div>

    <div class="glow" style="font-size:30px; margin-top:8px;">
        FORGED BY FREEDOM STRENGTH AND NUTRITION
    </div>

    <div class="glow" style="font-size:18px; margin-top:5px;">
        STRENGTH ‚Äì DISCIPLINE ‚Äì FREEDOM
    </div>

    <div class="subline">
        Visit us for all your fitness, nutrition and supplement program needs
    </div>

    <div class="note">For entertainment purposes only</div>
</div>

<div class="summary" id="summary"></div>
<div class="filters" id="filters"></div>
<div id="sports-container"></div>

<script>
async function loadJson(url){
    const r = await fetch(url, {cache:"no-store"});
    if(!r.ok) return null;
    return await r.json();
}

function fmtLocal(utcStr){
    try{
        return new Date(utcStr).toLocaleString();
    }catch(e){ return utcStr || ""; }
}

function safeUpper(x){
    if(!x) return "";
    return String(x).toUpperCase();
}

function buildSummary(games){
    const total = games.length;
    const favTagged = games.filter(g => g.favorite || g.fav_team).length;
    const picksAvail = games.filter(g => g.prediction && g.prediction.pickSide).length;

    const s = document.getElementById("summary");
    s.innerHTML = `
      <div class="sum-card">
        <div class="sum-title">Total Games</div>
        <div class="sum-val">${total}</div>
      </div>
      <div class="sum-card">
        <div class="sum-title">Favorites Tagged</div>
        <div class="sum-val">${favTagged}</div>
      </div>
      <div class="sum-card">
        <div class="sum-title">Picks Available</div>
        <div class="sum-val">${picksAvail}</div>
      </div>
    `;
}

function buildFilters(games){
    const sports = [...new Set(games.map(g => safeUpper(g.sport)))].sort();
    const holder = document.getElementById("filters");

    holder.innerHTML = "";
    const allBtn = document.createElement("button");
    allBtn.className="filter-btn active";
    allBtn.textContent="ALL";
    allBtn.onclick=() => { setFilter("ALL"); };
    holder.appendChild(allBtn);

    for(const sp of sports){
        const b = document.createElement("button");
        b.className="filter-btn";
        b.textContent=sp;
        b.onclick=() => { setFilter(sp); };
        holder.appendChild(b);
    }
}

let LIVE_GAMES = [];
let ACTIVE_FILTER = "ALL";

function setFilter(sp){
    ACTIVE_FILTER = sp;
    document.querySelectorAll(".filter-btn").forEach(btn=>{
        btn.classList.toggle("active", btn.textContent===sp);
        if(sp==="ALL" && btn.textContent==="ALL") btn.classList.add("active");
        if(sp!=="ALL" && btn.textContent==="ALL") btn.classList.remove("active");
    });
    renderSports(LIVE_GAMES);
}

function renderSports(games){
    const container = document.getElementById("sports-container");
    container.innerHTML = "";

    const filtered = (ACTIVE_FILTER==="ALL")
        ? games
        : games.filter(g => safeUpper(g.sport)===ACTIVE_FILTER);

    const bySport = {};
    filtered.forEach(g=>{
        const k = safeUpper(g.sport) || "OTHER";
        if(!bySport[k]) bySport[k]=[];
        bySport[k].push(g);
    });

    for(const sportKey of Object.keys(bySport)){
        const sportDiv = document.createElement("div");
        sportDiv.className="sport-block";

        const title = document.createElement("div");
        title.className="sport-title";
        title.textContent = sportKey + " ‚Äî " + bySport[sportKey].length + " games";
        sportDiv.appendChild(title);

        const grid = document.createElement("div");
        grid.className="grid";

        bySport[sportKey].forEach(g=>{
            const card = document.createElement("div");
            card.className="card";

            const odds = g.odds || {};
            const pred = g.prediction || {};
            const wr = g.weatherRisk || {};
            const w = g.weather || {};
            const v = g.venue || {};

            const favText = g.favorite || (g.fav_team ? `${g.fav_team} ${g.spread>0?"-":""}${g.spread}` : "");

            let weatherLine = "Indoor / N/A";
            if(w && w.error==="no_coords") weatherLine = "No coords for venue";
            else if(w && w.temperatureF!=null){
                weatherLine = `${w.temperatureF}¬∞F ‚Ä¢ wind ${w.windSpeedMph ?? "?"} mph ‚Ä¢ rain ${w.rainChancePct ?? 0}%`;
            }

            let riskLine = (wr && wr.overallRisk!=null)
                ? `Risk: ${wr.overallRisk} (${(wr.tags||[]).join(", ") || "clean"})`
                : (v.indoor ? "Indoor / N/A" : "N/A");

            let pickLine = "No prediction yet";
            if(pred.pickSide){
                pickLine = `<span class="pill pick-pill">${pred.recommendedTeam} ATS</span>
                            Edge ${pred.edgePts} pts ‚Ä¢ Conf ${(pred.confidence*100).toFixed(1)}%`;
            }

            card.innerHTML = `
              <div class="topline">
                <div class="muted">${g.shortName || g.name || ""}</div>
                <div class="muted">${g.date_local || fmtLocal(g.date_utc)}</div>
              </div>

              <div class="teams">
                <img src="${g.away_team?.logo || ""}" onerror="this.style.display='none'"/>
                <div>${g.away_team?.name || g.away_team?.abbr || "AWAY"}</div>

                <img src="${g.home_team?.logo || ""}" onerror="this.style.display='none'"/>
                <div>${g.home_team?.name || g.home_team?.abbr || "HOME"}</div>
              </div>

              ${favText ? `<div class="favline">${favText}</div>` : ``}

              <div class="lineitem">
                Odds: ${odds.details || "N/A"} (${odds.provider || "ESPN"})
              </div>
              <div class="lineitem muted">
                Spread: ${odds.spread ?? "N/A"}  |  Total: ${odds.total ?? "N/A"}
              </div>

              <div class="lineitem">
                Picks: ${pickLine}
              </div>

              <div class="lineitem muted">
                Weather: ${weatherLine}
              </div>
              <div class="lineitem muted">
                Weather Risk: ${riskLine}
              </div>
            `;

            grid.appendChild(card);
        });

        sportDiv.appendChild(grid);
        container.appendChild(sportDiv);
    }
}

async function boot(){
    const combined = await loadJson("https://data.forgedbyfreedom.org/combined.json");
    if(!combined || !combined.data){
        document.getElementById("sports-container").innerHTML =
          "<div style='padding:20px;text-align:center;'>No games available.</div>";
        return;
    }
    LIVE_GAMES = combined.data;
    buildSummary(LIVE_GAMES);
    buildFilters(LIVE_GAMES);
    renderSports(LIVE_GAMES);

    // auto refresh every 15 min
    setInterval(()=>location.reload(), 15*60*1000);
}

boot();
</script>
</body>
</html>
