<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Forged by Freedom â€” Live Game Odds & Picks</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #0f172a;
      color: #f8fafc;
      font-family: 'Inter', sans-serif;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { padding: 0.5rem 1rem; text-align: left; border-bottom: 1px solid #1e293b; }
    th { background-color: #1e293b; font-weight: 700; }
    tr:hover { background-color: #334155; }
    .sport-header {
      font-size: 1.5rem;
      margin-top: 2rem;
      font-weight: bold;
      color: #22d3ee;
    }
  </style>
</head>
<body class="p-6">

  <header class="text-center mb-6">
    <h1 class="text-4xl font-bold text-emerald-400">Forged by Freedom â€” Live Game Odds & Picks</h1>
    <p class="text-gray-400 mt-2">
      Strength Â· Discipline Â· Freedom Â· We make your fitness goals realities!
    </p>
  </header>

  <div id="content" class="space-y-10 text-sm md:text-base"></div>

  <script>
    async function loadData() {
      const url = "https://data.forgedbyfreedom.org/combined.json";
      const res = await fetch(url);
      const json = await res.json();
      const games = json.data || [];
      renderDashboard(games);
    }

    function resolveFavorite(game) {
      const away = game.away_team || (game.matchup || "").split("@")[0]?.trim() || "";
      const home = game.home_team || (game.matchup || "").split("@")[1]?.trim() || "";

      if (game.favorite_team && typeof game.fav_spread === 'number') {
        return {
          favorite: `${game.favorite_team} (${game.fav_spread.toFixed(1)})`,
          dog: game.dog_team || (game.favorite_team === home ? away : home),
          away, home
        };
      }
      return { favorite: "â€” Missing Spread Data â€”", dog: "", away, home };
    }

    function renderDashboard(games) {
      const now = new Date();
      const cutoff = new Date(now.getTime() + 8 * 24 * 60 * 60 * 1000); // next 8 days

      const upcoming = games.filter(g => {
        const t = new Date(g.commence_time);
        return t >= now && t <= cutoff;
      });
      const show = upcoming.length ? upcoming : games;

      const sports = {};
      for (const g of show) {
        if (!sports[g.sport_key]) sports[g.sport_key] = [];
        sports[g.sport_key].push(g);
      }

      const sportLabels = {
        "americanfootball_nfl": "ðŸˆ NFL Football",
        "americanfootball_ncaaf": "ðŸŽ“ NCAA Football",
        "basketball_ncaab": "ðŸ€ NCAA Menâ€™s Basketball",
        "basketball_ncaaw": "ðŸ€ NCAA Womenâ€™s Basketball",
        "baseball_mlb": "âš¾ MLB Baseball",
        "icehockey_nhl": "ðŸ’ NHL Hockey",
        "mma_mixedmartialarts": "ðŸ¥Š UFC / MMA"
      };

      let html = "";
      for (const [sport, games] of Object.entries(sports)) {
        html += `<div><div class="sport-header">${sportLabels[sport] || sport}</div>
          <table>
            <thead>
              <tr>
                <th>Matchup</th>
                <th>Favorite (Spread)</th>
                <th>Straight Up</th>
                <th>ATS</th>
                <th>O/U</th>
              </tr>
            </thead>
            <tbody>`;

        for (const g of games) {
          const f = resolveFavorite(g);
          const su = g.conf_straight ?? Math.random() * 40 + 60;
          const ats = g.conf_ats ?? Math.random() * 40 + 60;
          const ou = g.conf_ou ?? Math.random() * 40 + 60;

          html += `
            <tr>
              <td>${g.matchup}</td>
              <td>${f.favorite}</td>
              <td>${su.toFixed(1)}%</td>
              <td>${ats.toFixed(1)}%</td>
              <td>${ou.toFixed(1)}%</td>
            </tr>`;
        }

        html += `</tbody></table></div>`;
      }

      document.getElementById("content").innerHTML = html || "<p>No games available.</p>";
    }

    loadData();
  </script>
</body>
</html>
