<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Forged By Freedom — Live Game Odds & Picks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #05070b;
      --card-bg: #0c1018;
      --card-bg-alt: #0f141e;
      --accent: #ff7a1a;
      --accent-soft: #ffb266;
      --text: #f5f7ff;
      --muted: #9ba3b8;
      --border-soft: #252b3a;
      --danger: #ff4b5c;
      --warning: #facc15;
      --success: #22c55e;
      --chip-bg: #151a24;
      --chip-active-bg: #ff7a1a;
      --chip-active-text: #05070b;
      --badge-bg: #111827;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 16px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top left, #111827, #020308 55%)
        fixed;
      color: var(--text);
    }

    #app {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Header panel */

    .top-panel {
      background: radial-gradient(circle at top left, #1f2937, #020617 65%);
      border-radius: 18px;
      border: 1px solid #1f2937;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.6);
      padding: 18px 20px 16px 20px;
      margin-bottom: 18px;
    }

    .hero-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 12px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 0;
    }

    .logo-circle {
      width: 54px;
      height: 54px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #ffecd5, #f97316 45%, #7f1d1d 80%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      letter-spacing: 0.05em;
      color: #111827;
      font-size: 18px;
      box-shadow: 0 0 30px rgba(248, 113, 113, 0.7);
      flex-shrink: 0;
    }

    .brand-text-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
    }

    .brand-title {
      font-size: 17px;
      letter-spacing: 0.12em;
      font-weight: 700;
      text-transform: uppercase;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .brand-subtitle {
      font-size: 11px;
      letter-spacing: 0.35em;
      text-transform: uppercase;
      color: var(--accent-soft);
      white-space: nowrap;
    }

    .brand-tagline {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .brand-link {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: #60a5fa;
      text-decoration: none;
    }

    .brand-link:hover {
      text-decoration: underline;
    }

    .mode-badge {
      display: inline-flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 4px;
      text-align: right;
      font-size: 11px;
      color: var(--muted);
    }

    .mode-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      background: linear-gradient(135deg, #020617, #1f2937);
      border: 1px solid #1f2937;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.6);
      font-size: 11px;
    }

    .mode-pill span.label {
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .mode-pill span.sub {
      font-size: 10px;
      color: var(--muted);
    }

    .last-updated {
      font-size: 10px;
      color: var(--muted);
      margin-top: 2px;
    }

    /* Filter row */

    .filter-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-top: 10px;
      margin-bottom: 2px;
      flex-wrap: wrap;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .filter-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--muted);
      white-space: nowrap;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .sport-chip {
      padding: 4px 10px;
      font-size: 11px;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: var(--chip-bg);
      color: var(--muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .sport-chip span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #4b5563;
    }

    .sport-chip.active {
      background: var(--chip-active-bg);
      color: var(--chip-active-text);
      border-color: #f97316;
    }

    .sport-chip.active span.dot {
      background: #111827;
    }

    .legend {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 11px;
      color: var(--muted);
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .legend span.dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      display: inline-block;
      margin-right: 4px;
    }

    .dot-low {
      background: var(--danger);
    }

    .dot-med {
      background: var(--warning);
    }

    .dot-high {
      background: var(--success);
    }

    /* Group headers + grid */

    .board-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 10px 2px 4px 2px;
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.18em;
    }

    .board-meta-left {
      opacity: 0.75;
    }

    .board-meta-right {
      opacity: 0.75;
    }

    .cards-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
      margin-top: 10px;
    }

    /* Group header spans full width */
    .group-header {
      grid-column: 1 / -1;
      margin-top: 6px;
      margin-bottom: 4px;
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      border-bottom: 1px solid #111827;
      padding: 6px 2px;
    }

    .group-date {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
    }

    .group-sport {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
      opacity: 0.85;
    }

    /* Responsive columns: 1 / 2 / 3 max */

    @media (min-width: 700px) {
      .cards-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (min-width: 1100px) {
      .cards-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    /* Game cards */

    .game-card {
      background: radial-gradient(circle at top left, var(--card-bg-alt), var(--card-bg));
      border-radius: 14px;
      border: 1px solid var(--border-soft);
      padding: 10px 11px 10px 11px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
      display: flex;
      flex-direction: column;
      gap: 6px;
      position: relative;
    }

    .game-card.conf-low {
      box-shadow: inset 0 0 0 1px rgba(248, 113, 113, 0.2),
        0 10px 30px rgba(127, 29, 29, 0.7);
    }

    .game-card.conf-med {
      box-shadow: inset 0 0 0 1px rgba(250, 204, 21, 0.18),
        0 10px 30px rgba(120, 53, 15, 0.7);
    }

    .game-card.conf-high {
      box-shadow: inset 0 0 0 1px rgba(34, 197, 94, 0.22),
        0 10px 30px rgba(6, 95, 70, 0.7);
    }

    .card-top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--muted);
    }

    .sport-tag {
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: rgba(15, 23, 42, 0.9);
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .book-tag {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #9ca3af;
    }

    .matchup-block {
      margin-top: 2px;
    }

    .matchup-line {
      font-size: 12px;
      font-weight: 600;
    }

    .team-line {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .team-label {
      text-transform: uppercase;
      letter-spacing: 0.18em;
      font-size: 10px;
      opacity: 0.85;
    }

    .team-name {
      font-size: 11px;
      font-weight: 500;
      text-align: right;
      margin-left: 8px;
    }

    .kickoff-row {
      margin-top: 4px;
      font-size: 11px;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      gap: 6px;
    }

    .kickoff-row span.label {
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-size: 10px;
    }

    .kickoff-row span.value {
      font-size: 11px;
    }

    .lines-row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 4px;
      margin-top: 6px;
      font-size: 11px;
    }

    .line-col {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 8px;
      padding: 4px 6px;
      border: 1px solid #111827;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .line-label {
      text-transform: uppercase;
      letter-spacing: 0.14em;
      font-size: 9px;
      color: var(--muted);
    }

    .line-value {
      font-size: 11px;
      font-weight: 500;
    }

    .picks-block {
      margin-top: 6px;
      border-top: 1px dashed #1f2937;
      padding-top: 5px;
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 4px;
      font-size: 11px;
    }

    .pick-item {
      display: flex;
      flex-direction: column;
      gap: 1px;
    }

    .pick-label {
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
    }

    .pick-value {
      font-size: 11px;
      font-weight: 500;
    }

    .pick-value.muted {
      opacity: 0.6;
      font-style: italic;
    }

    .no-games {
      margin-top: 24px;
      font-size: 13px;
      color: var(--muted);
      text-align: center;
    }

    @media (max-width: 640px) {
      body {
        padding: 10px;
      }

      .hero-row {
        flex-direction: column;
        align-items: flex-start;
      }

      .mode-badge {
        align-items: flex-start;
        text-align: left;
      }

      .filter-row {
        flex-direction: column;
        align-items: flex-start;
      }

      .board-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- HEADER PANEL -->
    <header class="top-panel">
      <div class="hero-row">
        <div class="brand">
          <div class="logo-circle">FBF</div>
          <div class="brand-text-main">
            <div class="brand-title">FORGED BY FREEDOM STRENGTH &amp; NUTRITION</div>
            <div class="brand-subtitle">STRENGTH &ndash; DISCIPLINE &ndash; FREEDOM</div>
            <div class="brand-tagline">
              For all your training, supplementation, and nutrition needs.
            </div>
            <a href="https://forgedbyfreedom.org" class="brand-link" target="_blank" rel="noopener">
              ForgedByFreedom.org
            </a>
          </div>
        </div>
        <div class="mode-badge">
          <div class="mode-pill">
            <span class="label">Black Ops</span>
            <span class="sub">Tactical Dark Mode</span>
          </div>
          <div class="last-updated" id="last-updated-text">
            Last updated: &mdash;
          </div>
        </div>
      </div>

      <div class="filter-row">
        <div class="filter-group">
          <div class="filter-label">Filter Sports</div>
          <div class="chip-row" id="sport-filters">
            <button class="sport-chip active" data-sport="all">
              <span class="dot"></span>All
            </button>
            <button class="sport-chip" data-sport="americanfootball_nfl">
              <span class="dot"></span>NFL
            </button>
            <button class="sport-chip" data-sport="americanfootball_ncaaf">
              <span class="dot"></span>NCAAF
            </button>
            <button class="sport-chip" data-sport="basketball_nba">
              <span class="dot"></span>NBA
            </button>
            <button class="sport-chip" data-sport="basketball_ncaab">
              <span class="dot"></span>NCAAB
            </button>
            <button class="sport-chip" data-sport="icehockey_nhl">
              <span class="dot"></span>NHL
            </button>
            <button class="sport-chip" data-sport="mma_mixed_martial_arts">
              <span class="dot"></span>UFC
            </button>
          </div>
        </div>

        <div class="legend">
          <span><span class="dot dot-low"></span>Low</span>
          <span><span class="dot dot-med"></span>Medium</span>
          <span><span class="dot dot-high"></span>High</span>
        </div>
      </div>
    </header>

    <!-- BOARD META -->
    <div class="board-meta">
      <div class="board-meta-left">
        Tue &ndash; Sun slates • Sorted by sport, then kickoff (EST)
      </div>
      <div class="board-meta-right">
        Forged By Freedom • Live odds &amp; baseline picks
      </div>
    </div>

    <!-- GRID -->
    <main class="cards-grid" id="cards-grid">
      <!-- Filled by JS -->
    </main>

    <div class="no-games" id="no-games" style="display: none;">
      No games available for this filter right now. Check back soon.
    </div>
  </div>

  <script>
    // ----- CONFIG / LABEL MAPS -----

    const SPORT_LABELS = {
      americanfootball_nfl: "NFL",
      americanfootball_ncaaf: "NCAAF",
      basketball_nba: "NBA",
      basketball_ncaab: "NCAAB",
      icehockey_nhl: "NHL",
      mma_mixed_martial_arts: "UFC"
    };

    function getSportLabel(key) {
      return SPORT_LABELS[key] || key || "Unknown Sport";
    }

    // ----- TIMESTAMP HANDLING (EST) -----

    function formatTimestampEST(rawTs) {
      if (!rawTs || typeof rawTs !== "string") {
        return "Unknown";
      }

      const parts = rawTs.split("_");
      if (parts.length !== 2) return rawTs;

      const datePart = parts[0];
      const timePart = parts[1];
      if (datePart.length !== 8 || timePart.length < 4) return rawTs;

      const year = Number(datePart.slice(0, 4));
      const month = Number(datePart.slice(4, 6)) - 1;
      const day = Number(datePart.slice(6, 8));
      const hour = Number(timePart.slice(0, 2));
      const minute = Number(timePart.slice(2, 4));

      if (
        Number.isNaN(year) ||
        Number.isNaN(month) ||
        Number.isNaN(day) ||
        Number.isNaN(hour) ||
        Number.isNaN(minute)
      ) {
        return rawTs;
      }

      // Treat stored timestamp as UTC and convert to America/New_York
      const utcDate = new Date(Date.UTC(year, month, day, hour, minute));

      const formatter = new Intl.DateTimeFormat("en-US", {
        timeZone: "America/New_York",
        weekday: "short",
        month: "short",
        day: "2-digit",
        year: "numeric",
        hour: "numeric",
        minute: "2-digit",
        hour12: true
      });

      const partsArr = formatter.formatToParts(utcDate);
      const map = {};
      for (const p of partsArr) {
        map[p.type] = p.value;
      }

      const weekday = map.weekday || "";
      const monthName = map.month || "";
      const dayNum = map.day || "";
      const yearNum = map.year || "";
      const hourStr = map.hour || "";
      const minuteStr = map.minute || "";
      const dayPeriod = map.dayPeriod || map.dayperiod || "";

      return `${weekday}, ${monthName} ${dayNum}, ${yearNum} • ${hourStr}:${minuteStr} ${dayPeriod} EST`;
    }

    function updateLastUpdated(rawTs) {
      const el = document.getElementById("last-updated-text");
      const formatted = formatTimestampEST(rawTs);
      el.textContent = "Last updated: " + formatted;
    }

    // ----- DATE HELPERS (EST) -----

    function parseCommenceToDate(commenceTime) {
      if (!commenceTime) return null;
      const d = new Date(commenceTime);
      if (Number.isNaN(d.getTime())) return null;
      return d;
    }

    function formatDateKeyEST(commenceTime) {
      const d = parseCommenceToDate(commenceTime);
      if (!d) return "unknown";
      const options = {
        timeZone: "America/New_York",
        year: "numeric",
        month: "2-digit",
        day: "2-digit"
      };
      const formatter = new Intl.DateTimeFormat("en-CA", options); // yyyy-mm-dd
      return formatter.format(d);
    }

    function formatDateLabelEST(commenceTime) {
      const d = parseCommenceToDate(commenceTime);
      if (!d) return "Unknown Date";
      const formatter = new Intl.DateTimeFormat("en-US", {
        timeZone: "America/New_York",
        weekday: "short",
        month: "short",
        day: "2-digit",
        year: "numeric"
      });
      return formatter.format(d).toUpperCase();
    }

    function formatKickoffTimeEST(commenceTime) {
      const d = parseCommenceToDate(commenceTime);
      if (!d) return "TBD";
      const formatter = new Intl.DateTimeFormat("en-US", {
        timeZone: "America/New_York",
        hour: "numeric",
        minute: "2-digit",
        hour12: true
      });
      return formatter.format(d) + " EST";
    }

    // ----- CONFIDENCE (simple, display only) -----

    function getConfidenceLevel(event) {
      let spreadVal = null;
      if (typeof event.spread === "number") {
        spreadVal = Math.abs(event.spread);
      } else if (typeof event.fav_spread === "number") {
        spreadVal = Math.abs(event.fav_spread);
      }

      if (spreadVal == null) {
        return "low";
      }
      if (spreadVal < 3) return "low";
      if (spreadVal < 7) return "med";
      return "high";
    }

    // ----- PICKS (simple baseline logic) -----

    function buildPickStrings(ev) {
      const favTeam = ev.fav_team || ev.favorite || null;
      const dogTeam = ev.dog_team || ev.underdog || null;
      const spread = ev.spread ?? ev.fav_spread ?? null;
      const total = ev.total ?? null;

      let su = "No clear edge";
      let ats = "No play";
      let ou = "No total lean";

      if (favTeam && typeof favTeam === "string") {
        su = favTeam;
      } else if (ev.home_team || ev.away_team) {
        su = ev.home_team || ev.away_team;
      }

      if (favTeam && typeof spread === "number") {
        if (Math.abs(spread) <= 3) {
          ats = `${favTeam} ${spread > 0 ? "+" : ""}${spread.toFixed(1)}`;
        } else {
          // big spread: slight preference to the dog
          if (dogTeam) {
            const dogSpread =
              typeof ev.dog_spread === "number"
                ? ev.dog_spread
                : spread * -1;
            ats = `${dogTeam} ${dogSpread > 0 ? "+" : ""}${dogSpread.toFixed(1)}`;
          } else {
            ats = `${favTeam} ${spread > 0 ? "+" : ""}${spread.toFixed(1)}`;
          }
        }
      }

      if (typeof total === "number") {
        ou = `Over ${total.toFixed(1)}`;
      }

      return { su, ats, ou };
    }

    // ----- RENDERING -----

    let ALL_EVENTS = [];
    let currentSportFilter = "all";

    function sortEvents(a, b) {
      const orderMap = {
        americanfootball_nfl: 1,
        americanfootball_ncaaf: 2,
        basketball_nba: 3,
        basketball_ncaab: 4,
        icehockey_nhl: 5,
        mma_mixed_martial_arts: 6
      };
      const aOrder = orderMap[a.sport_key] || 99;
      const bOrder = orderMap[b.sport_key] || 99;
      if (aOrder !== bOrder) return aOrder - bOrder;

      const aDate = new Date(a.commence_time || 0).getTime();
      const bDate = new Date(b.commence_time || 0).getTime();
      return aDate - bDate;
    }

    function render() {
      const grid = document.getElementById("cards-grid");
      const noGamesEl = document.getElementById("no-games");
      grid.innerHTML = "";

      const filtered = ALL_EVENTS
        .filter((ev) =>
          currentSportFilter === "all"
            ? true
            : ev.sport_key === currentSportFilter
        )
        .sort(sortEvents);

      if (filtered.length === 0) {
        noGamesEl.style.display = "block";
        return;
      }
      noGamesEl.style.display = "none";

      let lastGroupKey = null;

      filtered.forEach((ev) => {
        const sportLabel = getSportLabel(ev.sport_key);
        const dateKey = formatDateKeyEST(ev.commence_time);
        const dateLabel = formatDateLabelEST(ev.commence_time);
        const groupKey = sportLabel + "|" + dateKey;

        if (groupKey !== lastGroupKey) {
          const groupEl = document.createElement("div");
          groupEl.className = "group-header";
          groupEl.innerHTML = `
            <div class="group-date">${dateLabel}</div>
            <div class="group-sport">${sportLabel} BOARD</div>
          `;
          grid.appendChild(groupEl);
          lastGroupKey = groupKey;
        }

        const confidence = getConfidenceLevel(ev);
        const picks = buildPickStrings(ev);
        const kickoff = formatKickoffTimeEST(ev.commence_time);

        const card = document.createElement("div");
        card.className = "game-card conf-" + confidence;

        const favDisplay = ev.favorite || "—";
        const dogDisplay = ev.underdog || "—";

        let spreadStr = "—";
        if (typeof ev.spread === "number") {
          spreadStr = (ev.spread > 0 ? "+" : "") + ev.spread.toFixed(1);
        } else if (typeof ev.fav_spread === "number") {
          spreadStr =
            (ev.fav_spread > 0 ? "+" : "") + ev.fav_spread.toFixed(1);
        }

        let totalStr = "—";
        if (typeof ev.total === "number") {
          totalStr = ev.total.toFixed(1);
        }

        const bookLabel = (ev.book || "").toString().toUpperCase();

        card.innerHTML = `
          <div class="card-top-row">
            <span class="sport-tag">${sportLabel}</span>
            <span class="book-tag">${bookLabel}</span>
          </div>
          <div class="matchup-block">
            <div class="matchup-line">${ev.matchup || ""}</div>
            <div class="team-line">
              <span class="team-label">AWAY</span>
              <span class="team-name">${ev.away_team || ""}</span>
            </div>
            <div class="team-line">
              <span class="team-label">HOME</span>
              <span class="team-name">${ev.home_team || ""}</span>
            </div>
          </div>
          <div class="kickoff-row">
            <span><span class="label">Kickoff</span> <span class="value">${kickoff}</span></span>
            <span><span class="label">Book</span> <span class="value">${bookLabel}</span></span>
          </div>
          <div class="lines-row">
            <div class="line-col">
              <div class="line-label">Favorite</div>
              <div class="line-value">${favDisplay}</div>
            </div>
            <div class="line-col">
              <div class="line-label">Underdog</div>
              <div class="line-value">${dogDisplay}</div>
            </div>
            <div class="line-col">
              <div class="line-label">Total</div>
              <div class="line-value">${totalStr}</div>
            </div>
          </div>
          <div class="picks-block">
            <div class="pick-item">
              <div class="pick-label">SU</div>
              <div class="pick-value">${picks.su}</div>
            </div>
            <div class="pick-item">
              <div class="pick-label">ATS</div>
              <div class="pick-value">${picks.ats}</div>
            </div>
            <div class="pick-item">
              <div class="pick-label">O/U</div>
              <div class="pick-value">${picks.ou}</div>
            </div>
          </div>
        `;

        grid.appendChild(card);
      });
    }

    // ----- SPORT FILTER BUTTONS -----

    function setupSportFilters() {
      const container = document.getElementById("sport-filters");
      container.addEventListener("click", (e) => {
        const btn = e.target.closest(".sport-chip");
        if (!btn) return;
        const sport = btn.getAttribute("data-sport") || "all";
        currentSportFilter = sport;

        Array.from(container.querySelectorAll(".sport-chip")).forEach((b) => {
          b.classList.toggle("active", b === btn);
        });

        render();
      });
    }

    // ----- INIT: FETCH + RENDER -----

    async function init() {
      setupSportFilters();

      try {
        const res = await fetch("combined.json", { cache: "no-cache" });
        const json = await res.json();

        updateLastUpdated(json.timestamp);

        const data = Array.isArray(json.data) ? json.data : [];
        ALL_EVENTS = data.filter((ev) => ev && ev.sport_key && ev.matchup);
        render();
      } catch (err) {
        console.error("Failed to load combined.json", err);
        updateLastUpdated(null);
        document.getElementById("no-games").style.display = "block";
        document.getElementById("no-games").textContent =
          "Error loading odds data. Check back shortly.";
      }
    }

    init();
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FBF Predictions Dashboard</title>

<style>
/* ============================================================
   GLOBAL
============================================================ */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  background-color: #111;
  color: #eee;
  padding: 20px;
  transition: background 0.3s, color 0.3s;
}
body.light {
  background-color: #f5f5f5;
  color: #222;
}

/* ============================================================
   HEADER + TOGGLE
============================================================ */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  flex-wrap: wrap;
  gap: 10px;
}
.header h1 {
  font-size: 24px;
}
.theme-toggle {
  padding: 8px 14px;
  background: #444;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
body.light .theme-toggle {
  background: #ddd;
  color: #111;
}

/* ============================================================
   FILTERS
============================================================ */
.filters {
  display: flex;
  flex-wrap: wrap;
  gap: 12px 25px;
  margin-bottom: 20px;
}
.filter-group {
  display: flex;
  align-items: center;
  gap: 6px;
}
.filter-label {
  font-weight: bold;
  font-size: 13px;
}
.filter-btn {
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid #555;
  background: #222;
  color: #eee;
  cursor: pointer;
  font-size: 12px;
}
.filter-btn.active {
  background: #fbbf24;
  color: #111;
  border-color: #f59e0b;
  font-weight: bold;
}
body.light .filter-btn {
  background: #eee;
  color: #111;
  border-color: #bbb;
}
body.light .filter-btn.active {
  background: #f59e0b;
  color: #111;
  border-color: #c27803;
}

/* ============================================================
   TABLES
============================================================ */
.section-title {
  font-size: 20px;
  font-weight: bold;
  margin: 15px 0 8px 0;
}

.table-container {
  overflow-x: auto;
  max-height: 70vh;
  border-radius: 8px;
  margin-bottom: 30px;
}

.pred-table {
  width: 100%;
  border-collapse: collapse;
  background: #1b1b1b;
}
body.light .pred-table {
  background: #fff;
}

.pred-table th, .pred-table td {
  padding: 8px 6px;
  border-bottom: 1px solid #333;
  text-align: center;
  white-space: nowrap;
  font-size: 13px;
}
body.light .pred-table th, body.light .pred-table td {
  border-bottom: 1px solid #ccc;
}

.pred-table th {
  background: #222;
  font-weight: bold;
  position: sticky;
  top: 0;
  z-index: 2;
  cursor: pointer;
}
body.light .pred-table th {
  background: #eee;
}

.pred-table tbody tr:hover {
  background: #2b2b2b;
}
body.light .pred-table tbody tr:hover {
  background: #eaeaea;
}

/* ATS & CONF COLORS */
.ats-fav { color: #ff6666; font-weight: bold; }
.ats-dog { color: #66aaff; font-weight: bold; }
.conf-low { color: #f97373; font-weight: bold; }
.conf-med { color: #facc15; font-weight: bold; }
.conf-high { color: #22c55e; font-weight: bold; }

/* MOBILE */
@media(max-width:600px){
  .header h1 { font-size: 20px; }
  .filters { flex-direction: column; }
}
</style>
</head>

<body>

<div class="header">
  <h1>FBF Game & Fight Predictions</h1>
  <button class="theme-toggle" onclick="toggleTheme()">Dark / Light</button>
</div>

<!-- FILTERS -->
<div class="filters">
  <div class="filter-group">
    <span class="filter-label">SPORT:</span>
    <button class="filter-btn active" data-filter-group="sport" data-value="ALL">All</button>
    <button class="filter-btn" data-filter-group="sport" data-value="NFL">NFL</button>
    <button class="filter-btn" data-filter-group="sport" data-value="NCAAF">NCAAF</button>
    <button class="filter-btn" data-filter-group="sport" data-value="UFC">UFC</button>
  </div>

  <div class="filter-group">
    <span class="filter-label">CONFIDENCE:</span>
    <button class="filter-btn active" data-filter-group="conf" data-value="ALL">All</button>
    <button class="filter-btn" data-filter-group="conf" data-value="LOW">Low</button>
    <button class="filter-btn" data-filter-group="conf" data-value="MED">Medium</button>
    <button class="filter-btn" data-filter-group="conf" data-value="HIGH">High</button>
  </div>

  <div class="filter-group">
    <span class="filter-label">PICKS:</span>
    <button class="filter-btn active" data-filter-group="pick" data-value="ALL">All</button>
    <button class="filter-btn" data-filter-group="pick" data-value="SU">SU</button>
    <button class="filter-btn" data-filter-group="pick" data-value="ATS">ATS</button>
    <button class="filter-btn" data-filter-group="pick" data-value="OU">O/U</button>
  </div>
</div>

<!-- FOOTBALL -->
<div class="section-title">NFL & College Football</div>
<div class="table-container">
<table class="pred-table" id="football-table">
  <thead>
    <tr>
      <th>Matchup</th>
      <th>Straight-Up</th>
      <th>SU %</th>
      <th>ATS</th>
      <th>Spread</th>
      <th>Cover %</th>
      <th>O/U</th>
      <th>Total Pick</th>
      <th>Conf (SU)</th>
      <th>Conf (ATS)</th>
    </tr>
  </thead>
  <tbody id="football-body"></tbody>
</table>
</div>

<!-- UFC -->
<div class="section-title">UFC Fight Predictions</div>
<div class="table-container">
<table class="pred-table" id="ufc-table">
  <thead>
    <tr>
      <th>Fight</th>
      <th>Pick</th>
      <th>Win %</th>
      <th>KO %</th>
      <th>Sub %</th>
      <th>Dec %</th>
      <th>Round 1 %</th>
      <th>Goes Dist %</th>
      <th>Confidence</th>
    </tr>
  </thead>
  <tbody id="ufc-body"></tbody>
</table>
</div>

<script>
// ===== THEME =====
function toggleTheme(){document.body.classList.toggle("light");}

// ===== AUTO REFRESH (30 min) =====
setInterval(()=>location.reload(),1800000);

// ===== STATE =====
const state={predictions:[],sportFilter:"ALL",confFilter:"ALL",pickFilter:"ALL"};

// ===== 7-DAY FILTER =====
function isWithin7Days(item) {
    if (!item.commence_time) return true;
    let eventTime = new Date(item.commence_time);
    let now = new Date();
    let in7 = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);
    return eventTime >= now && eventTime <= in7;
}

// ===== HELPERS =====
function getSport(item){
  const s=(item.sport_key||item.sport||"").toLowerCase();
  if(s.includes("mma"))return"UFC";
  if(s.includes("ncaaf"))return"NCAAF";
  if(s.includes("nfl"))return"NFL";
  return"OTHER";
}
function toNum(v){let n=parseFloat(v);return isNaN(n)?null:n;}
function confClass(v){
  let n=toNum(v);if(n==null)return"";
  if(n>=70)return"conf-high";
  if(n>=56)return"conf-med";
  return"conf-low";
}
function getFootballConf(item){
  if(state.pickFilter==="ATS") return item.ats_conf;
  if(state.pickFilter==="OU") return item.total_conf;
  return item.su_conf;
}

// ===== FILTER CHECKS =====
function passesSportFootball(s){
  if(state.sportFilter==="ALL")return s==="NFL"||s==="NCAAF";
  return state.sportFilter===s;
}
function passesSportUFC(){return state.sportFilter==="ALL"||state.sportFilter==="UFC";}
function passesConf(v){
  if(state.confFilter==="ALL")return true;
  let n=toNum(v);if(n==null)return false;
  if(state.confFilter==="LOW")return n<=55;
  if(state.confFilter==="MED")return n>=56&&n<=69;
  if(state.confFilter==="HIGH")return n>=70;
}
function passesPickFootball(item){
  if(state.pickFilter==="ALL"||state.pickFilter==="SU")return true;
  if(state.pickFilter==="ATS")return !!item.ats_side;
  if(state.pickFilter==="OU")return (item.total_pick||"").toLowerCase()!=="no play";
}
function passesPickUFC(){return state.pickFilter==="ALL"||state.pickFilter==="SU";}
function passesConfUFC(item){return passesConf(item.win_pct);}

// ===== RENDER =====
function renderTables(){
  let fb=document.getElementById("football-body");
  let uf=document.getElementById("ufc-body");
  fb.innerHTML="";uf.innerHTML="";

  state.predictions.forEach(it=>{
    if (!isWithin7Days(it)) return;   // <-- FILTER OUTSIDE 7 DAYS

    let sport=getSport(it);

    if(sport==="UFC"){
      if(!passesSportUFC())return;
      if(!passesPickUFC())return;
      if(!passesConfUFC(it))return;

      uf.insertAdjacentHTML("beforeend",`
        <tr>
          <td>${it.matchup||""}</td>
          <td>${it.pick||""}</td>
          <td class="${confClass(it.win_pct)}">${it.win_pct}%</td>
          <td>${it.ko_pct}%</td>
          <td>${it.sub_pct}%</td>
          <td>${it.dec_pct}%</td>
          <td>${it.r1_pct}%</td>
          <td>${it.goes_dist_pct}%</td>
          <td class="${confClass(it.win_pct)}">${it.win_pct}%</td>
        </tr>
      `);

    } else if(sport==="NFL"||sport==="NCAAF"){
      if(!passesSportFootball(sport))return;
      if(!passesPickFootball(it))return;
      let c=getFootballConf(it);
      if(!passesConf(c))return;

      fb.insertAdjacentHTML("beforeend",`
        <tr>
        <td>${it.matchup}</td>
        <td>${it.su_pick}</td>
        <td class="${confClass(it.su_conf)}">${it.su_conf}%</td>
        <td class="${it.ats_side==="fav"?"ats-fav":it.ats_side==="dog"?"ats-dog":""}">
          ${(it.ats_side||"").toUpperCase()}
        </td>
        <td>${it.spread}</td>
        <td class="${confClass(it.ats_conf)}">${it.ats_conf}%</td>
        <td>${it.total}</td>
        <td>${it.total_pick}</td>
        <td class="${confClass(it.su_conf)}">${it.su_conf}%</td>
        <td class="${confClass(it.ats_conf)}">${it.ats_conf}%</td>
        </tr>
      `);
    }
  });
}

// ===== FILTER BUTTONS =====
document.addEventListener("click",e=>{
  let b=e.target.closest(".filter-btn");if(!b)return;
  let g=b.dataset.filterGroup,v=b.dataset.value;
  document.querySelectorAll(`.filter-btn[data-filter-group="${g}"]`)
    .forEach(x=>x.classList.remove("active"));
  b.classList.add("active");
  state[g+"Filter"]=v;
  renderTables();
});

// ===== SORTING =====
function enableSorting(id){
  let t=document.getElementById(id);
  if(!t)return;
  t.querySelectorAll("th").forEach((th,i)=>{
    th.onclick=()=>sortTable(t,i);
  });
}
function sortTable(t,col){
  let rows=Array.from(t.querySelector("tbody").rows);
  let numeric=rows.every(r=>!isNaN(parseFloat(r.cells[col].innerText.replace("%",""))));
  rows.sort((A,B)=>{
    let a=A.cells[col].innerText.replace("%","");
    let b=B.cells[col].innerText.replace("%","");
    return numeric?(parseFloat(b)||0)-(parseFloat(a)||0):a.localeCompare(b);
  });
  let bd=t.querySelector("tbody");
  bd.innerHTML="";
  rows.forEach(r=>bd.appendChild(r));
}

document.addEventListener("DOMContentLoaded",()=>{
  enableSorting("football-table");
  enableSorting("ufc-table");
});

// ===== LOAD DATA =====
fetch("predictions.json",{cache:"no-cache"})
  .then(r=>r.json())
  .then(d=>{
    state.predictions=d.data||d.predictions||[];
    renderTables();
  });
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FBF Predictions Dashboard</title>

<style>
/* ============================================================
   GLOBAL
============================================================ */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  background-color: #111;
  color: #eee;
  padding: 20px;
  transition: background 0.3s, color 0.3s;
}
body.light {
  background-color: #f5f5f5;
  color: #222;
}

/* ============================================================
   HEADER + TOGGLE
============================================================ */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  flex-wrap: wrap;
  gap: 10px;
}
.header h1 {
  font-size: 24px;
}
.theme-toggle {
  padding: 8px 14px;
  background: #444;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
body.light .theme-toggle {
  background: #ddd;
  color: #111;
}

/* ============================================================
   FILTERS
============================================================ */
.filters {
  display: flex;
  flex-wrap: wrap;
  gap: 12px 25px;
  margin-bottom: 20px;
}
.filter-group {
  display: flex;
  align-items: center;
  gap: 6px;
}
.filter-label {
  font-weight: bold;
  font-size: 13px;
}
.filter-btn {
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid #555;
  background: #222;
  color: #eee;
  cursor: pointer;
  font-size: 12px;
}
.filter-btn.active {
  background: #fbbf24;
  color: #111;
  border-color: #f59e0b;
  font-weight: bold;
}
body.light .filter-btn {
  background: #eee;
  color: #111;
  border-color: #bbb;
}
body.light .filter-btn.active {
  background: #f59e0b;
  color: #111;
  border-color: #c27803;
}

/* ============================================================
   TABLES
============================================================ */
.section-title {
  font-size: 20px;
  font-weight: bold;
  margin: 15px 0 8px 0;
}

.table-container {
  overflow-x: auto;
  max-height: 70vh;
  border-radius: 8px;
  margin-bottom: 30px;
}

.pred-table {
  width: 100%;
  border-collapse: collapse;
  background: #1b1b1b;
}
body.light .pred-table {
  background: #fff;
}

.pred-table th, .pred-table td {
  padding: 8px 6px;
  border-bottom: 1px solid #333;
  text-align: center;
  white-space: nowrap;
  font-size: 13px;
}
body.light .pred-table th, body.light .pred-table td {
  border-bottom: 1px solid #ccc;
}

.pred-table th {
  background: #222;
  font-weight: bold;
  position: sticky;
  top: 0;
  z-index: 2;
  cursor: pointer;
}
body.light .pred-table th {
  background: #eee;
}

.pred-table tbody tr:hover {
  background: #2b2b2b;
}
body.light .pred-table tbody tr:hover {
  background: #eaeaea;
}

/* ATS & CONF COLORS */
.ats-fav { color: #ff6666; font-weight: bold; }
.ats-dog { color: #66aaff; font-weight: bold; }
.conf-low { color: #f97373; font-weight: bold; }
.conf-med { color: #facc15; font-weight: bold; }
.conf-high { color: #22c55e; font-weight: bold; }

/* MOBILE */
@media(max-width:600px){
  .header h1 { font-size: 20px; }
  .filters { flex-direction: column; }
}
</style>
</head>

<body>

<div class="header">
  <h1>FBF Game & Fight Predictions</h1>
  <button class="theme-toggle" onclick="toggleTheme()">Dark / Light</button>
</div>

<!-- FILTERS -->
<div class="filters">
  <div class="filter-group">
    <span class="filter-label">SPORT:</span>
    <button class="filter-btn active" data-filter-group="sport" data-value="ALL">All</button>
    <button class="filter-btn" data-filter-group="sport" data-value="NFL">NFL</button>
    <button class="filter-btn" data-filter-group="sport" data-value="NCAAF">NCAAF</button>
    <button class="filter-btn" data-filter-group="sport" data-value="UFC">UFC</button>
  </div>

  <div class="filter-group">
    <span class="filter-label">CONFIDENCE:</span>
    <button class="filter-btn active" data-filter-group="conf" data-value="ALL">All</button>
    <button class="filter-btn" data-filter-group="conf" data-value="LOW">Low</button>
    <button class="filter-btn" data-filter-group="conf" data-value="MED">Medium</button>
    <button class="filter-btn" data-filter-group="conf" data-value="HIGH">High</button>
  </div>

  <div class="filter-group">
    <span class="filter-label">PICKS:</span>
    <button class="filter-btn active" data-filter-group="pick" data-value="ALL">All</button>
    <button class="filter-btn" data-filter-group="pick" data-value="SU">SU</button>
    <button class="filter-btn" data-filter-group="pick" data-value="ATS">ATS</button>
    <button class="filter-btn" data-filter-group="pick" data-value="OU">O/U</button>
  </div>
</div>

<!-- FOOTBALL -->
<div class="section-title">NFL & College Football</div>
<div class="table-container">
<table class="pred-table" id="football-table">
  <thead>
    <tr>
      <th>Matchup</th>
      <th>Straight-Up</th>
      <th>SU %</th>
      <th>ATS</th>
      <th>Spread</th>
      <th>Cover %</th>
      <th>O/U</th>
      <th>Total Pick</th>
      <th>Conf (SU)</th>
      <th>Conf (ATS)</th>
    </tr>
  </thead>
  <tbody id="football-body"></tbody>
</table>
</div>

<!-- UFC -->
<div class="section-title">UFC Fight Predictions</div>
<div class="table-container">
<table class="pred-table" id="ufc-table">
  <thead>
    <tr>
      <th>Fight</th>
      <th>Pick</th>
      <th>Win %</th>
      <th>KO %</th>
      <th>Sub %</th>
      <th>Dec %</th>
      <th>Round 1 %</th>
      <th>Goes Dist %</th>
      <th>Confidence</th>
    </tr>
  </thead>
  <tbody id="ufc-body"></tbody>
</table>
</div>

<script>
// ===== THEME =====
function toggleTheme(){document.body.classList.toggle("light");}

// ===== AUTO REFRESH (30 min) =====
setInterval(()=>location.reload(),1800000);

// ===== STATE =====
const state={predictions:[],sportFilter:"ALL",confFilter:"ALL",pickFilter:"ALL"};

// ===== HELPERS =====
function getSport(item){
  const s=(item.sport_key||item.sport||"").toLowerCase();
  if(s.includes("mma"))return"UFC";
  if(s.includes("ncaaf"))return"NCAAF";
  if(s.includes("nfl"))return"NFL";
  return"OTHER";
}
function toNum(v){let n=parseFloat(v);return isNaN(n)?null:n;}
function confClass(v){
  let n=toNum(v);if(n==null)return"";
  if(n>=70)return"conf-high";
  if(n>=56)return"conf-med";
  return"conf-low";
}
function getFootballConf(item){
  if(state.pickFilter==="ATS") return item.ats_conf;
  if(state.pickFilter==="OU") return item.total_conf;
  return item.su_conf;
}

// ===== FILTER CHECKS =====
function passesSportFootball(s){
  if(state.sportFilter==="ALL")return s==="NFL"||s==="NCAAF";
  return state.sportFilter===s;
}
function passesSportUFC(){return state.sportFilter==="ALL"||state.sportFilter==="UFC";}
function passesConf(v){
  if(state.confFilter==="ALL")return true;
  let n=toNum(v);if(n==null)return false;
  if(state.confFilter==="LOW")return n<=55;
  if(state.confFilter==="MED")return n>=56&&n<=69;
  if(state.confFilter==="HIGH")return n>=70;
}
function passesPickFootball(item){
  if(state.pickFilter==="ALL"||state.pickFilter==="SU")return true;
  if(state.pickFilter==="ATS")return !!item.ats_side;
  if(state.pickFilter==="OU")return (item.total_pick||"").toLowerCase()!=="no play";
}
function passesPickUFC(){return state.pickFilter==="ALL"||state.pickFilter==="SU";}
function passesConfUFC(item){return passesConf(item.win_pct);}

// ===== RENDER =====
function renderTables(){
  let fb=document.getElementById("football-body");
  let uf=document.getElementById("ufc-body");
  fb.innerHTML="";uf.innerHTML="";

  state.predictions.forEach(it=>{
    let sport=getSport(it);

    if(sport==="UFC"){
      if(!passesSportUFC())return;
      if(!passesPickUFC())return;
      if(!passesConfUFC(it))return;

      uf.insertAdjacentHTML("beforeend",`
        <tr>
          <td>${it.matchup||""}</td>
          <td>${it.pick||""}</td>
          <td class="${confClass(it.win_pct)}">${it.win_pct}%</td>
          <td>${it.ko_pct}%</td>
          <td>${it.sub_pct}%</td>
          <td>${it.dec_pct}%</td>
          <td>${it.r1_pct}%</td>
          <td>${it.goes_dist_pct}%</td>
          <td class="${confClass(it.win_pct)}">${it.win_pct}%</td>
        </tr>
      `);

    } else if(sport==="NFL"||sport==="NCAAF"){
      if(!passesSportFootball(sport))return;
      if(!passesPickFootball(it))return;
      let c=getFootballConf(it);
      if(!passesConf(c))return;

      fb.insertAdjacentHTML("beforeend",`
        <tr>
        <td>${it.matchup}</td>
        <td>${it.su_pick}</td>
        <td class="${confClass(it.su_conf)}">${it.su_conf}%</td>
        <td class="${it.ats_side==="fav"?"ats-fav":it.ats_side==="dog"?"ats-dog":""}">
          ${(it.ats_side||"").toUpperCase()}
        </td>
        <td>${it.spread}</td>
        <td class="${confClass(it.ats_conf)}">${it.ats_conf}%</td>
        <td>${it.total}</td>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta="viewport" content="width=device-width, initial-scale=1.0">
  <title>FBF Predictions Dashboard</title>

  <style>
    /* =============== GLOBAL =============== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      background-color: #111;
      color: #eee;
      padding: 20px;
      transition: background 0.3s, color 0.3s;
    }

    body.light {
      background-color: #f5f5f5;
      color: #222;
    }

    /* =============== HEADER =============== */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .header h1 {
      font-size: 24px;
      letter-spacing: 1px;
    }

    .theme-toggle {
      padding: 8px 14px;
      background: #444;
      border: none;
      color: #fff;
      border-radius: 6px;
      cursor: pointer;
    }

    body.light .theme-toggle {
      background: #ddd;
      color: #111;
    }

    /* =============== FILTER BAR =============== */
    .filters {
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px 20px;
      align-items: center;
      font-size: 14px;
    }

    .filter-group {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    .filter-label {
      font-weight: bold;
      font-size: 13px;
      margin-right: 4px;
    }

    .filter-btn {
      padding: 4px 10px;
      font-size: 12px;
      border-radius: 999px;
      border: 1px solid #555;
      background: #222;
      color: #eee;
      cursor: pointer;
    }

    .filter-btn.active {
      background: #fbbf24;
      color: #111;
      border-color: #f59e0b;
      font-weight: bold;
    }

    body.light .filter-btn {
      background: #eee;
      color: #111;
      border-color: #bbb;
    }

    body.light .filter-btn.active {
      background: #f59e0b;
      color: #111;
      border-color: #c27803;
    }

    /* =============== SECTIONS =============== */
    .section-title {
      font-size: 20px;
      font-weight: bold;
      margin: 15px 0 8px 0;
    }

    .table-container {
      width: 100%;
      overflow-x: auto;
      overflow-y: auto;
      max-height: 70vh;
      margin-bottom: 30px;
      border-radius: 8px;
    }

    /* =============== TABLES =============== */
    .pred-table {
      width: 100%;
      border-collapse: collapse;
      background: #1b1b1b;
      border-radius: 8px;
      overflow: hidden;
    }

    body.light .pred-table {
      background: #fff;
    }

    .pred-table th,
    .pred-table td {
      padding: 8px 6px;
      border-bottom: 1px solid #333;
      text-align: center;
      font-size: 13px;
      white-space: nowrap;
    }

    body.light .pred-table th,
    body.light .pred-table td {
      border-bottom: 1px solid #ccc;
    }

    .pred-table th {
      background: #222;
      font-weight: bold;
      position: sticky;
      top: 0;
      z-index: 2;
      cursor: pointer;
    }

    body.light .pred-table th {
      background: #eee;
    }

    .pred-table tbody tr:hover {
      background: #2b2b2b;
    }

    body.light .pred-table tbody tr:hover {
      background: #eaeaea;
    }

    /* ATS highlight */
    .ats-fav { color: #ff6666; font-weight: bold; }
    .ats-dog { color: #66aaff; font-weight: bold; }

    /* Confidence colors */
    .conf-low   { color: #f97373; font-weight: bold; }   /* red-ish */
    .conf-med   { color: #facc15; font-weight: bold; }   /* yellow  */
    .conf-high  { color: #22c55e; font-weight: bold; }   /* green   */

    /* Mobile tweaks */
    @media (max-width: 640px) {
      body {
        padding: 10px;
      }
      .header h1 {
        font-size: 20px;
      }
      .filters {
        flex-direction: column;
        align-items: flex-start;
      }
      .table-container {
        max-height: 65vh;
      }
    }
  </style>
</head>
<body>

  <div class="header">
    <h1>FBF Game & Fight Predictions</h1>
    <button class="theme-toggle" onclick="toggleTheme()">Dark / Light</button>
  </div>

  <!-- FILTERS -->
  <div class="filters">
    <div class="filter-group">
      <span class="filter-label">SPORT:</span>
      <button class="filter-btn active" data-filter-group="sport" data-value="ALL">All</button>
      <button class="filter-btn" data-filter-group="sport" data-value="NFL">NFL</button>
      <button class="filter-btn" data-filter-group="sport" data-value="NCAAF">NCAAF</button>
      <button class="filter-btn" data-filter-group="sport" data-value="UFC">UFC</button>
    </div>

    <div class="filter-group">
      <span class="filter-label">CONFIDENCE:</span>
      <button class="filter-btn active" data-filter-group="conf" data-value="ALL">All</button>
      <button class="filter-btn" data-filter-group="conf" data-value="LOW">Low</button>
      <button class="filter-btn" data-filter-group="conf" data-value="MED">Medium</button>
      <button class="filter-btn" data-filter-group="conf" data-value="HIGH">High</button>
    </div>

    <div class="filter-group">
      <span class="filter-label">PICKS:</span>
      <button class="filter-btn active" data-filter-group="pick" data-value="ALL">All</button>
      <button class="filter-btn" data-filter-group="pick" data-value="SU">SU</button>
      <button class="filter-btn" data-filter-group="pick" data-value="ATS">ATS</button>
      <button class="filter-btn" data-filter-group="pick" data-value="OU">O/U</button>
    </div>
  </div>

  <!-- FOOTBALL SECTION -->
  <div class="section-title">NFL & College Football</div>
  <div class="table-container">
    <table class="pred-table" id="football-table">
      <thead>
        <tr>
          <th>Matchup</th>
          <th>Straight-Up</th>
          <th>SU %</th>
          <th>ATS</th>
          <th>Spread</th>
          <th>Cover %</th>
          <th>O/U</th>
          <th>Total Pick</th>
          <th>Conf (SU)</th>
          <th>Conf (ATS)</th>
        </tr>
      </thead>
      <tbody id="football-body"></tbody>
    </table>
  </div>

  <!-- UFC SECTION -->
  <div class="section-title">UFC Fight Predictions</div>
  <div class="table-container">
    <table class="pred-table" id="ufc-table">
      <thead>
        <tr>
          <th>Fight</th>
          <th>Pick</th>
          <th>Win %</th>
          <th>KO %</th>
          <th>Sub %</th>
          <th>Dec %</th>
          <th>Round 1 %</th>
          <th>Goes Dist %</th>
          <th>Confidence</th>
        </tr>
      </thead>
      <tbody id="ufc-body"></tbody>
    </table>
  </div>

  <script>
    // ================= THEME =================
    function toggleTheme() {
      document.body.classList.toggle("light");
    }

    // ================= STATE =================
    const state = {
      predictions: [],
      sportFilter: "ALL",
      confFilter: "ALL",
      pickFilter: "ALL",
    };

    // Auto-refresh every 30 minutes (1800000 ms)
    setInterval(() => {
      location.reload();
    }, 1800000);

    // ================= HELPERS =================
    function getSport(item) {
      const sk = (item.sport_key || item.sport || "").toLowerCase();
      if (sk.includes("mma")) return "UFC";
      if (sk.includes("ncaaf")) return "NCAAF";
      if (sk.includes("nfl")) return "NFL";
      return "OTHER";
    }

    function toNumber(val) {
      if (val == null) return null;
      const n = parseFloat(val);
      return isNaN(n) ? null : n;
    }

    function confClass(conf) {
      const n = toNumber(conf);
      if (n == null) return "";
      if (n >= 70) return "conf-high";
      if (n >= 56) return "conf-med";
      return "conf-low";
    }

    // For football confidence filter: choose relevant confidence
    function getFootballConfForFilter(item) {
      if (state.pickFilter === "ATS") {
        return item.ats_conf ?? item.ats_cover_conf ?? item.ats_prob;
      } else if (state.pickFilter === "OU") {
        return item.ou_conf ?? item.total_conf ?? item.ou_prob ?? item.total_prob;
      } else {
        // SU or ALL fall back to SU
        return item.su_conf ?? item.su_prob;
      }
    }

    function passesConfFilter(conf) {
      if (state.confFilter === "ALL") return true;
      const n = toNumber(conf);
      if (n == null) return false;

      if (state.confFilter === "LOW") {
        return n <= 55;
      } else if (state.confFilter === "MED") {
        return n >= 56 && n <= 69;
      } else if (state.confFilter === "HIGH") {
        return n >= 70;
      }
      return true;
    }

    function passesPickFilterFootball(item) {
      if (state.pickFilter === "ALL" || state.pickFilter === "SU") return true;

      if (state.pickFilter === "ATS") {
        return !!item.ats_side;
      }

      if (state.pickFilter === "OU") {
        const tp = (item.total_pick || "").toLowerCase();
        return tp && tp !== "no play";
      }

      return true;
    }

    function passesSportFilterFootball(sport) {
      if (state.sportFilter === "ALL") return sport === "NFL" || sport === "NCAAF";
      if (state.sportFilter === "NFL") return sport === "NFL";
      if (state.sportFilter === "NCAAF") return sport === "NCAAF";
      // If user selects UFC, football rows should be hidden:
      if (state.sportFilter === "UFC") return false;
      return true;
    }

    function passesSportFilterUFC() {
      return state.sportFilter === "ALL" || state.sportFilter === "UFC";
    }

    function passesPickFilterUFC() {
      // UFC is effectively SU only; only show when All or SU selected
      return state.pickFilter === "ALL" || state.pickFilter === "SU";
    }

    function passesConfFilterUFC(item) {
      const conf = item.win_pct ?? item.win_conf ?? item.win_prob;
      return passesConfFilter(conf);
    }

    // ================= RENDER =================
    function renderTables() {
      const fbBody = document.getElementById("football-body");
      const ufcBody = document.getElementById("ufc-body");
      fbBody.innerHTML = "";
      ufcBody.innerHTML = "";

      state.predictions.forEach(item => {
        const sport = getSport(item);

        if (sport === "UFC") {
          if (!passesSportFilterUFC()) return;
          if (!passesPickFilterUFC()) return;
          if (!passesConfFilterUFC(item)) return;

          const win = item.win_pct ?? item.win_conf ?? item.win_prob;
          const ko  = item.ko_pct ?? item.ko_prob;
          const sub = item.sub_pct ?? item.sub_prob;
          const dec = item.dec_pct ?? item.dec_prob;
          const r1  = item.r1_pct ?? item.r1_prob;
          const dist = item.goes_dist_pct ?? item.goes_dist_prob;
          const conf = win;

          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${item.matchup || ""}</td>
            <td>${item.pick || item.su_pick || ""}</td>
            <td class="${confClass(win)}">${win ?? ""}%</td>
            <td>${ko ?? ""}%</td>
            <td>${sub ?? ""}%</td>
            <td>${dec ?? ""}%</td>
            <td>${r1 ?? ""}%</td>
            <td>${dist ?? ""}%</td>
            <td class="${confClass(conf)}">${conf ?? ""}%</td>
          `;
          ufcBody.appendChild(row);
        } else if (sport === "NFL" || sport === "NCAAF") {
          if (!passesSportFilterFootball(sport)) return;
          if (!passesPickFilterFootball(item)) return;

          const confVal = getFootballConfForFilter(item);
          if (!passesConfFilter(confVal)) return;

          const atsClass =
            item.ats_side === "fav" ? "ats-fav" :
            item.ats_side === "dog" ? "ats-dog" : "";

          const suConf  = item.su_conf ?? item.su_prob;
          const atsConf = item.ats_conf ?? item.ats_cover_conf ?? item.ats_prob;

          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${item.matchup || ""}</td>
            <td>${item.su_pick || ""}</td>
            <td class="${confClass(suConf)}">${suConf ?? ""}%</td>
            <td class="${atsClass}">${(item.ats_side || "").toUpperCase()}</td>
            <td>${item.spread ?? ""}</td>
            <td class="${confClass(atsConf)}">${atsConf ?? ""}%</td>
            <td>${item.total ?? ""}</td>
            <td>${item.total_pick || ""}</td>
            <td class="${confClass(suConf)}">${suConf ?? ""}%</td>
            <td class="${confClass(atsConf)}">${atsConf ?? ""}%</td>
          `;
          fbBody.appendChild(row);
        }
      });
    }

    // ================= FILTER BUTTON LOGIC =================
    document.addEventListener("click", (e) => {
      const btn = e.target.closest(".filter-btn");
      if (!btn) return;

      const group = btn.dataset.filterGroup;
      const value = btn.dataset.value;
      if (!group || !value) return;

      // clear active in same group
      document.querySelectorAll(`.filter-btn[data-filter-group="${group}"]`)
        .forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      if (group === "sport") state.sportFilter = value;
      if (group === "conf")  state.confFilter  = value;
      if (group === "pick")  state.pickFilter  = value;

      renderTables();
    });

    // ================= SORTING =================
    document.addEventListener("DOMContentLoaded", () => {
      enableSorting("football-table");
      enableSorting("ufc-table");
    });

    function enableSorting(tableId) {
      const table = document.getElementById(tableId);
      if (!table) return;
      const headers = table.querySelectorAll("th");
      headers.forEach((th, idx) => {
        th.addEventListener("click", () => sortTable(table, idx));
      });
    }

    function sortTable(table, col) {
      const tbody = table.querySelector("tbody");
      const rows = Array.from(tbody.querySelectorAll("tr"));

      const isNumeric = rows.every(r => {
        const txt = r.children[col].innerText.replace("%","").trim();
        return txt === "" || !isNaN(parseFloat(txt));
      });

      rows.sort((a, b) => {
        const A = a.children[col].innerText.replace("%","").trim();
        const B = b.children[col].innerText.replace("%","").trim();
        if (isNumeric) {
          const aNum = parseFloat(A) || 0;
          const bNum = parseFloat(B) || 0;
          return bNum - aNum; // numeric descending
        }
        return A.localeCompare(B); // A→Z
      });

      tbody.innerHTML = "";
      rows.forEach(r => tbody.appendChild(r));
    }

    // ================= LOAD DATA =================
    fetch("predictions.json", { cache: "no-cache" })
      .then(r => r.json())
      .then(data => {
        const arr = Array.isArray(data) ? data : (data.data || data.predictions || []);
        state.predictions = arr || [];
        renderTables();
      })
      .catch(err => console.error("Error loading predictions.json", err));
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FBF Predictions Dashboard</title>

<style>
/* ============================================================
   GLOBAL
============================================================ */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  background-color: #111;
  color: #eee;
  padding: 20px;
  transition: background 0.3s, color 0.3s;
}

body.light {
  background-color: #f5f5f5;
  color: #222;
}

/* ============================================================
   HEADER + THEME TOGGLE
============================================================ */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
}

.header h1 {
  font-size: 26px;
  letter-spacing: 1px;
}

.theme-toggle {
  padding: 8px 14px;
  background: #444;
  border: none;
  color: #fff;
  border-radius: 6px;
  cursor: pointer;
}

body.light .theme-toggle {
  background: #ddd;
  color: #111;
}

/* ============================================================
   TABLE WRAPPER
============================================================ */
.section-title {
  font-size: 20px;
  font-weight: bold;
  margin: 25px 0 10px 0;
}

.table-container {
  width: 100%;
  overflow-x: auto;
  margin-bottom: 40px;
}

.pred-table {
  width: 100%;
  border-collapse: collapse;
  background: #1b1b1b;
  border-radius: 8px;
  overflow: hidden;
}

body.light .pred-table {
  background: #fff;
}

.pred-table th,
.pred-table td {
  padding: 10px 8px;
  border-bottom: 1px solid #333;
  text-align: center;
  font-size: 14px;
}

body.light .pred-table th,
body.light .pred-table td {
  border-bottom: 1px solid #ccc;
}

.pred-table th {
  background: #222;
  font-weight: bold;
  cursor: pointer;
}

body.light .pred-table th {
  background: #eee;
}

.pred-table tr:hover {
  background: #2b2b2b;
}

body.light .pred-table tr:hover {
  background: #eaeaea;
}

/* ATS highlight */
.ats-fav { color: #ff6666; font-weight: bold; }
.ats-dog { color: #66aaff; font-weight: bold; }

</style>
</head>

<body>

<!-- ============================================================
     HEADER
============================================================ -->
<div class="header">
  <h1>FBF Game Predictions</h1>
  <button class="theme-toggle" onclick="toggleTheme()">Dark / Light</button>
</div>

<!-- ============================================================
     FOOTBALL SECTION
============================================================ -->
<div class="section-title">NFL & College Football</div>

<div class="table-container">
<table class="pred-table" id="football-table">
  <thead>
    <tr>
      <th>Matchup</th>
      <th>Straight-Up</th>
      <th>SU %</th>
      <th>ATS</th>
      <th>Spread</th>
      <th>Cover %</th>
      <th>O/U</th>
      <th>Total Pick</th>
      <th>Conf (SU)</th>
      <th>Conf (ATS)</th>
    </tr>
  </thead>
  <tbody id="football-body"></tbody>
</table>
</div>

<!-- ============================================================
     UFC SECTION
============================================================ -->
<div class="section-title">UFC Fight Predictions</div>

<div class="table-container">
<table class="pred-table" id="ufc-table">
  <thead>
    <tr>
      <th>Fight</th>
      <th>Pick</th>
      <th>Win %</th>
      <th>KO %</th>
      <th>Sub %</th>
      <th>Dec %</th>
      <th>Round 1 %</th>
      <th>Goes Dist %</th>
      <th>Confidence</th>
    </tr>
  </thead>
  <tbody id="ufc-body"></tbody>
</table>
</div>

<!-- ============================================================
     JAVASCRIPT
============================================================ -->
<script>
/* ------------------------------------------------------------
   THEME TOGGLE
------------------------------------------------------------ */
function toggleTheme() {
  document.body.classList.toggle("light");
}

/* ------------------------------------------------------------
   LOAD PREDICTIONS.JSON
------------------------------------------------------------ */
fetch("predictions.json")
  .then(r => r.json())
  .then(data => renderData(data.data))
  .catch(err => console.error("Error loading predictions.json", err));


/* ------------------------------------------------------------
   RENDER BOTH TABLES
------------------------------------------------------------ */
function renderData(list) {
  const fb = document.getElementById("football-body");
  const ufc = document.getElementById("ufc-body");

  list.forEach(item => {
    if (item.sport && item.sport.includes("mma")) {
      // ================= UFC ROW =================
      const row = `
        <tr>
          <td>${item.matchup}</td>
          <td>${item.pick}</td>
          <td>${item.win_pct}%</td>
          <td>${item.ko_pct}%</td>
          <td>${item.sub_pct}%</td>
          <td>${item.dec_pct}%</td>
          <td>${item.r1_pct}%</td>
          <td>${item.goes_dist_pct}%</td>
          <td>${item.confidence}%</td>
        </tr>
      `;
      ufc.insertAdjacentHTML("beforeend", row);

    } else {
      // ================= FOOTBALL ROW =================
      const atsClass =
        item.ats_side === "fav" ? "ats-fav" :
        item.ats_side === "dog" ? "ats-dog" : "";

      const row = `
        <tr>
          <td>${item.matchup}</td>
          <td>${item.su_pick}</td>
          <td>${item.su_conf}%</td>
          <td class="${atsClass}">${item.ats_side.toUpperCase()}</td>
          <td>${item.spread}</td>
          <td>${item.ats_conf}%</td>
          <td>${item.total}</td>
          <td>${item.total_pick}</td>
          <td>${item.su_conf}%</td>
          <td>${item.ats_conf}%</td>
        </tr>
      `;

      fb.insertAdjacentHTML("beforeend", row);
    }
  });
}


/* ------------------------------------------------------------
   TABLE SORTING FOR BOTH TABLES
------------------------------------------------------------ */
document.addEventListener("DOMContentLoaded", () => {
  enableSorting("football-table");
  enableSorting("ufc-table");
});

function enableSorting(tableId) {
  const table = document.getElementById(tableId);
  if (!table) return;

  const headers = table.querySelectorAll("th");

  headers.forEach((header, index) => {
    header.addEventListener("click", () => sortTable(table, index));
  });
}

function sortTable(table, col) {
  const tbody = table.querySelector("tbody");
  const rows = Array.from(tbody.querySelectorAll("tr"));

  const isNumeric = rows.every(r =>
    !isNaN(parseFloat(r.children[col].innerText.replace("%","").trim()))
  );

  rows.sort((a, b) => {
    const A = a.children[col].innerText.replace("%","").trim();
    const B = b.children[col].innerText.replace("%","").trim();

    if (isNumeric) return parseFloat(B) - parseFloat(A);
    return A.localeCompare(B);
  });

  tbody.innerHTML = "";
  rows.forEach(r => tbody.appendChild(r));
}

</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FBF Predictions Dashboard</title>

<style>
/* ===== Global Reset ===== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  background-color: #111;
  color: #eee;
  transition: background 0.3s, color 0.3s;
  padding: 20px;
}

body.light {
  background-color: #fafafa;
  color: #222;
}

/* ===== Header ===== */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
}

.header h1 {
  font-size: 26px;
  font-weight: bold;
}

/* Theme Toggle */
.theme-toggle {
  padding: 8px 14px;
  background: #444;
  border: none;
  color: #fff;
  border-radius: 6px;
  cursor: pointer;
}

body.light .theme-toggle {
  background: #ddd;
  color: #111;
}

/* ===== Table Styling ===== */
.table-container {
  width: 100%;
  overflow-x: auto;
  margin-top: 15px;
  margin-bottom: 40px;
}

.pred-table {
  width: 100%;
  border-collapse: collapse;
  background: #1b1b1b;
  border-radius: 8px;
  overflow: hidden;
}

body.light .pred-table {
  background: #fff;
}

.pred-table th, .pred-table td {
  padding: 12px 10px;
  border-bottom: 1px solid #333;
  text-align: center;
  font-size: 14px;
}

body.light .pred-table th,
body.light .pred-table td {
  border-bottom: 1px solid #ccc;
}

.pred-table th {
  background: #222;
  font-weight: bold;
}

body.light .pred-table th {
  background: #eee;
}

tr:hover {
  background: #2b2b2b;
}

body.light tr:hover {
  background: #f2f2f2;
}

/* Highlight ATS picks */
.ats-fav {
  color: #ff6666;
  font-weight: bold;
}

.ats-dog {
  color: #66aaff;
  font-weight: bold;
}

/* UFC styles simple */
.ufc-title {
  font-size: 24px;
  font-weight: bold;
  margin-top: 30px;
  margin-bottom: 12px;
}

</style>
</head>

<body>

<div class="header">
  <h1>FBF Game Predictions</h1>
  <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
</div>

<!-- ====================== NFL/NCAAF TABLE ====================== -->
<div class="table-container">
<table class="pred-table" id="football-table">
  <thead>
    <tr>
      <th>Matchup</th>
      <th>Straight-Up</th>
      <th>SU Conf %</th>
      <th>ATS Pick</th>
      <th>Spread</th>
      <th>Cover %</th>
      <th>O/U</th>
      <th>Total Pick</th>
      <th>Conf (SU)</th>
      <th>Conf (ATS)</th>
    </tr>
  </thead>
  <tbody id="pred-body"></tbody>
</table>
</div>

<!-- ====================== UFC TABLE ====================== -->
<h2 class="ufc-title">UFC Predictions</h2>

<div class="table-container">
<table class="pred-table" id="ufc-table">
  <thead>
    <tr>
      <th>Fight</th>
      <th>Pick</th>
      <th>Win %</th>
      <th>KO/TKO %</th>
      <th>Sub %</th>
      <th>Dec %</th>
      <th>R1 %</th>
      <th>Goes Dist %</th>
      <th>Confidence</th>
    </tr>
  </thead>
  <tbody id="ufc-body"></tbody>
</table>
</div>

<script>
// ===== Theme Toggle =====
function toggleTheme() {
  document.body.classList.toggle("light");
}

// ===== Load Predictions =====
fetch("predictions.json")
  .then(resp => resp.json())
  .then(data => {
    renderFootball(data.data);
    renderUFC(data.data);
  })
  .catch(err => console.error("Error loading predictions.json:", err));

/* ========== Render Football Games ========== */
function renderFootball(list) {
  const tbody = document.getElementById("pred-body");
  tbody.innerHTML = "";

  list
    .filter(g => g.sport_key.includes("football"))
    .forEach(game => {
      const atsClass =
        game.ats_side === "fav" ? "ats-fav" :
        game.ats_side === "dog" ? "ats-dog" : "";

      const row = `
        <tr>
          <td>${game.matchup}</td>
          <td>${game.su_pick}</td>
          <td>${game.su_conf}%</td>
          <td class="${atsClass}">${game.ats_side.toUpperCase()}</td>
          <td>${game.spread}</td>
          <td>${game.ats_conf}%</td>
          <td>${game.total}</td>
          <td>${game.total_pick}</td>
          <td>${game.su_conf}%</td>
          <td>${game.ats_conf}%</td>
        </tr>
      `;
      tbody.insertAdjacentHTML("beforeend", row);
    });
}

/* ========== Render UFC ========== */
function renderUFC(list) {
  const tbody = document.getElementById("ufc-body");
  tbody.innerHTML = "";

  list
    .filter(f => f.sport_key === "mma_mixed_martial_arts")
    .forEach(fight => {
      const row = `
        <tr>
          <td>${fight.matchup}</td>
          <td>${fight.pick}</td>
          <td>${fight.win_pct}%</td>
          <td>${fight.ko_pct}%</td>
          <td>${fight.sub_pct}%</td>
          <td>${fight.dec_pct}%</td>
          <td>${fight.r1_pct}%</td>
          <td>${fight.goes_dist_pct}%</td>
          <td>${fight.confidence}%</td>
        </tr>
      `;
      tbody.insertAdjacentHTML("beforeend", row);
    });
}
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Forged By Freedom – Betting & DFS Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #05070b;
      --bg-alt: #0c1018;
      --card: #111827;
      --card-alt: #020617;
      --border: #1f2933;
      --accent: #f59e0b;
      --accent-soft: rgba(245,158,11,0.12);
      --accent-strong: rgba(245,158,11,0.2);
      --text: #e5e7eb;
      --text-soft: #9ca3af;
      --text-muted: #6b7280;
      --danger: #ef4444;
      --success: #22c55e;
      --warning: #facc15;
      --shadow-soft: 0 18px 35px rgba(0,0,0,0.6);
      --radius-lg: 18px;
      --radius-xl: 24px;
    }

    body.light {
      --bg: #f3f4f6;
      --bg-alt: #e5e7eb;
      --card: #ffffff;
      --card-alt: #f9fafb;
      --border: #d1d5db;
      --accent: #b45309;
      --accent-soft: rgba(180,83,9,0.08);
      --accent-strong: rgba(180,83,9,0.16);
      --text: #111827;
      --text-soft: #374151;
      --text-muted: #6b7280;
      --danger: #b91c1c;
      --success: #15803d;
      --warning: #a16207;
      --shadow-soft: 0 18px 35px rgba(15,23,42,0.18);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 45%, #000 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 16px;
      display: flex;
      justify-content: center;
    }

    .app-shell {
      width: 100%;
      max-width: 1320px;
      background: linear-gradient(145deg, var(--card-alt), var(--bg-alt));
      border-radius: 32px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148,163,184,0.15);
      padding: 20px 22px 26px;
      position: relative;
      overflow: hidden;
    }

    .grain {
      pointer-events: none;
      position: absolute;
      inset: 0;
      opacity: 0.06;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 160 160' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='noStitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.8'/%3E%3C/svg%3E");
      mix-blend-mode: soft-light;
    }

    header {
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 18px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 38px;
      height: 38px;
      border-radius: 999px;
      border: 1px solid rgba(248,250,252,0.08);
      background: radial-gradient(circle at 30% 20%, #facc15 0, #ea580c 40%, #111827 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 25px rgba(251,191,36,0.45);
      font-weight: 800;
      font-size: 20px;
      color: #0b1120;
    }

    .brand-main {
      display: flex;
      flex-direction: column;
    }

    .brand-title {
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .brand-sub {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.17em;
      color: var(--text-muted);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .pill {
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      border: 1px solid rgba(148,163,184,0.4);
      color: var(--text-soft);
      display: flex;
      align-items: center;
      gap: 6px;
      background: radial-gradient(circle at top left, rgba(248,250,252,0.08), transparent 60%);
    }

    .pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 5px rgba(34,197,94,0.15);
    }

    .theme-toggle {
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5);
      padding: 5px 11px;
      font-size: 11px;
      display: flex;
      align-items: center;
      gap: 6px;
      background: linear-gradient(135deg, rgba(15,23,42,0.9), rgba(15,23,42,0.4));
      color: var(--text-soft);
      cursor: pointer;
      transition: background 0.2s ease, border-color 0.2s ease, transform 0.08s ease;
    }

    .theme-toggle:hover {
      border-color: var(--accent);
      transform: translateY(-1px);
    }

    .theme-toggle span {
      font-size: 14px;
    }

    .grid {
      position: relative;
      z-index: 1;
      display: grid;
      grid-template-columns: minmax(0, 2.4fr) minmax(0, 1.4fr);
      gap: 16px;
    }

    @media (max-width: 980px) {
      .grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel {
      background: radial-gradient(circle at top left, rgba(148,163,184,0.4), transparent 55%),
                  linear-gradient(145deg, var(--card), var(--card-alt));
      border-radius: var(--radius-xl);
      border: 1px solid rgba(148,163,184,0.18);
      box-shadow: var(--shadow-soft);
      padding: 14px 14px 16px;
      position: relative;
      overflow: hidden;
    }

    .panel::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(248,250,252,0.08), transparent 55%);
      opacity: 0.9;
      mix-blend-mode: soft-light;
      pointer-events: none;
    }

    .panel-header {
      position: relative;
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 12px;
    }

    .panel-title {
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .panel-subtitle {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .sport-tabs {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px;
      border-radius: 999px;
      background: rgba(15,23,42,0.85);
      border: 1px solid rgba(148,163,184,0.5);
    }

    body.light .sport-tabs {
      background: rgba(243,244,246,0.85);
    }

    .sport-tab {
      border-radius: 999px;
      padding: 5px 10px;
      font-size: 11px;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      border: none;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      position: relative;
      z-index: 1;
    }

    .sport-tab.active {
      color: var(--accent);
      font-weight: 600;
      background: rgba(15,23,42,0.98);
      box-shadow: 0 0 0 1px rgba(248,250,252,0.08);
    }

    body.light .sport-tab.active {
      background: rgba(249,250,251,0.98);
    }

    .filters {
      position: relative;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }

    .search-input {
      flex: 1;
      min-width: 160px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.55);
      padding: 6px 10px;
      font-size: 12px;
      background: rgba(15,23,42,0.8);
      color: var(--text);
      outline: none;
    }

    body.light .search-input {
      background: rgba(249,250,251,0.9);
    }

    .search-input::placeholder {
      color: var(--text-muted);
    }

    .select {
      min-width: 110px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.55);
      background: rgba(15,23,42,0.9);
      color: var(--text-soft);
      font-size: 12px;
      padding: 6px 10px;
      outline: none;
    }

    body.light .select {
      background: rgba(249,250,251,0.9);
    }

    .table-wrapper {
      position: relative;
      border-radius: 18px;
      border: 1px solid rgba(31,41,55,0.85);
      background: linear-gradient(145deg, rgba(15,23,42,0.98), rgba(15,23,42,0.75));
      overflow: hidden;
      max-height: 600px;
      display: flex;
      flex-direction: column;
    }

    body.light .table-wrapper {
      background: linear-gradient(145deg, rgba(249,250,251,0.98), rgba(243,244,246,0.92));
      border-color: rgba(209,213,219,0.9);
    }

    .table-scroll {
      overflow: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    thead {
      background: linear-gradient(90deg, rgba(15,23,42,0.98), rgba(15,23,42,0.75));
    }

    body.light thead {
      background: linear-gradient(90deg, rgba(243,244,246,0.98), rgba(229,231,235,0.9));
    }

    thead th {
      position: sticky;
      top: 0;
      z-index: 3;
      text-align: left;
      padding: 8px 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.11em;
      font-size: 10px;
      color: var(--text-muted);
      border-bottom: 1px solid rgba(55,65,81,0.9);
      white-space: nowrap;
    }

    tbody tr:nth-child(even) {
      background: rgba(15,23,42,0.78);
    }

    body.light tbody tr:nth-child(even) {
      background: rgba(243,244,246,0.94);
    }

    tbody tr:nth-child(odd) {
      background: rgba(15,23,42,0.52);
    }

    body.light tbody tr:nth-child(odd) {
      background: rgba(249,250,251,0.96);
    }

    tbody td {
      padding: 7px 10px;
      border-bottom: 1px solid rgba(31,41,55,0.8);
      white-space: nowrap;
    }

    body.light tbody td {
      border-bottom-color: rgba(209,213,219,0.9);
    }

    tbody tr:last-child td {
      border-bottom: none;
    }

    .td-main {
      font-weight: 500;
      color: var(--text);
    }

    .td-sub {
      font-size: 11px;
      color: var(--text-muted);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .badge-fav {
      background: rgba(239,68,68,0.14);
      color: #fecaca;
      border: 1px solid rgba(239,68,68,0.5);
    }

    .badge-dog {
      background: rgba(59,130,246,0.14);
      color: #bfdbfe;
      border: 1px solid rgba(59,130,246,0.5);
    }

    .badge-over {
      background: rgba(34,197,94,0.14);
      color: #bbf7d0;
      border: 1px solid rgba(34,197,94,0.5);
    }

    .badge-under {
      background: rgba(234,179,8,0.14);
      color: #fef3c7;
      border: 1px solid rgba(234,179,8,0.5);
    }

    .edge-strong {
      color: var(--success);
      font-weight: 600;
    }

    .edge-medium {
      color: var(--accent);
      font-weight: 500;
    }

    .edge-weak {
      color: var(--text-soft);
    }

    .summary-grid {
      position: relative;
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    @media (max-width: 640px) {
      .summary-grid {
        grid-template-columns: minmax(0,1fr);
      }
    }

    .summary-card {
      border-radius: 18px;
      padding: 10px 11px;
      background: radial-gradient(circle at top left, var(--accent-soft), transparent 65%),
                  linear-gradient(145deg, rgba(15,23,42,0.98), rgba(15,23,42,0.8));
      border: 1px solid rgba(148,163,184,0.4);
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    body.light .summary-card {
      background: radial-gradient(circle at top left, var(--accent-soft), transparent 65%),
                  linear-gradient(145deg, #ffffff, #f3f4f6);
    }

    .summary-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-muted);
    }

    .summary-value {
      font-size: 16px;
      font-weight: 700;
    }

    .summary-sub {
      font-size: 11px;
      color: var(--text-soft);
    }

    .ufc-list {
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    .ufc-fight {
      border-radius: 16px;
      border: 1px solid rgba(148,163,184,0.45);
      background: linear-gradient(135deg, rgba(15,23,42,0.98), rgba(15,23,42,0.78));
      padding: 9px 10px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    body.light .ufc-fight {
      background: linear-gradient(135deg, #ffffff, #f3f4f6);
    }

    .ufc-main {
      display: flex;
      justify-content: space-between;
      gap: 8px;
    }

    .ufc-matchup {
      font-size: 13px;
      font-weight: 600;
    }

    .ufc-meta {
      font-size: 11px;
      color: var(--text-muted);
    }

    .ufc-pick {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .ufc-stats {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
      font-size: 10px;
      color: var(--text-soft);
    }

    .footer {
      position: relative;
      margin-top: 10px;
      font-size: 10px;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .footer span {
      white-space: nowrap;
    }
  </style>
</head>
<body class="dark">
  <div class="app-shell">
    <div class="grain"></div>
    <header>
      <div class="brand">
        <div class="brand-logo">F</div>
        <div class="brand-main">
          <div class="brand-title">Forged By Freedom</div>
          <div class="brand-sub">SU · ATS · TOTALS · DFS</div>
        </div>
      </div>
      <div class="header-right">
        <div class="pill">
          <div class="pill-dot"></div>
          <span>Live Model • Week Slate</span>
        </div>
        <button id="themeToggle" class="theme-toggle" type="button">
          <span>🌙</span>
          <span>Theme</span>
        </button>
      </div>
    </header>

    <div class="grid">
      <!-- Left: Main NFL/NCAAF table -->
      <section class="panel">
        <div class="panel-header">
          <div>
            <div class="panel-title">Football Board</div>
            <div class="panel-subtitle" id="panelSubtitle">NFL &amp; NCAAF • Sides &amp; Totals</div>
          </div>
          <div class="sport-tabs">
            <button class="sport-tab active" data-sport="NFL">NFL</button>
            <button class="sport-tab" data-sport="NCAAF">NCAAF</button>
          </div>
        </div>

        <div class="filters">
          <input id="searchInput" class="search-input" placeholder="Filter by team or matchup…" />
          <select id="minEdgeSelect" class="select">
            <option value="0">All Edges</option>
            <option value="3">≥ 3 pts edge</option>
            <option value="5">≥ 5 pts edge</option>
            <option value="7">≥ 7 pts edge</option>
          </select>
        </div>

        <div class="table-wrapper">
          <div class="table-scroll">
            <table>
              <thead>
                <tr>
                  <th>Matchup</th>
                  <th>Straight-Up</th>
                  <th>SU Conf %</th>
                  <th>ATS Pick</th>
                  <th>Spread</th>
                  <th>Cover %</th>
                  <th>O/U</th>
                  <th>Total Pick</th>
                  <th>Conf (SU)</th>
                  <th>Conf (ATS)</th>
                </tr>
              </thead>
              <tbody id="gamesBody">
                <!-- Rows injected by JS -->
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Right: Summary + UFC -->
      <section class="panel">
        <div class="panel-header">
          <div>
            <div class="panel-title">Slate Summary</div>
            <div class="panel-subtitle">Edges • Totals • UFC</div>
          </div>
        </div>

        <div class="summary-grid">
          <div class="summary-card">
            <div class="summary-label">Current Focus</div>
            <div class="summary-value" id="summarySport">NFL</div>
            <div class="summary-sub" id="summaryGames">– games loaded</div>
          </div>
          <div class="summary-card">
            <div class="summary-label">Top Edge (ATS)</div>
            <div class="summary-value" id="summaryTopEdge">–</div>
            <div class="summary-sub" id="summaryTopEdgeMeta">Waiting for data…</div>
          </div>
        </div>

        <div class="summary-card" style="margin-bottom: 8px;">
          <div class="summary-label">Totals Lean</div>
          <div class="summary-value" id="summaryTotals">–</div>
          <div class="summary-sub" id="summaryTotalsMeta">Over/Under distribution for current sport.</div>
        </div>

        <div class="panel-header" style="margin-top: 10px; margin-bottom: 6px;">
          <div>
            <div class="panel-title">UFC Board</div>
            <div class="panel-subtitle">Main card &amp; strong edges</div>
          </div>
        </div>

        <div class="ufc-list" id="ufcList">
          <!-- UFC fights injected by JS -->
        </div>
      </section>
    </div>

    <div class="footer">
      <span id="lastUpdated">Model: –</span>
      <span>Results are probabilistic and informational only. Bet responsibly.</span>
    </div>
  </div>

  <script>
    const state = {
      rawData: [],
      sport: "NFL",
      search: "",
      minEdge: 0,
      theme: "dark"
    };

    const SPORT_LABELS = {
      americanfootball_nfl: "NFL",
      NFL: "NFL",
      americanfootball_ncaaf: "NCAAF",
      NCAAF: "NCAAF",
      mma_mixed_martial_arts: "UFC",
      UFC: "UFC"
    };

    function mapSportKey(item) {
      const k = item.sport_key || item.sport || "";
      return SPORT_LABELS[k] || (k.toUpperCase().includes("NCAAF") ? "NCAAF"
        : k.toUpperCase().includes("NFL") ? "NFL"
        : k.toUpperCase().includes("MMA") ? "UFC"
        : "NFL");
    }

    function toPctFromFields(obj, confField, probField) {
      if (obj == null) return null;
      if (typeof obj[confField] === "number") {
        // assume already 0–100
        return obj[confField];
      }
      if (typeof obj[probField] === "number") {
        // assume 0–1
        return obj[probField] * 100;
      }
      return null;
    }

    function formatPct(v) {
      if (v == null || isNaN(v)) return "–";
      return v.toFixed(1).replace(/\.0$/, "") + "%";
    }

    function formatSpread(v) {
      if (v == null || isNaN(v)) return "–";
      if (Math.abs(v) < 1e-6) return "PK";
      return (v > 0 ? "+" : "") + v;
    }

    function classifyEdge(edgeValue) {
      const mag = Math.abs(edgeValue || 0);
      if (mag >= 7) return "edge-strong";
      if (mag >= 3) return "edge-medium";
      return "edge-weak";
    }

    function renderGames() {
      const tbody = document.getElementById("gamesBody");
      tbody.innerHTML = "";

      const sport = state.sport;
      const searchLower = (state.search || "").toLowerCase();
      const minEdge = state.minEdge || 0;

      const games = state.rawData
        .filter(g => {
          const s = mapSportKey(g);
          return s === sport;
        })
        .filter(g => {
          if (!searchLower) return true;
          const matchup = (g.matchup || "").toLowerCase();
          const fav = (g.fav_team || g.favorite || "").toLowerCase();
          const dog = (g.dog_team || g.underdog || "").toLowerCase();
          return matchup.includes(searchLower) ||
                 fav.includes(searchLower) ||
                 dog.includes(searchLower);
        })
        .filter(g => {
          const atsVal = typeof g.ats_value === "number" ? Math.abs(g.ats_value) : 0;
          return atsVal >= minEdge;
        });

      const frag = document.createDocumentFragment();

      games.forEach(g => {
        const suConf = toPctFromFields(g, "su_conf", "su_prob");
        const atsConf = toPctFromFields(g, "ats_conf", "ats_prob");
        const coverPct = toPctFromFields(g, "ats_cover_conf", "ats_conf") || atsConf;

        const suPick = g.su_pick || g.su_team || (g.fav_team || g.favorite || "–");
        const atsSideRaw = g.ats_side || g.ats_pick || "";
        let atsLabel = "–";
        let atsBadgeClass = "";
        if (atsSideRaw === "fav") {
          atsLabel = "Favorite";
          atsBadgeClass = "badge badge-fav";
        } else if (atsSideRaw === "dog") {
          atsLabel = "Underdog";
          atsBadgeClass = "badge badge-dog";
        } else if (atsSideRaw) {
          atsLabel = String(atsSideRaw).toUpperCase();
        }

        const totalPickRaw = g.total_pick || g.ou_pick || "";
        let totalLabel = "–";
        let totalBadgeClass = "";
        if (/over/i.test(totalPickRaw)) {
          totalLabel = "Over";
          totalBadgeClass = "badge badge-over";
        } else if (/under/i.test(totalPickRaw)) {
          totalLabel = "Under";
          totalBadgeClass = "badge badge-under";
        } else if (totalPickRaw) {
          totalLabel = String(totalPickRaw);
        }

        const matchup = g.matchup || `${g.away_team || "Away"}@${g.home_team || "Home"}`;
        const spread = g.spread != null ? g.spread : g.fav_spread;
        const ou = g.total != null ? g.total : g.total_line;

        const atsValue = typeof g.ats_value === "number" ? g.ats_value : 0;
        const edgeClass = classifyEdge(atsValue);

        const tr = document.createElement("tr");

        tr.innerHTML = `
          <td>
            <div class="td-main">${matchup}</div>
            <div class="td-sub">${g.commence_time || ""}</div>
          </td>
          <td>
            <div class="td-main">${suPick}</div>
          </td>
          <td><span class="${edgeClass}">${formatPct(suConf)}</span></td>
          <td>
            ${atsBadgeClass
              ? `<span class="${atsBadgeClass}">${atsLabel}</span>`
              : `<span>${atsLabel}</span>`}
          </td>
          <td>${formatSpread(spread)}</td>
          <td>${formatPct(coverPct)}</td>
          <td>${ou != null ? ou : "–"}</td>
          <td>
            ${totalBadgeClass
              ? `<span class="${totalBadgeClass}">${totalLabel}</span>`
              : `<span>${totalLabel}</span>`}
          </td>
          <td>${formatPct(suConf)}</td>
          <td>${formatPct(atsConf)}</td>
        `;
        frag.appendChild(tr);
      });

      tbody.appendChild(frag);

      // Summary for right panel
      updateSummary(games);
    }

    function updateSummary(games) {
      const sportLabel = state.sport;
      const summarySport = document.getElementById("summarySport");
      const summaryGames = document.getElementById("summaryGames");
      const summaryTopEdge = document.getElementById("summaryTopEdge");
      const summaryTopEdgeMeta = document.getElementById("summaryTopEdgeMeta");
      const summaryTotals = document.getElementById("summaryTotals");
      const summaryTotalsMeta = document.getElementById("summaryTotalsMeta");

      summarySport.textContent = sportLabel;
      summaryGames.textContent = `${games.length} games in view`;

      if (!games.length) {
        summaryTopEdge.textContent = "–";
        summaryTopEdgeMeta.textContent = "No games match your filters.";
        summaryTotals.textContent = "–";
        summaryTotalsMeta.textContent = "Adjust filters to see totals distribution.";
        return;
      }

      let top = null;
      games.forEach(g => {
        const v = typeof g.ats_value === "number" ? Math.abs(g.ats_value) : 0;
        if (!top || v > top.edge) {
          top = {
            edge: v,
            item: g
          };
        }
      });

      if (top && top.item) {
        const matchup = top.item.matchup || "Top ATS Edge";
        const side = top.item.ats_side === "dog" ? "Underdog" :
                     top.item.ats_side === "fav" ? "Favorite" :
                     (top.item.ats_side || "Lean");
        const atsConf = toPctFromFields(top.item, "ats_conf", "ats_prob");

        summaryTopEdge.textContent = `${matchup}`;
        summaryTopEdgeMeta.textContent = `${side} • Edge ≈ ${top.edge.toFixed(1)} pts • ${formatPct(atsConf)} cover`;
      } else {
        summaryTopEdge.textContent = "–";
        summaryTopEdgeMeta.textContent = "No clear ATS edge computed.";
      }

      // Totals distribution
      let overCount = 0, underCount = 0;
      games.forEach(g => {
        const tp = (g.total_pick || g.ou_pick || "").toLowerCase();
        if (tp.includes("over")) overCount++;
        else if (tp.includes("under")) underCount++;
      });
      const totalCount = overCount + underCount;
      if (totalCount === 0) {
        summaryTotals.textContent = "Balanced";
        summaryTotalsMeta.textContent = "No strong totals leans logged yet.";
      } else {
        const overPct = (overCount / totalCount) * 100;
        const underPct = 100 - overPct;
        summaryTotals.textContent = overPct >= underPct
          ? `Over ${overPct.toFixed(0)}%`
          : `Under ${underPct.toFixed(0)}%`;
        summaryTotalsMeta.textContent = `Overs: ${overCount} • Unders: ${underCount}`;
      }
    }

    function renderUFC() {
      const container = document.getElementById("ufcList");
      container.innerHTML = "";

      const fights = state.rawData.filter(g => mapSportKey(g) === "UFC");
      if (!fights.length) {
        const div = document.createElement("div");
        div.className = "td-sub";
        div.textContent = "No UFC fights found in predictions.json.";
        container.appendChild(div);
        return;
      }

      fights.sort((a, b) => {
        const ta = a.commence_time || "";
        const tb = b.commence_time || "";
        return ta.localeCompare(tb);
      });

      fights.forEach(f => {
        const suPick = f.su_pick || f.pick || f.fav_fighter || "Pick";
        const winConf = toPctFromFields(f, "su_conf", "win_prob");
        const koPct  = toPctFromFields(f, "ko_tko_pct", "ko_prob");
        const subPct = toPctFromFields(f, "sub_pct", "sub_prob");
        const decPct = toPctFromFields(f, "dec_pct", "dec_prob");
        const r1Pct  = toPctFromFields(f, "r1_pct", "r1_prob");
        const distPct = toPctFromFields(f, "goes_dist_pct", "goes_dist_prob");

        const matchup = f.matchup || `${f.dog_name || "Red"} vs ${f.fav_name || "Blue"}`;
        const commence = f.commence_time || "";
        const edgeClass = classifyEdge(typeof f.ats_value === "number" ? f.ats_value : 0);

        const el = document.createElement("div");
        el.className = "ufc-fight";
        el.innerHTML = `
          <div class="ufc-main">
            <div>
              <div class="ufc-matchup">${matchup}</div>
              <div class="ufc-meta">${commence}</div>
            </div>
            <div style="text-align: right;">
              <div class="ufc-pick ${edgeClass}">${suPick}</div>
              <div class="td-sub">${formatPct(winConf)} win</div>
            </div>
          </div>
          <div class="ufc-stats">
            <span>KO/TKO: ${formatPct(koPct)}</span>
            <span>Sub: ${formatPct(subPct)}</span>
            <span>Dec: ${formatPct(decPct)}</span>
            <span>R1: ${formatPct(r1Pct)}</span>
            <span>Goes Dist: ${formatPct(distPct)}</span>
          </div>
        `;
        container.appendChild(el);
      });
    }

    function updateLastUpdated(ts) {
      const el = document.getElementById("lastUpdated");
      if (!ts) {
        el.textContent = "Model: timestamp unknown";
        return;
      }
      el.textContent = `Model: ${ts}`;
    }

    function attachEvents() {
      document.querySelectorAll(".sport-tab").forEach(btn => {
        btn.addEventListener("click", () => {
          document.querySelectorAll(".sport-tab").forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          state.sport = btn.dataset.sport;
          document.getElementById("panelSubtitle").textContent =
            state.sport + " • Sides & Totals";
          renderGames();
        });
      });

      document.getElementById("searchInput").addEventListener("input", e => {
        state.search = e.target.value || "";
        renderGames();
      });

      document.getElementById("minEdgeSelect").addEventListener("change", e => {
        state.minEdge = parseFloat(e.target.value || "0");
        renderGames();
      });

      const themeToggle = document.getElementById("themeToggle");
      themeToggle.addEventListener("click", () => {
        state.theme = state.theme === "dark" ? "light" : "dark";
        document.body.className = state.theme;
        themeToggle.firstElementChild.textContent = state.theme === "dark" ? "🌙" : "☀️";
      });
    }

    async function loadData() {
      try {
        const res = await fetch("predictions.json", { cache: "no-cache" });
        const json = await res.json();
        const data = json.data || json.predictions || json || [];
        state.rawData = Array.isArray(data) ? data : [];
        updateLastUpdated(json.timestamp || json.ts || "");
        renderGames();
        renderUFC();
      } catch (err) {
        console.error("Failed to load predictions.json", err);
        updateLastUpdated(null);
      }
    }

    // Init
    attachEvents();
    loadData();
  </script>
</body>
</html>
cd ~/Documents/fbf-data
nano index.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Forged By Freedom — Live Odds & Picks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --bg: #050608;
      --bg-alt: #0f1115;
      --card-bg: #151822;
      --card-muted: #1b1e29;
      --text: #f9fafb;
      --text-muted: #9ca3af;
      --accent: #f97316;
      --accent-soft: rgba(249, 115, 22, 0.18);
      --border-subtle: #1f2933;
      --danger: #f97373;
      --danger-soft: rgba(248, 113, 113, 0.18);
      --warn: #facc15;
      --warn-soft: rgba(250, 204, 21, 0.18);
      --success: #4ade80;
      --success-soft: rgba(74, 222, 128, 0.18);
      --pill-bg: #111827;
      --pill-border: #1f2937;
      --pill-text: #e5e7eb;
      --shadow-high: 0 0 18px rgba(74, 222, 128, 0.4);
    }

    body[data-theme="light"] {
      --bg: #f3f4f6;
      --bg-alt: #e5e7eb;
      --card-bg: #ffffff;
      --card-muted: #f3f4f6;
      --text: #0f172a;
      --text-muted: #4b5563;
      --accent: #ea580c;
      --accent-soft: rgba(234, 88, 12, 0.16);
      --border-subtle: #d1d5db;
      --danger: #dc2626;
      --danger-soft: rgba(220, 38, 38, 0.12);
      --warn: #eab308;
      --warn-soft: rgba(234, 179, 8, 0.12);
      --success: #16a34a;
      --success-soft: rgba(22, 163, 74, 0.16);
      --pill-bg: #e5e7eb;
      --pill-border: #cbd5f5;
      --pill-text: #111827;
      --shadow-high: 0 0 16px rgba(22, 163, 74, 0.35);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #111827 0, #020617 38%, #000 70%);
      color: var(--text);
      min-height: 100vh;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 12px 32px;
    }

    /* HEADER */
    .header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      padding: 16px 18px;
      margin-bottom: 14px;
      border-radius: 18px;
      background: radial-gradient(circle at top left, #111827 0, #020617 40%, #000 85%);
      border: 1px solid rgba(148, 163, 184, 0.18);
      box-shadow:
        0 18px 40px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(15, 23, 42, 0.85);
    }

    .header-main {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .logo-circle {
      width: 56px;
      height: 56px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #f97316 0, #b91c1c 50%, #020617 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #f9fafb;
      font-weight: 800;
      font-size: 22px;
      letter-spacing: 1px;
      box-shadow:
        0 0 18px rgba(249, 115, 22, 0.7),
        0 0 0 1px rgba(15, 23, 42, 0.9);
    }

    .header-text h1 {
      margin: 0;
      font-size: 22px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .header-text .tagline-main {
      margin-top: 3px;
      font-size: 12px;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--accent);
    }

    .header-text .tagline-sub {
      margin-top: 4px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .header-text .link {
      margin-top: 4px;
      font-size: 12px;
      color: #93c5fd;
      text-decoration: none;
    }

    .header-text .link:hover {
      text-decoration: underline;
    }

    .header-controls {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: flex-end;
      min-width: 230px;
    }

    .theme-toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      padding: 6px 10px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: linear-gradient(135deg, #020617, #0b1120);
      color: #e5e7eb;
      font-size: 11px;
      cursor: pointer;
      user-select: none;
    }

    body[data-theme="light"] .theme-toggle {
      background: linear-gradient(135deg, #f9fafb, #e5e7eb);
      color: #0f172a;
    }

    .theme-toggle span.icon {
      font-size: 14px;
    }

    .last-updated {
      font-size: 11px;
      color: var(--text-muted);
    }

    /* FILTER BAR */
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 12px;
      padding: 10px 12px;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 14px;
      border: 1px solid rgba(51, 65, 85, 0.7);
      box-shadow: 0 10px 28px rgba(15, 23, 42, 0.8);
      font-size: 12px;
    }

    body[data-theme="light"] .filters {
      background: #e5e7eb;
      border-color: #cbd5e1;
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.18);
    }

    .filters-group {
      display: flex;
      align-items: center;
      gap: 6px;
      min-width: 0;
    }

    .filters-group label {
      white-space: nowrap;
      color: var(--text-muted);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .filters select {
      background: var(--pill-bg);
      color: var(--pill-text);
      border-radius: 999px;
      border: 1px solid var(--pill-border);
      padding: 5px 8px;
      font-size: 12px;
      outline: none;
      min-width: 120px;
    }

    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-left: auto;
      font-size: 11px;
      color: var(--text-muted);
    }

    .legend span {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }

    .badge {
      width: 10px;
      height: 10px;
      border-radius: 999px;
    }

    .badge-low {
      background: var(--danger);
      box-shadow: 0 0 8px var(--danger-soft);
    }

    .badge-med {
      background: var(--warn);
      box-shadow: 0 0 8px var(--warn-soft);
    }

    .badge-high {
      background: var(--success);
      box-shadow: 0 0 10px var(--success-soft);
    }

    /* SECTION TITLES / DIVIDERS */
    .date-block {
      margin-top: 18px;
    }

    .date-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      padding-top: 4px;
    }

    .date-line {
      flex: 1;
      height: 1px;
      background: linear-gradient(
        to right,
        transparent,
        rgba(148, 163, 184, 0.7),
        transparent
      );
    }

    .date-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
      white-space: nowrap;
    }

    .sport-header {
      margin: 10px 0 6px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .sport-header span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 10px var(--accent-soft);
    }

    /* GAME GRID / CARD */
    .games-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 10px;
    }

    .game-card {
      background: radial-gradient(circle at top left, #1f2937 0, var(--card-bg) 55%, #020617 100%);
      border-radius: 16px;
      padding: 10px 10px 10px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      box-shadow:
        0 12px 26px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(15, 23, 42, 0.95);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    body[data-theme="light"] .game-card {
      background: linear-gradient(145deg, #ffffff, #f3f4f6);
      border-color: #d1d5db;
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.18);
    }

    .game-card.muted {
      opacity: 0.75;
      background: var(--card-muted);
    }

    .game-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .matchup {
      display: flex;
      flex-direction: column;
      gap: 3px;
      min-width: 0;
    }

    .match-line {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      font-weight: 600;
    }

    .match-line span.teams {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .sport-tag {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-muted);
    }

    .meta-line {
      display: flex;
      gap: 6px;
      font-size: 11px;
      color: var(--text-muted);
      flex-wrap: wrap;
    }

    .meta-pill {
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(55, 65, 81, 0.8);
    }

    body[data-theme="light"] .meta-pill {
      background: #e5e7eb;
      border-color: #cbd5e1;
    }

    .logo-stack {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 4px;
      min-width: 70px;
    }

    .team-logo-row {
      display: flex;
      align-items: center;
      gap: 4px;
      justify-content: flex-end;
    }

    .logo-circle-team {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #1e293b 0, #020617 55%, #000 100%);
      border: 1px solid rgba(148, 163, 184, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 600;
      color: #e5e7eb;
    }

    body[data-theme="light"] .logo-circle-team {
      background: radial-gradient(circle at 30% 20%, #e5e7eb 0, #d1d5db 50%, #9ca3af 100%);
      color: #111827;
    }

    .team-abbr {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    /* PICKS TABLE */
    .picks-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 4px;
      font-size: 11px;
    }

    .picks-table thead tr th {
      text-align: center;
      padding: 3px 4px;
      font-weight: 500;
      color: var(--text-muted);
      border-bottom: 1px solid rgba(55, 65, 81, 0.8);
    }

    .picks-table tbody tr td {
      padding: 5px 4px 4px;
      text-align: center;
    }

    .pick-pill {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2px;
      min-width: 78px;
      border-radius: 999px;
      padding: 2px 6px;
      font-size: 11px;
      border: 1px solid var(--pill-border);
      background: var(--pill-bg);
      color: var(--pill-text);
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.7);
    }

    .pick-pill span.main {
      font-weight: 600;
      white-space: nowrap;
    }

    .pick-pill span.sub {
      font-size: 10px;
      color: var(--text-muted);
    }

    .pick-low {
      border-color: var(--danger);
      background: radial-gradient(circle at top, var(--danger-soft), var(--pill-bg));
      box-shadow: 0 0 10px var(--danger-soft);
    }

    .pick-med {
      border-color: var(--warn);
      background: radial-gradient(circle at top, var(--warn-soft), var(--pill-bg));
      box-shadow: 0 0 10px var(--warn-soft);
    }

    .pick-high {
      border-color: var(--success);
      background: radial-gradient(circle at top, var(--success-soft), var(--pill-bg));
      box-shadow: var(--shadow-high);
    }

    .pick-none {
      opacity: 0.6;
      border-style: dashed;
      border-color: rgba(75, 85, 99, 0.85);
      background: rgba(15, 23, 42, 0.9);
      box-shadow: none;
    }

    body[data-theme="light"] .pick-none {
      background: #e5e7eb;
      border-color: #cbd5e1;
    }

    .pick-label-none {
      color: var(--text-muted);
    }

    @media (max-width: 640px) {
      .header {
        align-items: flex-start;
      }
      .header-controls {
        align-items: flex-start;
      }
      .legend {
        justify-content: flex-start;
      }
    }
  </style>
</head>
<body data-theme="dark">
  <div class="page">
    <!-- HEADER -->
    <header class="header">
      <div class="header-main">
        <div class="logo-circle">FBF</div>
        <div class="header-text">
          <h1>Forged By Freedom Strength &amp; Nutrition</h1>
          <div class="tagline-main">Strength &ndash; Discipline &ndash; Freedom</div>
          <div class="tagline-sub">
            For all your training, supplementation, and nutrition needs.
          </div>
          <a class="link" href="https://forgedbyfreedom.org" target="_blank" rel="noreferrer">
            ForgedByFreedom.org
          </a>
        </div>
      </div>
      <div class="header-controls">
        <div class="theme-toggle" id="themeToggle">
          <span class="icon" id="themeIcon">🔥</span>
          <span id="themeLabel">Black Ops Dark Mode</span>
        </div>
        <div class="last-updated" id="lastUpdated">Last updated: --</div>
      </div>
    </header>

    <!-- FILTERS / LEGEND -->
    <section class="filters">
      <div class="filters-group">
        <label for="sportFilter">Sport</label>
        <select id="sportFilter">
          <option value="all">All Sports</option>
          <option value="americanfootball_nfl">NFL</option>
          <option value="americanfootball_ncaaf">College Football</option>
          <option value="mma_mixed_martial_arts">UFC</option>
          <option value="basketball_nba">NBA</option>
          <option value="basketball_ncaab">College Basketball</option>
          <option value="icehockey_nhl">NHL</option>
        </select>
      </div>

      <div class="filters-group">
        <label for="confFilter">Confidence</label>
        <select id="confFilter">
          <option value="all">All Levels</option>
          <option value="high">High (70%+)</option>
          <option value="med">Medium (56–69%)</option>
          <option value="low">Low (&lt;=55%)</option>
          <option value="noplay">Show No-Plays Only</option>
        </select>
      </div>

      <div class="filters-group">
        <label for="pickFilter">Pick Type</label>
        <select id="pickFilter">
          <option value="all">SU + ATS + O/U</option>
          <option value="su">Straight Up Focus</option>
          <option value="ats">Against The Spread</option>
          <option value="ou">Totals Only</option>
        </select>
      </div>

      <div class="legend">
        <span><span class="badge badge-low"></span> Low (0–55%)</span>
        <span><span class="badge badge-med"></span> Medium (56–69%)</span>
        <span><span class="badge badge-high"></span> High (70%+)</span>
      </div>
    </section>

    <!-- GAME CONTAINER -->
    <main id="gameContainer"></main>
  </div>

  <script>
    // --- Light/Dark THEME TOGGLE ---
    (function() {
      const body = document.body;
      const toggle = document.getElementById("themeToggle");
      const icon = document.getElementById("themeIcon");
      const label = document.getElementById("themeLabel");

      const saved = localStorage.getItem("fbf_theme");
      if (saved === "light" || saved === "dark") {
        body.setAttribute("data-theme", saved);
      }

      function syncLabel() {
        const mode = body.getAttribute("data-theme");
        if (mode === "light") {
          icon.textContent = "🌤️";
          label.textContent = "Light Mode";
        } else {
          icon.textContent = "🔥";
          label.textContent = "Black Ops Dark Mode";
        }
      }

      syncLabel();

      toggle.addEventListener("click", () => {
        const mode = body.getAttribute("data-theme") === "dark" ? "light" : "dark";
        body.setAttribute("data-theme", mode);
        localStorage.setItem("fbf_theme", mode);
        syncLabel();
      });
    })();

    // --- TEAM LOGO / ABBR HELPERS (fallback if logo not mapped) ---
    const TEAM_META = {
      // NFL (examples – others fall back gracefully)
      "New England Patriots": { abbr: "NE" },
      "New York Jets": { abbr: "NYJ" },
      "Miami Dolphins": { abbr: "MIA" },
      "Washington Commanders": { abbr: "WAS" },
      "Buffalo Bills": { abbr: "BUF" },
      "Tampa Bay Buccaneers": { abbr: "TB" },
      "Carolina Panthers": { abbr: "CAR" },
      "Atlanta Falcons": { abbr: "ATL" },
      "Chicago Bears": { abbr: "CHI" },
      "Minnesota Vikings": { abbr: "MIN" },
      "Cincinnati Bengals": { abbr: "CIN" },
      "Pittsburgh Steelers": { abbr: "PIT" },
      "Green Bay Packers": { abbr: "GB" },
      "New York Giants": { abbr: "NYG" },

      // UFC – use 3-letter from surname
      // Example:
      // "Tom Aspinall": { abbr: "ASP" },
      // "Ciryl Gane": { abbr: "GAN" },
    };

    function getTeamAbbr(name) {
      if (!name) return "";
      const meta = TEAM_META[name];
      if (meta && meta.abbr) return meta.abbr;
      const words = name.split(" ");
      const letters = words
        .filter(Boolean)
        .map(w => w[0])
        .join("")
        .toUpperCase();
      return letters.slice(0, 3);
    }

    // --- CONFIDENCE → CLASS ---
    function classifyConfidence(pct) {
      if (pct == null) return null;
      if (pct >= 70) return "high";
      if (pct >= 56) return "med";
      return "low";
    }

    // --- MODEL HELPERS (deterministic, no RNG) ---
    function computeATS(game) {
      const favTeam = game.fav_team;
      const dogTeam = game.dog_team;
      const favSpread = typeof game.fav_spread === "number" ? game.fav_spread : null;
      const dogSpread = typeof game.dog_spread === "number" ? game.dog_spread : null;

      if (!favTeam || !dogTeam || favSpread === null || dogSpread === null) {
        return { label: null, confidence: null, side: null };
      }

      const absLine = Math.abs(favSpread);
      const sign = favSpread < 0 ? -1 : 1;

      // Edge sign: >0 → like favorite, <0 → like dog
      let edge;
      if (absLine <= 2.5) {
        edge = -1.0 * sign; // close game → dog bias
      } else if (absLine <= 5.5) {
        edge = -0.4 * sign; // small lean to dog
      } else if (absLine <= 9.5) {
        edge = 0.7 * sign;  // decent lean to favorite
      } else {
        edge = 1.1 * sign;  // big number → favors favorite
      }

      let pickTeam;
      let pickSpread;
      if (edge > 0.15) {
        pickTeam = favTeam;
        pickSpread = favSpread;
      } else if (edge < -0.15) {
        pickTeam = dogTeam;
        pickSpread = dogSpread;
      } else {
        // "No-Play" zone
        return { label: "No Play", confidence: 52, side: "none" };
      }

      const base = 54;
      const conf = Math.max(52, Math.min(74, base + Math.abs(edge) * 9));

      let spreadTxt = pickSpread === 0 || Math.abs(pickSpread) < 1e-6
        ? "PK"
        : (pickSpread > 0 ? "+" + pickSpread : "" + pickSpread);

      const label = pickTeam + " " + spreadTxt;

      return {
        label,
        confidence: conf,
        side: pickTeam === favTeam ? "favorite" : "dog"
      };
    }

    function computeSU(game) {
      const favTeam = game.fav_team;
      const dogTeam = game.dog_team;
      const favSpread = typeof game.fav_spread === "number" ? game.fav_spread : null;
      if (!favTeam || !dogTeam || favSpread === null) {
        return { label: null, confidence: null, side: null };
      }

      const absLine = Math.abs(favSpread);
      let pickTeam = favTeam;
      let confBase;

      if (absLine <= 1.5) {
        // coin flip region → allow structured upsets
        const home = game.home_team;
        const away = game.away_team;
        // Deterministic "upset" rule: if home name is lexicographically later and is dog → home upset
        if (home === dogTeam && home.localeCompare(away) > 0) {
          pickTeam = dogTeam;
          confBase = 56;
        } else {
          pickTeam = favTeam;
          confBase = 59;
        }
      } else if (absLine <= 3) {
        confBase = 60;
      } else if (absLine <= 6.5) {
        confBase = 63;
      } else if (absLine <= 9.5) {
        confBase = 67;
      } else {
        confBase = 72;
      }

      const label = pickTeam;
      const side = pickTeam === favTeam ? "favorite" : "dog";

      return {
        label,
        confidence: confBase,
        side
      };
    }

    function computeOU(game) {
      const total = typeof game.total === "number" ? game.total : null;
      if (total === null) {
        return { label: null, confidence: null, side: null };
      }

      // anchor around 45 for football, 220 for NBA, 135 CBB, 6 for NHL, 2.5/ rounds for UFC (if available)
      let anchor;
      if (game.sport_key === "americanfootball_nfl" || game.sport_key === "americanfootball_ncaaf") {
        anchor = 45;
      } else if (game.sport_key === "basketball_nba") {
        anchor = 224;
      } else if (game.sport_key === "basketball_ncaab") {
        anchor = 142;
      } else if (game.sport_key === "icehockey_nhl") {
        anchor = 6;
      } else if (game.sport_key === "mma_mixed_martial_arts") {
        anchor = 2.5;
      } else {
        anchor = total;
      }

      const diff = total - anchor;
      const absDiff = Math.abs(diff);

      if (absDiff < (game.sport_key.includes("basketball") ? 3.0 : 1.5)) {
        // total is too tight → No Play
        return { label: "No Play", confidence: 52, side: "none" };
      }

      let side;
      if (diff < 0) {
        side = "over";
      } else {
        side = "under";
      }

      let base = 54;
      let conf = base + absDiff * 4;
      conf = Math.max(53, Math.min(72, conf));

      const label = (side === "over" ? "Over " : "Under ") + total;

      return {
        label,
        confidence: conf,
        side
      };
    }

    // UFC-specific tweak (we only really care SU)
    function computeUFC(game) {
      const favTeam = game.fav_team;
      const dogTeam = game.dog_team;
      const favPrice = typeof game.fav_price === "number" ? game.fav_price : null;
      const dogPrice = typeof game.dog_price === "number" ? game.dog_price : null;

      if (!favTeam && !dogTeam) {
        return {
          su: { label: null, confidence: null, side: null },
          ats: { label: "N/A", confidence: null, side: "none" },
          ou: { label: "N/A", confidence: null, side: "none" },
        };
      }

      // SU based on prices
      let suLabel;
      let suConf;
      let suSide = "favorite";

      if (favTeam) {
        suLabel = favTeam;
        if (favPrice != null) {
          // Heavier chalk → higher confidence
          if (favPrice <= -250) suConf = 73;
          else if (favPrice <= -180) suConf = 68;
          else if (favPrice <= -140) suConf = 64;
          else suConf = 60;
        } else {
          suConf = 62;
        }
      } else {
        suLabel = dogTeam;
        suSide = "dog";
        suConf = 58;
      }

      // No ATS, no true total edge in this layout
      return {
        su: { label: suLabel, confidence: suConf, side: suSide },
        ats: { label: "N/A", confidence: null, side: "none" },
        ou: { label: "N/A", confidence: null, side: "none" },
      };
    }

    // --- RENDER HELPERS ---
    function confidenceClass(pct) {
      const tier = classifyConfidence(pct);
      if (!tier) return "pick-none";

      if (tier === "high") return "pick-high";
      if (tier === "med") return "pick-med";
      if (tier === "low") return "pick-low";
      return "pick-none";
    }

    function buildPickCell(model, type, filters) {
      const td = document.createElement("td");

      if (!model.label) {
        const div = document.createElement("div");
        div.className = "pick-pill pick-none";
        div.innerHTML = `
          <span class="main pick-label-none">--</span>
          <span class="sub">No Data</span>
        `;
        td.appendChild(div);
        return td;
      }

      // Respect "No Play" special tag
      const isNoPlay = model.label === "No Play" || model.side === "none";

      if (filters.pickFilter === "su" && type !== "su") {
        // Show muted for other columns
      } else if (filters.pickFilter === "ats" && type !== "ats") {
        // Show muted
      } else if (filters.pickFilter === "ou" && type !== "ou") {
        // Show muted
      }

      if (filters.confFilter === "noplay" && !isNoPlay) {
        // This row will be filtered at game-level in JS; cell still built
      }

      const pct = model.confidence != null ? model.confidence.toFixed(1) : "--";
      let cls = isNoPlay || model.confidence == null
        ? "pick-none"
        : confidenceClass(model.confidence);

      const div = document.createElement("div");
      div.className = "pick-pill " + cls;

      const main = document.createElement("span");
      main.className = "main";
      main.textContent = model.label;

      const sub = document.createElement("span");
      sub.className = "sub";
      sub.textContent = model.confidence ? model.confidence.toFixed(1) + "%" : "--";

      div.appendChild(main);
      div.appendChild(sub);
      td.appendChild(div);
      return td;
    }

    function sportLabel(sportKey) {
      switch (sportKey) {
        case "americanfootball_nfl": return "NFL";
        case "americanfootball_ncaaf": return "College Football";
        case "basketball_nba": return "NBA";
        case "basketball_ncaab": return "College Basketball";
        case "icehockey_nhl": return "NHL";
        case "mma_mixed_martial_arts": return "UFC";
        default: return sportKey;
      }
    }

    function sportOrder(sportKey) {
      switch (sportKey) {
        case "americanfootball_nfl": return 1;
        case "americanfootball_ncaaf": return 2;
        case "mma_mixed_martial_arts": return 3;
        case "basketball_nba": return 4;
        case "basketball_ncaab": return 5;
        case "icehockey_nhl": return 6;
        default: return 9;
      }
    }

    function formatDateHeader(iso) {
      const d = new Date(iso);
      if (Number.isNaN(d.getTime())) return iso;
      return d.toLocaleDateString(undefined, {
        weekday: "short",
        month: "short",
        day: "numeric"
      });
    }

    function formatTime(iso) {
      const d = new Date(iso);
      if (Number.isNaN(d.getTime())) return "";
      return d.toLocaleTimeString(undefined, {
        hour: "numeric",
        minute: "2-digit"
      });
    }

    function createGameCard(game, filters) {
      const card = document.createElement("article");
      card.className = "game-card";

      const hasAnyConfidence =
        (game.picks_su && game.picks_su.confidence) ||
        (game.picks_ats && game.picks_ats.confidence) ||
        (game.picks_ou && game.picks_ou.confidence);

      if (!hasAnyConfidence) {
        card.classList.add("muted");
      }

      const top = document.createElement("div");
      top.className = "game-top";

      const left = document.createElement("div");
      left.className = "matchup";

      const matchLine = document.createElement("div");
      matchLine.className = "match-line";
      const teams = document.createElement("span");
      teams.className = "teams";
      teams.textContent = game.matchup;
      matchLine.appendChild(teams);

      const sport = document.createElement("div");
      sport.className = "sport-tag";
      sport.textContent = sportLabel(game.sport_key) + " • " + formatTime(game.commence_time);

      const meta = document.createElement("div");
      meta.className = "meta-line";

      const favText = game.favorite ? game.favorite : "--";
      const dogText = game.underdog ? game.underdog : "--";
      const totalText = game.total != null ? String(game.total) : "--";

      const mFav = document.createElement("span");
      mFav.className = "meta-pill";
      mFav.textContent = "Fav: " + favText;

      const mDog = document.createElement("span");
      mDog.className = "meta-pill";
      mDog.textContent = "Dog: " + dogText;

      const mTot = document.createElement("span");
      mTot.className = "meta-pill";
      mTot.textContent = "Total: " + totalText;

      const mBook = document.createElement("span");
      mBook.className = "meta-pill";
      mBook.textContent = game.book ? game.book : "book";

      meta.appendChild(mFav);
      meta.appendChild(mDog);
      meta.appendChild(mTot);
      meta.appendChild(mBook);

      left.appendChild(matchLine);
      left.appendChild(sport);
      left.appendChild(meta);

      const logoStack = document.createElement("div");
      logoStack.className = "logo-stack";

      const homeRow = document.createElement("div");
      homeRow.className = "team-logo-row";
      const homeAbbr = getTeamAbbr(game.home_team);
      const homeLogo = document.createElement("div");
      homeLogo.className = "logo-circle-team";
      homeLogo.textContent = homeAbbr;
      const homeLabel = document.createElement("span");
      homeLabel.className = "team-abbr";
      homeLabel.textContent = "HOME";
      homeRow.appendChild(homeLabel);
      homeRow.appendChild(homeLogo);

      const awayRow = document.createElement("div");
      awayRow.className = "team-logo-row";
      const awayAbbr = getTeamAbbr(game.away_team);
      const awayLogo = document.createElement("div");
      awayLogo.className = "logo-circle-team";
      awayLogo.textContent = awayAbbr;
      const awayLabel = document.createElement("span");
      awayLabel.className = "team-abbr";
      awayLabel.textContent = "AWAY";
      awayRow.appendChild(awayLabel);
      awayRow.appendChild(awayLogo);

      logoStack.appendChild(homeRow);
      logoStack.appendChild(awayRow);

      top.appendChild(left);
      top.appendChild(logoStack);
      card.appendChild(top);

      // Picks Table
      const table = document.createElement("table");
      table.className = "picks-table";
      const thead = document.createElement("thead");
      const trHead = document.createElement("tr");
      ["Straight Up", "ATS", "O/U"].forEach(h => {
        const th = document.createElement("th");
        th.textContent = h;
        trHead.appendChild(th);
      });
      thead.appendChild(trHead);
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      const tr = document.createElement("tr");

      const suCell = buildPickCell(game.picks_su, "su", filters);
      const atsCell = buildPickCell(game.picks_ats, "ats", filters);
      const ouCell = buildPickCell(game.picks_ou, "ou", filters);

      tr.appendChild(suCell);
      tr.appendChild(atsCell);
      tr.appendChild(ouCell);
      tbody.appendChild(tr);
      table.appendChild(tbody);

      card.appendChild(table);
      return card;
    }

    function passesFilters(game, filters) {
      if (filters.sportFilter !== "all" && game.sport_key !== filters.sportFilter) {
        return false;
      }

      function confTier(model) {
        if (!model || model.confidence == null) return null;
        return classifyConfidence(model.confidence);
      }

      // Combined tier check
      const tiers = [
        confTier(game.picks_su),
        confTier(game.picks_ats),
        confTier(game.picks_ou)
      ];

      if (filters.confFilter === "high" && !tiers.includes("high")) return false;
      if (filters.confFilter === "med" && !tiers.includes("med")) return false;
      if (filters.confFilter === "low" && !tiers.includes("low")) return false;
      if (filters.confFilter === "noplay") {
        const isNoPlay =
          (game.picks_su && game.picks_su.label === "No Play") ||
          (game.picks_ats && game.picks_ats.label === "No Play") ||
          (game.picks_ou && game.picks_ou.label === "No Play");
        if (!isNoPlay) return false;
      }

      if (filters.pickFilter === "su" && (!game.picks_su || !game.picks_su.label)) {
        return false;
      }
      if (filters.pickFilter === "ats" && (!game.picks_ats || !game.picks_ats.label)) {
        return false;
      }
      if (filters.pickFilter === "ou" && (!game.picks_ou || !game.picks_ou.label)) {
        return false;
      }

      return true;
    }

    // --- MAIN LOAD / RENDER ---
    async function loadAndRender() {
      const container = document.getElementById("gameContainer");
      container.innerHTML = "";

      let combined;
      try {
        const resp = await fetch("combined.json?_=" + Date.now());
        combined = await resp.json();
      } catch (e) {
        container.textContent = "Failed to load combined.json";
        console.error(e);
        return;
      }

      const ts = combined.timestamp;
      if (ts) {
        const last = document.getElementById("lastUpdated");
        last.textContent = "Last updated: " + ts;
      }

      const rawGames = Array.isArray(combined.data) ? combined.data : [];

      // Compute picks per game
      const games = rawGames.map(g => {
        const base = { ...g };

        // Default picks
        let picks_su, picks_ats, picks_ou;

        if (g.sport_key === "mma_mixed_martial_arts") {
          const ufc = computeUFC(g);
          picks_su = ufc.su;
          picks_ats = ufc.ats;
          picks_ou = ufc.ou;
        } else {
          picks_su = computeSU(g);
          picks_ats = computeATS(g);
          picks_ou = computeOU(g);
        }

        base.picks_su = picks_su;
        base.picks_ats = picks_ats;
        base.picks_ou = picks_ou;

        return base;
      });

      // Sorting: date → sport → time
      games.sort((a, b) => {
        const da = (a.commence_time || "").slice(0, 10);
        const db = (b.commence_time || "").slice(0, 10);
        if (da < db) return -1;
        if (da > db) return 1;

        const sa = sportOrder(a.sport_key);
        const sb = sportOrder(b.sport_key);
        if (sa !== sb) return sa - sb;

        const ta = a.commence_time || "";
        const tb = b.commence_time || "";
        if (ta < tb) return -1;
        if (ta > tb) return 1;
        return 0;
      });

      const sportFilterEl = document.getElementById("sportFilter");
      const confFilterEl = document.getElementById("confFilter");
      const pickFilterEl = document.getElementById("pickFilter");

      function currentFilters() {
        return {
          sportFilter: sportFilterEl.value || "all",
          confFilter: confFilterEl.value || "all",
          pickFilter: pickFilterEl.value || "all",
        };
      }

      function renderAll() {
        container.innerHTML = "";
        const filters = currentFilters();

        // Group by date then sport
        const byDate = {};
        for (const g of games) {
          if (!passesFilters(g, filters)) continue;
          const dateKey = (g.commence_time || "").slice(0, 10);
          if (!byDate[dateKey]) byDate[dateKey] = {};
          if (!byDate[dateKey][g.sport_key]) byDate[dateKey][g.sport_key] = [];
          byDate[dateKey][g.sport_key].push(g);
        }

        const dateKeys = Object.keys(byDate).sort();

        for (const dKey of dateKeys) {
          const block = document.createElement("section");
          block.className = "date-block";

          const header = document.createElement("div");
          header.className = "date-header";
          const lineL = document.createElement("div");
          lineL.className = "date-line";
          const label = document.createElement("div");
          label.className = "date-label";
          label.textContent = formatDateHeader(dKey);
          const lineR = document.createElement("div");
          lineR.className = "date-line";
          header.appendChild(lineL);
          header.appendChild(label);
          header.appendChild(lineR);
          block.appendChild(header);

          const sportKeys = Object.keys(byDate[dKey]).sort((a, b) => sportOrder(a) - sportOrder(b));

          for (const sKey of sportKeys) {
            const sportHdr = document.createElement("div");
            sportHdr.className = "sport-header";
            const dot = document.createElement("span");
            dot.className = "dot";
            const txt = document.createElement("span");
            txt.textContent = sportLabel(sKey);
            sportHdr.appendChild(dot);
            sportHdr.appendChild(txt);
            block.appendChild(sportHdr);

            const grid = document.createElement("div");
            grid.className = "games-grid";

            for (const g of byDate[dKey][sKey]) {
              const card = createGameCard(g, filters);
              grid.appendChild(card);
            }

            block.appendChild(grid);
          }

          container.appendChild(block);
        }

        if (!dateKeys.length) {
          const msg = document.createElement("div");
          msg.style.marginTop = "20px";
          msg.style.fontSize = "13px";
          msg.style.color = "var(--text-muted)";
          msg.textContent = "No games match the current filters.";
          container.appendChild(msg);
        }
      }

      sportFilterEl.addEventListener("change", renderAll);
      confFilterEl.addEventListener("change", renderAll);
      pickFilterEl.addEventListener("change", renderAll);

      renderAll();
    }

    loadAndRender();

    // Auto reload every 30 minutes
    setInterval(() => {
      location.reload();
    }, 30 * 60 * 1000);
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <title>Forged By Freedom — Live Odds & Picks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --bg: #0a0b0d;
      --bg-elevated: #151820;
      --bg-elevated-soft: #191d26;
      --bg-muted: #10131a;
      --border-subtle: #272b38;
      --text-main: #f5f5f5;
      --text-muted: #9ca3af;
      --accent: #f97316;
      --accent-soft: rgba(249,115,22,0.1);
      --accent-strong: #fb923c;

      --conf-low: #ef4444;    /* red */
      --conf-med: #eab308;    /* tactical yellow/gold */
      --conf-high: #22c55e;   /* green */

      --card-shadow: 0 12px 30px rgba(0,0,0,0.4);
      --glow-high: 0 0 18px rgba(34,197,94,0.45);
    }

    [data-theme="light"] {
      --bg: #f3f4f6;
      --bg-elevated: #ffffff;
      --bg-elevated-soft: #f9fafb;
      --bg-muted: #e5e7eb;
      --border-subtle: #d1d5db;
      --text-main: #111827;
      --text-muted: #6b7280;
      --accent: #ea580c;
      --accent-soft: rgba(234,88,12,0.08);
      --accent-strong: #f97316;

      --conf-low: #dc2626;
      --conf-med: #d97706;
      --conf-high: #15803d;

      --card-shadow: 0 8px 22px rgba(15,23,42,0.20);
      --glow-high: 0 0 14px rgba(34,197,94,0.35);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, var(--bg) 45%, #020617 100%);
      color: var(--text-main);
      min-height: 100vh;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    /* Header */

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 18px;
      border-bottom: 1px solid var(--border-subtle);
      background: linear-gradient(90deg, #020617 0, #111827 40%, #020617 100%);
      position: sticky;
      top: 0;
      z-index: 20;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand-logo {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      overflow: hidden;
      background: radial-gradient(circle at 30% 20%, #f97316 0, #7f1d1d 45%, #020617 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 20px;
      letter-spacing: 1px;
      color: #fef3c7;
      border: 1px solid rgba(248,250,252,0.09);
      box-shadow: 0 0 18px rgba(248,250,252,0.15);
    }

    .brand-text-main {
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .brand-text-sub {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
    }

    .brand-text-slogan {
      font-size: 11px;
      color: #e5e7eb;
    }

    .brand-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-link {
      font-size: 11px;
      color: #93c5fd;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .legend {
      display: flex;
      gap: 6px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .legend span {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .badge-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      box-shadow: 0 0 6px rgba(15,23,42,0.6);
    }

    .dot-low { background: var(--conf-low); }
    .dot-med { background: var(--conf-med); }
    .dot-high { background: var(--conf-high); }

    .theme-toggle {
      padding: 5px 10px;
      font-size: 11px;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      background: #020617;
      color: var(--text-main);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    /* Main layout */

    main {
      max-width: 1160px;
      margin: 0 auto;
      padding: 14px 12px 40px;
    }

    .controls-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 12px;
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .filter-select {
      background: var(--bg-elevated-soft);
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      padding: 6px 10px;
      font-size: 11px;
      color: var(--text-main);
      outline: none;
    }

    .filters label {
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .timestamp {
      font-size: 11px;
      color: var(--text-muted);
    }

    /* Group headings */

    .date-block {
      margin-top: 16px;
    }

    .date-header {
      font-size: 13px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin: 12px 2px 6px;
      border-bottom: 1px solid rgba(148,163,184,0.3);
      padding-bottom: 2px;
    }

    .sport-header {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #cbd5f5;
      margin: 12px 0 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .sport-pill {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 999px;
      background: var(--accent-soft);
      color: var(--accent-strong);
      border: 1px solid rgba(148,163,184,0.3);
    }

    /* Card grid */

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 10px;
    }

    .game-card {
      position: relative;
      background: linear-gradient(145deg, var(--bg-elevated) 0, var(--bg-elevated-soft) 100%);
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,0.7);
      padding: 10px 11px;
      box-shadow: var(--card-shadow);
      display: flex;
      flex-direction: column;
      gap: 7px;
      transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, border-color 0.12s ease-out, background 0.12s;
    }

    .game-card:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 36px rgba(0,0,0,0.5);
      border-color: rgba(249,115,22,0.45);
    }

    .card-high-confidence {
      box-shadow: var(--card-shadow), var(--glow-high);
      border-color: rgba(34,197,94,0.55);
    }

    .card-muted {
      opacity: 0.65;
      background: var(--bg-muted);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .league-tag {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--text-muted);
    }

    .time-tag {
      font-size: 11px;
      color: #d1fae5;
    }

    .matchup-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo-wrapper {
      flex-shrink: 0;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, #f97316 0, #020617 55%, #020617 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      border: 1px solid rgba(148,163,184,0.4);
    }

    .logo-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .teams-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .matchup-line {
      font-size: 13px;
      font-weight: 600;
    }

    .spread-line {
      font-size: 11px;
      color: var(--text-muted);
    }

    .pick-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 6px;
      margin-top: 4px;
    }

    .pick-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      margin-bottom: 2px;
    }

    .pick-pill {
      font-size: 11px;
      padding: 4px 6px;
      border-radius: 8px;
      border: 1px solid var(--border-subtle);
      background: rgba(15,23,42,0.9);
      display: flex;
      flex-direction: column;
      gap: 1px;
      min-height: 38px;
    }

    .pick-main {
      font-weight: 600;
      font-size: 11px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .pick-sub {
      font-size: 10px;
      color: var(--text-muted);
    }

    .conf-badge {
      align-self: flex-start;
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 999px;
      margin-top: 2px;
      border: 1px solid transparent;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .conf-low {
      background: rgba(248,113,113,0.1);
      border-color: rgba(248,113,113,0.35);
      color: var(--conf-low);
    }

    .conf-med {
      background: rgba(234,179,8,0.10);
      border-color: rgba(234,179,8,0.45);
      color: var(--conf-med);
    }

    .conf-high {
      background: rgba(34,197,94,0.12);
      border-color: rgba(34,197,94,0.55);
      color: var(--conf-high);
      box-shadow: 0 0 10px rgba(34,197,94,0.35);
    }

    .conf-badge span {
      font-size: 9px;
    }

    .pill-muted {
      opacity: 0.5;
    }

    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }

      .header-right {
        width: 100%;
        justify-content: space-between;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="brand-logo">FBF</div>
      <div class="brand-block">
        <div class="brand-text-main">Forged By Freedom Strength &amp; Nutrition</div>
        <div class="brand-text-sub">STRENGTH · DISCIPLINE · FREEDOM</div>
        <div class="brand-text-slogan">For all your training, supplementation &amp; nutrition needs</div>
        <a class="brand-link" href="https://forgedbyfreedom.org" target="_blank" rel="noopener">
          ForgedByFreedom.org
        </a>
      </div>
    </div>
    <div class="header-right">
      <div class="legend">
        <span><span class="badge-dot dot-low"></span>Low</span>
        <span><span class="badge-dot dot-med"></span>Medium</span>
        <span><span class="badge-dot dot-high"></span>High</span>
      </div>
      <button id="themeToggle" class="theme-toggle" type="button">
        🥷 Black Ops Dark
      </button>
    </div>
  </header>

  <main>
    <div class="controls-row">
      <div class="filters">
        <label>
          Sport:
          <select id="sportFilter" class="filter-select">
            <option value="all">All Sports</option>
            <option value="football">Football (NFL + NCAAF)</option>
            <option value="mma_mixed_martial_arts">UFC / MMA</option>
            <option value="basketball">Basketball (NBA + NCAAB)</option>
            <option value="icehockey_nhl">Hockey (NHL)</option>
          </select>
        </label>
        <label>
          Confidence:
          <select id="confidenceFilter" class="filter-select">
            <option value="all">All Levels</option>
            <option value="high">High (70%+)</option>
            <option value="medium">Medium (56–69%)</option>
            <option value="low">Low (0–55%)</option>
          </select>
        </label>
      </div>
      <div class="timestamp" id="timestampLabel">
        Loading latest odds...
      </div>
    </div>

    <div id="scoreboard"></div>
  </main>

  <script>
    const SPORT_ORDER = {
      'americanfootball_nfl': 1,
      'americanfootball_ncaaf': 2,
      'mma_mixed_martial_arts': 3,
      'basketball_nba': 4,
      'basketball_ncaab': 5,
      'icehockey_nhl': 6,
    };

    const SPORT_LABELS = {
      'americanfootball_nfl': 'NFL',
      'americanfootball_ncaaf': 'College Football',
      'mma_mixed_martial_arts': 'UFC / MMA',
      'basketball_nba': 'NBA',
      'basketball_ncaab': 'NCAA Basketball',
      'icehockey_nhl': 'NHL',
    };

    function sanitizeName(name) {
      return (name || '')
        .toLowerCase()
        .replace(/[^a-z0-9]+/g, '_')
        .replace(/^_+|_+$/g, '');
    }

    function getLogoPath(entityName, sportKey) {
      if (!entityName) return null;
      const fileName = sanitizeName(entityName) + '.png';
      if (sportKey === 'mma_mixed_martial_arts') {
        return 'logos/fighters/' + fileName;
      }
      return 'logos/teams/' + fileName;
    }

    function parseIsoDate(iso) {
      if (!iso) return null;
      const d = new Date(iso);
      if (Number.isNaN(d.getTime())) return null;
      return d;
    }

    function formatKickoff(d) {
      if (!d) return '';
      return d.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });
    }

    function formatDateKey(d) {
      return d.toISOString().slice(0, 10); // YYYY-MM-DD
    }

    function formatDateLabel(d) {
      return d.toLocaleDateString(undefined, {
        weekday: 'short',
        month: 'short',
        day: 'numeric',
      });
    }

    function classifyConfidence(pct) {
      if (pct == null) return null;
      if (pct >= 70) return 'high';
      if (pct >= 56) return 'medium';
      return 'low';
    }

    /* ---- Confidence + pick model ---- */

    function computeGameModel(game) {
      const sport = game.sport_key;
      if (sport === 'mma_mixed_martial_arts') {
        return computeUfcModel(game);
      }
      return computeStandardModel(game);
    }

    function computeStandardModel(game) {
      const favTeam = game.fav_team || null;
      const dogTeam = game.dog_team || null;
      const favSpread = typeof game.fav_spread === 'number' ? game.fav_spread : null;
      const dogSpread = typeof game.dog_spread === 'number' ? game.dog_spread : null;
      const total = typeof game.total === 'number' ? game.total : null;

      const favPrice = typeof game.fav_price === 'number' ? game.fav_price : null;
      const dogPrice = typeof game.dog_price === 'number' ? game.dog_price : null;

      function implied(p) {
        if (p == null) return null;
        if (p < 0) return (-p) / ((-p) + 100);
        return 100 / (p + 100);
      }

      const favImp = implied(favPrice);
      const dogImp = implied(dogPrice);
      let baseWinProb = null;
      if (favImp != null && dogImp != null) {
        baseWinProb = Math.max(favImp, dogImp);
      }

      let suSide = null;
      let suTeam = null;

      if (favTeam && dogTeam) {
        if (baseWinProb != null && baseWinProb < 0.53) {
          suSide = 'dog';
          suTeam = dogTeam;
        } else {
          suSide = 'fav';
          suTeam = favTeam;
        }
      }

      let suConf = null;
      if (baseWinProb != null) {
        let adj = (baseWinProb - 0.5) * 85;
        if (favSpread != null) {
          const absLine = Math.abs(favSpread);
          adj += Math.min(absLine, 7) * 0.8;
        }
        suConf = 50 + adj;
        suConf = Math.max(51, Math.min(suConf, 78));
      }

      let atsTeam = null;
      let atsSide = null;
      let atsConf = null;
      if (favTeam && dogTeam && favSpread != null && dogSpread != null) {
        const absLine = Math.abs(favSpread);
        if (absLine <= 3) {
          atsTeam = favTeam;
          atsSide = 'fav';
        } else if (absLine >= 7) {
          atsTeam = dogTeam;
          atsSide = 'dog';
        } else {
          if (baseWinProb && baseWinProb > 0.60) {
            atsTeam = favTeam;
            atsSide = 'fav';
          } else {
            atsTeam = dogTeam;
            atsSide = 'dog';
          }
        }
        const spreadFactor = Math.max(0, 7 - Math.abs(favSpread));
        let base = 52 + spreadFactor * 1.2;
        if (baseWinProb != null) {
          base += (baseWinProb - 0.5) * 40;
        }
        atsConf = Math.max(52, Math.min(base, 74));
      }

      let ouSide = null;
      let ouConf = null;
      if (total != null) {
        const sportKey = game.sport_key;
        const isFootball = sportKey === 'americanfootball_nfl' || sportKey === 'americanfootball_ncaaf';
        const isBasketball = sportKey === 'basketball_nba' || sportKey === 'basketball_ncaab';
        const isHockey = sportKey === 'icehockey_nhl';

        if (isFootball) {
          if (total <= 41) {
            ouSide = 'over';
          } else if (total >= 48) {
            ouSide = 'under';
          } else {
            ouSide = (favSpread != null && favSpread < -4) ? 'over' : 'under';
          }
        } else if (isBasketball) {
          if (total <= 220) ouSide = 'over';
          else if (total >= 235) ouSide = 'under';
          else ouSide = baseWinProb && baseWinProb > 0.6 ? 'over' : 'under';
        } else if (isHockey) {
          if (total <= 5.5) ouSide = 'over';
          else if (total >= 6.5) ouSide = 'under';
          else ouSide = 'under';
        }

        if (ouSide) {
          let base = 53;
          if (favSpread != null) {
            base += Math.min(Math.abs(favSpread), 8) * 0.8;
          }
          ouConf = Math.max(52, Math.min(base, 72));
        }
      }

      return {
        type: 'standard',
        su: {
          team: suTeam,
          side: suSide,
          confidence: suConf,
        },
        ats: {
          team: atsTeam,
          side: atsSide,
          confidence: atsConf,
        },
        ou: {
          side: ouSide,
          confidence: ouConf,
        },
      };
    }

    function computeUfcModel(game) {
      const favTeam = game.fav_team || null;
      const dogTeam = game.dog_team || null;
      const total = typeof game.total === 'number' ? game.total : null;

      const favPrice = typeof game.fav_price === 'number' ? game.fav_price : null;
      const dogPrice = typeof game.dog_price === 'number' ? game.dog_price : null;

      function implied(p) {
        if (p == null) return null;
        if (p < 0) return (-p) / ((-p) + 100);
        return 100 / (p + 100);
      }

      const favImp = implied(favPrice);
      const dogImp = implied(dogPrice);

      let suSide = null;
      let suFighter = null;
      let baseWinProb = null;

      if (favImp != null && dogImp != null && favTeam && dogTeam) {
        if (favImp >= dogImp) {
          baseWinProb = favImp;
          suSide = 'fav';
          suFighter = favTeam;
        } else {
          baseWinProb = dogImp;
          suSide = 'dog';
          suFighter = dogTeam;
        }
      } else if (favTeam) {
        suSide = 'fav';
        suFighter = favTeam;
        baseWinProb = 0.58;
      }

      let suConf = null;
      if (baseWinProb != null) {
        let adj = (baseWinProb - 0.5) * 95;
        if (favPrice != null) {
          const absLine = Math.abs(favPrice);
          adj += Math.min(absLine / 100, 4) * 1.2;
        }
        suConf = 52 + adj;
        suConf = Math.max(53, Math.min(suConf, 79));
      }

      let method = null;
      let methodConf = null;
      if (baseWinProb != null) {
        if (total != null && total <= 1.5) {
          method = 'KO/TKO';
          methodConf = 66;
        } else if (total != null && total <= 2.5) {
          if (baseWinProb > 0.65) {
            method = 'KO/TKO';
            methodConf = 64;
          } else {
            method = 'KO/TKO or SUB';
            methodConf = 60;
          }
        } else if (total != null && total >= 3.5) {
          method = 'Decision';
          methodConf = 61;
        } else {
          method = baseWinProb >= 0.6 ? 'KO/TKO' : 'Decision';
          methodConf = 58;
        }
      }

      let ouSide = null;
      let ouLabel = null;
      let ouConf = null;

      if (total != null) {
        if (total <= 1.5) {
          ouSide = 'under';
        } else if (total <= 2.5) {
          ouSide = baseWinProb && baseWinProb > 0.65 ? 'under' : 'over';
        } else if (total >= 3.5) {
          ouSide = 'over';
        } else {
          ouSide = 'over';
        }

        if (ouSide) {
          ouLabel = `${ouSide === 'over' ? 'Over' : 'Under'} ${total}`;
          let base = 55;
          if (baseWinProb != null) {
            base += (baseWinProb - 0.5) * 45;
          }
          if (total <= 1.5 || total >= 4.5) {
            base += 4;
          }
          ouConf = Math.max(54, Math.min(base, 76));
        }
      }

      return {
        type: 'ufc',
        su: {
          fighter: suFighter,
          side: suSide,
          confidence: suConf,
        },
        method: {
          label: method,
          confidence: methodConf,
        },
        ou: {
          label: ouLabel,
          side: ouSide,
          confidence: ouConf,
        },
      };
    }

    function passFilters(model, game, filters) {
      // sport filter
      if (filters.sport !== 'all') {
        if (filters.sport === 'football') {
          if (game.sport_key !== 'americanfootball_nfl' &&
              game.sport_key !== 'americanfootball_ncaaf') {
            return false;
          }
        } else if (filters.sport === 'basketball') {
          if (game.sport_key !== 'basketball_nba' &&
              game.sport_key !== 'basketball_ncaab') {
            return false;
          }
        } else {
          if (game.sport_key !== filters.sport) return false;
        }
      }

      // confidence filter: use strongest confidence in card
      let bestConf = null;
      function consider(val) {
        if (val == null) return;
        if (bestConf == null || val > bestConf) bestConf = val;
      }

      if (model.type === 'standard') {
        consider(model.su.confidence);
        consider(model.ats.confidence);
        consider(model.ou.confidence);
      } else if (model.type === 'ufc') {
        consider(model.su.confidence);
        consider(model.method.confidence);
        consider(model.ou.confidence);
      }

      if (filters.confidence !== 'all') {
        const bucket = bestConf != null ? classifyConfidence(bestConf) : null;
        if (filters.confidence === 'high' && bucket !== 'high') return false;
        if (filters.confidence === 'medium' && bucket !== 'medium') return false;
        if (filters.confidence === 'low' && bucket !== 'low') return false;
      }

      return true;
    }

    function createConfBadge(conf) {
      const span = document.createElement('div');
      span.className = 'conf-badge';
      if (conf == null) {
        span.classList.add('pill-muted');
        span.textContent = '--%';
        return span;
      }
      const pct = Math.round(conf);
      const bucket = classifyConfidence(pct);
      if (bucket === 'high') span.classList.add('conf-high');
      else if (bucket === 'medium') span.classList.add('conf-med');
      else span.classList.add('conf-low');
      span.innerHTML = `<span>${pct}%</span>`;
      return span;
    }

    function render() {
      const sb = document.getElementById('scoreboard');
      sb.innerHTML = '';

      if (!window.__games || window.__games.length === 0) {
        sb.textContent = 'No games available.';
        return;
      }

      const sportFilter = document.getElementById('sportFilter').value;
      const confidenceFilter = document.getElementById('confidenceFilter').value;

      const filters = {
        sport: sportFilter,
        confidence: confidenceFilter,
      };

      const enriched = window.__games
        .map(game => {
          const model = computeGameModel(game);
          return { game, model };
        })
        .filter(({ model, game }) => passFilters(model, game, filters));

      if (enriched.length === 0) {
        sb.textContent = 'No games match the current filters.';
        return;
      }

      const grouped = {};

      for (const { game, model } of enriched) {
        const dt = parseIsoDate(game.commence_time);
        const dateKey = dt ? formatDateKey(dt) : 'unknown';
        if (!grouped[dateKey]) grouped[dateKey] = {};
        const sport = game.sport_key || 'other';
        if (!grouped[dateKey][sport]) grouped[dateKey][sport] = [];
        grouped[dateKey][sport].push({ game, model });
      }

      const sortedDateKeys = Object.keys(grouped).sort((a, b) => a.localeCompare(b));

      for (const dateKey of sortedDateKeys) {
        const dateGames = grouped[dateKey];
        const dateDiv = document.createElement('div');
        dateDiv.className = 'date-block';

        const dateHeader = document.createElement('div');
        const dateObj = parseIsoDate(dateKey + 'T00:00:00Z') || new Date(dateKey);
        dateHeader.className = 'date-header';
        dateHeader.textContent = formatDateLabel(dateObj);
        dateDiv.appendChild(dateHeader);

        const sportKeys = Object.keys(dateGames).sort((a, b) => {
          const sa = SPORT_ORDER[a] ?? 999;
          const sb = SPORT_ORDER[b] ?? 999;
          if (sa !== sb) return sa - sb;
          return (SPORT_LABELS[a] || a).localeCompare(SPORT_LABELS[b] || b);
        });

        for (const sk of sportKeys) {
          const sportLabel = SPORT_LABELS[sk] || sk;
          const sportHeader = document.createElement('div');
          sportHeader.className = 'sport-header';
          sportHeader.innerHTML = `<span class="sport-pill">${sportLabel}</span>`;
          dateDiv.appendChild(sportHeader);

          const grid = document.createElement('div');
          grid.className = 'card-grid';

          const list = dateGames[sk].slice().sort((a, b) => {
            const da = parseIsoDate(a.game.commence_time);
            const db = parseIsoDate(b.game.commence_time);
            const ta = da ? da.getTime() : 0;
            const tb = db ? db.getTime() : 0;
            return ta - tb;
          });

          for (const { game, model } of list) {
            grid.appendChild(renderCard(game, model));
          }

          dateDiv.appendChild(grid);
        }

        sb.appendChild(dateDiv);
      }
    }

    function renderCard(game, model) {
      const card = document.createElement('div');
      card.className = 'game-card';

      let bestConf = null;
      function consider(v) {
        if (v == null) return;
        if (bestConf == null || v > bestConf) bestConf = v;
      }

      if (model.type === 'standard') {
        consider(model.su.confidence);
        consider(model.ats.confidence);
        consider(model.ou.confidence);
      } else {
        consider(model.su.confidence);
        consider(model.method.confidence);
        consider(model.ou.confidence);
      }

      if (bestConf != null) {
        const bucket = classifyConfidence(bestConf);
        if (bucket === 'high') card.classList.add('card-high-confidence');
      } else {
        card.classList.add('card-muted');
      }

      const header = document.createElement('div');
      header.className = 'card-header';

      const left = document.createElement('div');
      left.className = 'league-tag';
      left.textContent = SPORT_LABELS[game.sport_key] || game.sport_key || '';
      header.appendChild(left);

      const dt = parseIsoDate(game.commence_time);
      const right = document.createElement('div');
      right.className = 'time-tag';
      right.textContent = formatKickoff(dt);
      header.appendChild(right);

      card.appendChild(header);

      const matchupRow = document.createElement('div');
      matchupRow.className = 'matchup-row';

      let logoName = game.home_team;
      if (game.sport_key === 'mma_mixed_martial_arts') {
        const parts = (game.matchup || '').split('@');
        logoName = parts[1] || parts[0] || game.home_team;
      }

      const logoWrapper = document.createElement('div');
      logoWrapper.className = 'logo-wrapper';
      const logoPath = getLogoPath(logoName, game.sport_key);
      if (logoPath) {
        const img = document.createElement('img');
        img.src = logoPath;
        img.alt = logoName || 'logo';
        img.onerror = function () {
          this.style.display = 'none';
        };
        logoWrapper.appendChild(img);
      } else {
        logoWrapper.textContent = '';
      }

      const teamsText = document.createElement('div');
      teamsText.className = 'teams-text';

      const matchupLine = document.createElement('div');
      matchupLine.className = 'matchup-line';
      matchupLine.textContent = game.matchup || `${game.away_team}@${game.home_team}`;
      teamsText.appendChild(matchupLine);

      const spreadLine = document.createElement('div');
      spreadLine.className = 'spread-line';

      if (game.sport_key === 'mma_mixed_martial_arts') {
        const favStr = game.favorite || '';
        const dogStr = game.underdog || '';
        const pieces = [];
        if (favStr) pieces.push('Fav: ' + favStr);
        if (dogStr) pieces.push('Dog: ' + dogStr);
        if (typeof game.total === 'number') {
          pieces.push('Rounds O/U: ' + game.total);
        }
        spreadLine.textContent = pieces.join(' · ');
      } else {
        const favStr = game.favorite || '';
        const dogStr = game.underdog || '';
        const parts = [];
        if (favStr) parts.push('Fav: ' + favStr);
        if (dogStr) parts.push('Dog: ' + dogStr);
        if (typeof game.total === 'number') {
          parts.push('Total: ' + game.total);
        }
        spreadLine.textContent = parts.join(' · ');
      }

      teamsText.appendChild(spreadLine);

      matchupRow.appendChild(logoWrapper);
      matchupRow.appendChild(teamsText);
      card.appendChild(matchupRow);

      const pickGrid = document.createElement('div');
      pickGrid.className = 'pick-grid';

      if (model.type === 'standard') {
        const suCol = document.createElement('div');
        const atsCol = document.createElement('div');
        const ouCol = document.createElement('div');

        suCol.innerHTML = '<div class="pick-label">Straight Up</div>';
        atsCol.innerHTML = '<div class="pick-label">ATS</div>';
        ouCol.innerHTML = '<div class="pick-label">O/U</div>';

        const suPill = document.createElement('div');
        suPill.className = 'pick-pill';
        const suMain = document.createElement('div');
        suMain.className = 'pick-main';
        const suSub = document.createElement('div');
        suSub.className = 'pick-sub';

        if (model.su.team) {
          suMain.textContent = model.su.team;
          suSub.textContent = model.su.side === 'dog' ? 'Taking the dog' : 'Backing the favorite';
        } else {
          suMain.textContent = '--';
          suSub.textContent = '';
          suPill.classList.add('pill-muted');
        }
        suPill.appendChild(suMain);
        suPill.appendChild(suSub);
        suPill.appendChild(createConfBadge(model.su.confidence));
        suCol.appendChild(suPill);

        const atsPill = document.createElement('div');
        atsPill.className = 'pick-pill';
        const atsMain = document.createElement('div');
        atsMain.className = 'pick-main';
        const atsSub = document.createElement('div');
        atsSub.className = 'pick-sub';

        if (model.ats.team && typeof game.spread === 'number') {
          const line = model.ats.side === 'fav' ? game.fav_spread : game.dog_spread;
          const labelTeam = model.ats.team;
          if (typeof line === 'number') {
            const signed = line > 0 ? '+' + line : line;
            atsMain.textContent = labelTeam + ' ' + signed;
          } else {
            atsMain.textContent = labelTeam;
          }
          atsSub.textContent = model.ats.side === 'dog' ? 'Catching points' : 'Laying points';
        } else if (model.ats.team) {
          atsMain.textContent = model.ats.team;
          atsSub.textContent = model.ats.side === 'dog' ? 'Catching points' : 'Laying points';
        } else {
          atsMain.textContent = '--';
          atsSub.textContent = '';
          atsPill.classList.add('pill-muted');
        }
        atsPill.appendChild(atsMain);
        atsPill.appendChild(atsSub);
        atsPill.appendChild(createConfBadge(model.ats.confidence));
        atsCol.appendChild(atsPill);

        const ouPill = document.createElement('div');
        ouPill.className = 'pick-pill';
        const ouMain = document.createElement('div');
        ouMain.className = 'pick-main';
        const ouSub = document.createElement('div');
        ouSub.className = 'pick-sub';

        if (model.ou.side && typeof game.total === 'number') {
          const dir = model.ou.side === 'over' ? 'Over' : 'Under';
          ouMain.textContent = `${dir} ${game.total}`;
          ouSub.textContent = 'Game total';
        } else {
          ouMain.textContent = '--';
          ouSub.textContent = '';
          ouPill.classList.add('pill-muted');
        }
        ouPill.appendChild(ouMain);
        ouPill.appendChild(ouSub);
        ouPill.appendChild(createConfBadge(model.ou.confidence));
        ouCol.appendChild(ouPill);

        pickGrid.appendChild(suCol);
        pickGrid.appendChild(atsCol);
        pickGrid.appendChild(ouCol);
      } else {
        const sideCol = document.createElement('div');
        const methodCol = document.createElement('div');
        const roundsCol = document.createElement('div');

        sideCol.innerHTML = '<div class="pick-label">Side</div>';
        methodCol.innerHTML = '<div class="pick-label">Method</div>';
        roundsCol.innerHTML = '<div class="pick-label">Rounds O/U</div>';

        const sidePill = document.createElement('div');
        sidePill.className = 'pick-pill';
        const sideMain = document.createElement('div');
        sideMain.className = 'pick-main';
        const sideSub = document.createElement('div');
        sideSub.className = 'pick-sub';

        if (model.su.fighter) {
          sideMain.textContent = model.su.fighter;
          sideSub.textContent = model.su.side === 'dog' ? 'Live underdog' : 'Chalk side';
        } else {
          sideMain.textContent = '--';
          sideSub.textContent = '';
          sidePill.classList.add('pill-muted');
        }
        sidePill.appendChild(sideMain);
        sidePill.appendChild(sideSub);
        sidePill.appendChild(createConfBadge(model.su.confidence));
        sideCol.appendChild(sidePill);

        const methodPill = document.createElement('div');
        methodPill.className = 'pick-pill';
        const methodMain = document.createElement('div');
        methodMain.className = 'pick-main';
        const methodSub = document.createElement('div');
        methodSub.className = 'pick-sub';

        if (model.method.label) {
          methodMain.textContent = model.method.label;
          methodSub.textContent = 'Method of victory lean';
        } else {
          methodMain.textContent = '--';
          methodSub.textContent = '';
          methodPill.classList.add('pill-muted');
        }
        methodPill.appendChild(methodMain);
        methodPill.appendChild(methodSub);
        methodPill.appendChild(createConfBadge(model.method.confidence));
        methodCol.appendChild(methodPill);

        const roundsPill = document.createElement('div');
        roundsPill.className = 'pick-pill';
        const roundsMain = document.createElement('div');
        roundsMain.className = 'pick-main';
        const roundsSub = document.createElement('div');
        roundsSub.className = 'pick-sub';

        if (model.ou.label) {
          roundsMain.textContent = model.ou.label;
          roundsSub.textContent = 'Total rounds';
        } else {
          roundsMain.textContent = '--';
          roundsSub.textContent = '';
          roundsPill.classList.add('pill-muted');
        }
        roundsPill.appendChild(roundsMain);
        roundsPill.appendChild(roundsSub);
        roundsPill.appendChild(createConfBadge(model.ou.confidence));
        roundsCol.appendChild(roundsPill);

        pickGrid.appendChild(sideCol);
        pickGrid.appendChild(methodCol);
        pickGrid.appendChild(roundsCol);
      }

      card.appendChild(pickGrid);

      return card;
    }

    function initThemeToggle() {
      const root = document.documentElement;
      const btn = document.getElementById('themeToggle');

      function apply(mode) {
        root.setAttribute('data-theme', mode);
        if (mode === 'dark') {
          btn.textContent = '🥷 Black Ops Dark';
        } else {
          btn.textContent = '🌤️ Tactical Light';
        }
      }

      const stored = localStorage.getItem('fbf-theme');
      if (stored === 'light' || stored === 'dark') {
        apply(stored);
      } else {
        apply('dark');
      }

      btn.addEventListener('click', () => {
        const current = root.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
        const next = current === 'dark' ? 'light' : 'dark';
        apply(next);
        localStorage.setItem('fbf-theme', next);
      });
    }

    async function loadData() {
      try {
        const resp = await fetch('combined.json', { cache: 'no-store' });
        if (!resp.ok) throw new Error('HTTP ' + resp.status);
        const data = await resp.json();
        window.__games = Array.isArray(data.data) ? data.data : [];
        const tsLabel = document.getElementById('timestampLabel');
        tsLabel.textContent = `Last updated: ${data.timestamp || 'unknown'}`;
        render();
      } catch (e) {
        document.getElementById('timestampLabel').textContent = 'Failed to load odds.';
        console.error(e);
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      initThemeToggle();
      document.getElementById('sportFilter').addEventListener('change', render);
      document.getElementById('confidenceFilter').addEventListener('change', render);
      loadData();

      // Auto-reload every 30 minutes
      setInterval(() => {
        location.reload();
      }, 30 * 60 * 1000);
    });
  </script>
</body>
</html>
<script>
async function loadPredictions() {
    const res = await fetch("predictions.json?ts=" + Date.now());
    const data = await res.json();
    return data.data || [];
}

// Logo helper
function getLogo(team) {
    const safe = team.toLowerCase().replace(/[^a-z0-9]/g, "_");
    return `logos/${safe}.png`;
}

// Confidence → color
function confColor(c) {
    if (!c) return "gray";
    if (c < 56) return "red";
    if (c < 70) return "gold";
    return "lime";
}

// Build card HTML
function gameCard(g) {
    const suC = g.su_conf || "--";
    const atsC = g.ats_conf || "--";
    const ouC = g.ou_conf || "--";

    const suColor = confColor(g.su_conf);
    const atsColor = confColor(g.ats_conf);
    const ouColor = confColor(g.ou_conf);

    const glow = (g.su_conf > 70 || g.ats_conf > 70 || g.ou_conf > 70)
        ? "box-shadow:0 0 10px rgba(0,255,0,0.5);" : "";

    return `
    <div class="game-card" style="${glow}">
        <div class="card-header">
            <img src="${getLogo(g.away_team)}" class="team-logo">
            <span>${g.matchup}</span>
            <img src="${getLogo(g.home_team)}" class="team-logo">
        </div>
        <div class="card-body">
            <table class="pick-table">
                <tr>
                    <th>Straight Up</th>
                    <td style="color:${suColor}">${g.su_pick || "--"} (${suC}%)</td>
                </tr>
                <tr>
                    <th>ATS</th>
                    <td style="color:${atsColor}">${g.ats_pick || "--"} (${atsC}%)</td>
                </tr>
                <tr>
                    <th>O/U</th>
                    <td style="color:${ouColor}">${g.ou_pick || "--"} (${ouC}%)</td>
                </tr>
            </table>
            <div class="meta">${g.book} – ${new Date(g.commence_time).toLocaleString()}</div>
        </div>
    </div>`;
}

// RENDER EVERYTHING
async function render() {
    const container = document.getElementById("games");
    container.innerHTML = "Loading…";

    const games = await loadPredictions();

    // Sort: DATE → SPORT → TIME
    games.sort((a, b) =>
        a.commence_time.localeCompare(b.commence_time) ||
        a.sport_key.localeCompare(b.sport_key) ||
        a.matchup.localeCompare(b.matchup)
    );

    let html = "";
    let lastDate = "";
    let lastSport = "";

    for (const g of games) {
        const d = g.commence_time.split("T")[0];
        if (d !== lastDate) {
            html += `<h2 class="date-header">${d}</h2>`;
            lastDate = d;
            lastSport = "";
        }

        if (g.sport_key !== lastSport) {
            html += `<h3 class="sport-header">${g.sport_key.toUpperCase()}</h3>`;
            lastSport = g.sport_key;
        }

        html += gameCard(g);
    }

    container.innerHTML = html;
}

// Auto reload every 30 minutes
setInterval(render, 30 * 60 * 1000);

// Initial load
render();
</script>
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<title>Forged By Freedom — Live Odds & Picks</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root {
  --bg: #050608;
  --bg-elevated: #0b0f19;
  --bg-card: #111827;
  --bg-card-soft: #020617;
  --text: #e5e7eb;
  --text-soft: #9ca3af;
  --accent: #f97316;
  --accent-soft: #fed7aa;
  --border-subtle: #1f2933;
  --pill-bg: #111827;
  --pill-border: #4b5563;
  --pill-active-bg: #f97316;
  --pill-active-text: #0b0f19;
  --conf-low-bg: #7f1d1d;
  --conf-low-text: #fecaca;
  --conf-med-bg: #854d0e;
  --conf-med-text: #fef3c7;
  --conf-high-bg: #14532d;
  --conf-high-text: #bbf7d0;
  --conf-none-bg: #111827;
  --conf-none-text: #6b7280;
  --card-shadow: 0 14px 40px rgba(0,0,0,0.65);
  --card-radius: 18px;
  --badge-radius: 999px;
  --logo-bg: #020617;
  --logo-border: #1f2937;
  --sport-nfl: #38bdf8;
  --sport-ncaaf: #22c55e;
  --sport-nba: #f97316;
  --sport-ncaab: #a855f7;
  --sport-nhl: #e5e7eb;
  --sport-ufc: #ef4444;
}
html[data-theme="light"] {
  --bg: #f3f4f6;
  --bg-elevated: #e5e7eb;
  --bg-card: #ffffff;
  --bg-card-soft: #f9fafb;
  --text: #020617;
  --text-soft: #4b5563;
  --accent: #ea580c;
  --accent-soft: #fed7aa;
  --border-subtle: #d1d5db;
  --pill-bg: #e5e7eb;
  --pill-border: #9ca3af;
  --pill-active-bg: #ea580c;
  --pill-active-text: #f9fafb;
  --conf-low-bg: #fee2e2;
  --conf-low-text: #b91c1c;
  --conf-med-bg: #fef3c7;
  --conf-med-text: #92400e;
  --conf-high-bg: #dcfce7;
  --conf-high-text: #166534;
  --conf-none-bg: #e5e7eb;
  --conf-none-text: #6b7280;
  --card-shadow: 0 10px 28px rgba(15,23,42,0.18);
  --logo-bg: #e5e7eb;
  --logo-border: #cbd5f5;
}
* {
  box-sizing: border-box;
}
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at top, #111827 0, var(--bg) 52%);
  color: var(--text);
  min-height: 100vh;
}
.page-shell {
  max-width: 1240px;
  margin: 0 auto;
  padding: 20px 16px 32px;
}
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  padding: 16px 20px;
  border-radius: 18px;
  background: linear-gradient(135deg, #020617, #0b1220);
  box-shadow: 0 18px 50px rgba(0,0,0,0.7);
  border: 1px solid rgba(148,163,184,0.25);
}
html[data-theme="light"] header {
  background: linear-gradient(135deg, #ffffff, #e5e7eb);
  box-shadow: 0 14px 45px rgba(15,23,42,0.15);
}
.brand-block {
  display: flex;
  align-items: center;
  gap: 14px;
}
.brand-logo-mark {
  width: 56px;
  height: 56px;
  border-radius: 18px;
  background: radial-gradient(circle at 25% 0, #f97316 0, #ea580c 32%, #020617 68%);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #f9fafb;
  font-weight: 800;
  letter-spacing: 0.08em;
  font-size: 11px;
  text-transform: uppercase;
  box-shadow: 0 0 24px rgba(248,113,113,0.45), 0 18px 40px rgba(0,0,0,0.8);
}
.brand-text-main {
  display: flex;
  flex-direction: column;
  gap: 3px;
}
.brand-title {
  font-size: 1.1rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  font-weight: 700;
}
.brand-subtitle {
  font-size: 0.78rem;
  text-transform: uppercase;
  letter-spacing: 0.18em;
  color: var(--accent-soft);
}
.brand-tagline {
  font-size: 0.8rem;
  color: var(--text-soft);
}
.brand-link {
  color: var(--accent-soft);
  font-weight: 600;
  font-size: 0.82rem;
  text-decoration: none;
}
.header-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 8px;
}
.theme-toggle {
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.55);
  background: rgba(15,23,42,0.8);
  color: var(--text);
  padding: 6px 12px;
  font-size: 0.8rem;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  backdrop-filter: blur(12px);
}
html[data-theme="light"] .theme-toggle {
  background: rgba(255,255,255,0.85);
}
.theme-toggle span.mode-label {
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}
.theme-toggle span.mode-sub {
  font-size: 0.7rem;
  color: var(--text-soft);
}
.meta-row {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.75rem;
  color: var(--text-soft);
}
.meta-dot {
  width: 5px;
  height: 5px;
  border-radius: 999px;
  background: #22c55e;
}
.filters-bar {
  margin-top: 18px;
  margin-bottom: 10px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
  justify-content: space-between;
}
.filters-row-left {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}
.filters-row-right {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}
.filter-label {
  font-size: 0.78rem;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--text-soft);
}
.filter-pill {
  border-radius: 999px;
  border: 1px solid var(--pill-border);
  padding: 5px 11px;
  font-size: 0.8rem;
  background: var(--pill-bg);
  color: var(--text-soft);
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}
.filter-pill span.dot {
  width: 7px;
  height: 7px;
  border-radius: 999px;
  background: var(--pill-border);
}
.filter-pill.active {
  background: var(--pill-active-bg);
  color: var(--pill-active-text);
  border-color: transparent;
}
.filter-pill.active span.dot {
  background: #fefce8;
}
.legend {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  font-size: 0.72rem;
  color: var(--text-soft);
}
.legend-item {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}
.legend-swatch {
  width: 10px;
  height: 10px;
  border-radius: 999px;
}
.legend-swatch.low {
  background: var(--conf-low-bg);
}
.legend-swatch.med {
  background: var(--conf-med-bg);
}
.legend-swatch.high {
  background: var(--conf-high-bg);
}
.legend-swatch.none {
  background: var(--conf-none-bg);
}
.main-panel {
  margin-top: 6px;
  background: radial-gradient(circle at top, rgba(15,23,42,0.6), var(--bg-elevated));
  border-radius: 20px;
  padding: 18px 14px 18px;
  border: 1px solid rgba(55,65,81,0.75);
  box-shadow: 0 16px 50px rgba(0,0,0,0.8);
}
html[data-theme="light"] .main-panel {
  background: linear-gradient(135deg, #f9fafb, #e5e7eb);
  border-color: rgba(148,163,184,0.6);
  box-shadow: 0 10px 30px rgba(15,23,42,0.2);
}
.date-header {
  margin: 18px 4px 8px;
  padding-bottom: 4px;
  border-bottom: 1px solid rgba(75,85,99,0.6);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.date-title {
  font-size: 0.9rem;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}
.date-sub {
  font-size: 0.78rem;
  color: var(--text-soft);
}
.sport-header {
  margin: 12px 4px 6px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.sport-pill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  border-radius: 999px;
  padding: 3px 10px;
  font-size: 0.78rem;
  border: 1px solid rgba(75,85,99,0.9);
  background: rgba(15,23,42,0.9);
}
html[data-theme="light"] .sport-pill {
  background: rgba(255,255,255,0.95);
}
.sport-dot {
  width: 8px;
  height: 8px;
  border-radius: 999px;
}
.sport-pill span.label {
  text-transform: uppercase;
  letter-spacing: 0.16em;
  font-weight: 600;
}
.sport-subtext {
  font-size: 0.72rem;
  color: var(--text-soft);
}
.sport-nfl .sport-dot {
  background: var(--sport-nfl);
}
.sport-ncaaf .sport-dot {
  background: var(--sport-ncaaf);
}
.sport-nba .sport-dot {
  background: var(--sport-nba);
}
.sport-ncaab .sport-dot {
  background: var(--sport-ncaab);
}
.sport-nhl .sport-dot {
  background: var(--sport-nhl);
}
.sport-ufc .sport-dot {
  background: var(--sport-ufc);
}
.cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(290px, 1fr));
  gap: 12px;
}
.game-card {
  position: relative;
  border-radius: var(--card-radius);
  padding: 12px 11px 11px;
  background: radial-gradient(circle at top left, var(--bg-card) 0, var(--bg-card-soft) 52%);
  box-shadow: var(--card-shadow);
  border: 1px solid rgba(31,41,55,0.95);
  display: flex;
  flex-direction: column;
  gap: 8px;
  transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, border-color 0.12s ease-out, background 0.12s ease-out, opacity 0.12s ease-out;
}
html[data-theme="light"] .game-card {
  background: radial-gradient(circle at top left, #ffffff 0, #e5e7eb 60%);
  border-color: rgba(148,163,184,0.7);
}
.game-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 20px 50px rgba(0,0,0,0.9);
  border-color: rgba(248,113,113,0.55);
}
html[data-theme="light"] .game-card:hover {
  box-shadow: 0 16px 42px rgba(15,23,42,0.25);
}
.game-card.no-confidence {
  opacity: 0.6;
  border-style: dashed;
}
.game-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
}
.teams-stack {
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.matchup-line {
  font-size: 0.9rem;
  font-weight: 600;
}
.matchup-line span.separator {
  margin: 0 2px;
  color: var(--text-soft);
}
.teams-line {
  font-size: 0.78rem;
  color: var(--text-soft);
}
.time-line {
  font-size: 0.76rem;
  color: var(--text-soft);
}
.time-line span {
  margin-right: 6px;
}
.logo-row {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.team-row {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.78rem;
}
.team-logo-wrap {
  width: 26px;
  height: 26px;
  border-radius: 999px;
  background: radial-gradient(circle at 30% 0, #1f2937 0, var(--logo-bg) 70%);
  border: 1px solid var(--logo-border);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  flex-shrink: 0;
}
html[data-theme="light"] .team-logo-wrap {
  background: radial-gradient(circle at 30% 0, #e5e7eb 0, #f3f4f6 70%);
}
.team-logo-img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  display: none;
}
.team-logo-fallback {
  font-size: 0.66rem;
  font-weight: 700;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: #e5e7eb;
}
html[data-theme="light"] .team-logo-fallback {
  color: #0f172a;
}
.team-name {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.team-role-tag {
  font-size: 0.7rem;
  padding: 1px 7px;
  border-radius: 999px;
  border: 1px solid rgba(55,65,81,0.7);
  color: var(--text-soft);
}
.odds-line {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 0.75rem;
  color: var(--text-soft);
}
.odds-line span.key {
  font-weight: 600;
  color: var(--accent-soft);
}
.odds-line span.value {
  font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
.pick-row {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 6px;
  margin-top: 4px;
}
.pick-pill {
  border-radius: 14px;
  padding: 4px 5px 5px;
  font-size: 0.72rem;
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.pick-pill.low {
  background: var(--conf-low-bg);
  color: var(--conf-low-text);
}
.pick-pill.med {
  background: var(--conf-med-bg);
  color: var(--conf-med-text);
}
.pick-pill.high {
  background: var(--conf-high-bg);
  color: var(--conf-high-text);
  box-shadow: 0 0 14px rgba(34,197,94,0.55);
}
.pick-pill.none {
  background: var(--conf-none-bg);
  color: var(--conf-none-text);
}
.pick-label-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 4px;
}
.pick-type {
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.64rem;
  opacity: 0.9;
}
.pick-conf {
  font-size: 0.7rem;
  font-weight: 600;
}
.pick-main {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.pick-main span.line {
  font-family: "JetBrains Mono", ui-monospace, monospace;
}
.book-tag {
  position: absolute;
  top: 8px;
  right: 10px;
  font-size: 0.68rem;
  padding: 2px 7px;
  border-radius: 999px;
  background: rgba(15,23,42,0.95);
  border: 1px solid rgba(55,65,81,0.9);
  color: var(--text-soft);
}
html[data-theme="light"] .book-tag {
  background: rgba(255,255,255,0.95);
}
@media (max-width: 720px) {
  header {
    flex-direction: column;
    align-items: flex-start;
  }
  .header-right {
    width: 100%;
    align-items: flex-start;
  }
  .filters-bar {
    flex-direction: column;
    align-items: flex-start;
  }
  .main-panel {
    padding: 14px 10px 16px;
  }
}
</style>
</head>
<body>
<div class="page-shell">
  <header>
    <div class="brand-block">
      <div class="brand-logo-mark">FBF</div>
      <div class="brand-text-main">
        <div class="brand-title">Forged By Freedom Strength and Nutrition</div>
        <div class="brand-subtitle">Strength · Discipline · Freedom</div>
        <div class="brand-tagline">For all your training, supplementation and nutrition needs</div>
        <a href="https://forgedbyfreedom.org" class="brand-link" target="_blank" rel="noopener noreferrer">ForgedByFreedom.org</a>
      </div>
    </div>
    <div class="header-right">
      <button id="theme-toggle" class="theme-toggle" type="button">
        <span class="emoji">🔥</span>
        <span class="mode-label">Black Ops</span>
        <span class="mode-sub">Tactical Dark Mode</span>
      </button>
      <div class="meta-row">
        <div class="meta-dot"></div>
        <span id="last-updated">Last updated: --</span>
      </div>
    </div>
  </header>

  <div class="filters-bar">
    <div class="filters-row-left">
      <span class="filter-label">Filter sports</span>
      <button class="filter-pill active" data-sport-filter="all" type="button">
        <span class="dot"></span><span>All</span>
      </button>
      <button class="filter-pill" data-sport-filter="americanfootball_nfl" type="button">
        <span class="dot"></span><span>NFL</span>
      </button>
      <button class="filter-pill" data-sport-filter="americanfootball_ncaaf" type="button">
        <span class="dot"></span><span>NCAAF</span>
      </button>
      <button class="filter-pill" data-sport-filter="basketball_nba" type="button">
        <span class="dot"></span><span>NBA</span>
      </button>
      <button class="filter-pill" data-sport-filter="basketball_ncaab" type="button">
        <span class="dot"></span><span>NCAAB</span>
      </button>
      <button class="filter-pill" data-sport-filter="icehockey_nhl" type="button">
        <span class="dot"></span><span>NHL</span>
      </button>
      <button class="filter-pill" data-sport-filter="mma_mixed_martial_arts" type="button">
        <span class="dot"></span><span>UFC</span>
      </button>
    </div>
    <div class="filters-row-right">
      <div class="legend">
        <div class="legend-item"><span class="legend-swatch low"></span><span>Low 0–55%</span></div>
        <div class="legend-item"><span class="legend-swatch med"></span><span>Med 56–69%</span></div>
        <div class="legend-item"><span class="legend-swatch high"></span><span>High 70%+</span></div>
        <div class="legend-item"><span class="legend-swatch none"></span><span>No data</span></div>
      </div>
    </div>
  </div>

  <div class="main-panel">
    <div id="game-container"></div>
  </div>
</div>

<script>
(function() {
  const SPORT_META = {
    "americanfootball_nfl": { label: "NFL", order: 1, tag: "Pro Football Sunday Slate" },
    "americanfootball_ncaaf": { label: "NCAAF", order: 2, tag: "College Football Board" },
    "basketball_nba": { label: "NBA", order: 3, tag: "Pro Hoops Card" },
    "basketball_ncaab": { label: "NCAAB", order: 4, tag: "College Hoops Board" },
    "icehockey_nhl": { label: "NHL", order: 5, tag: "NHL Slate" },
    "mma_mixed_martial_arts": { label: "UFC", order: 6, tag: "Fight Card" }
  };

  let allGames = [];
  let activeSportFilter = "all";

  function initTheme() {
    const stored = localStorage.getItem("fbf-theme");
    const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
    let theme = stored || (prefersDark ? "dark" : "dark");
    setTheme(theme);
    const btn = document.getElementById("theme-toggle");
    if (!btn) return;
    btn.addEventListener("click", () => {
      theme = (document.documentElement.getAttribute("data-theme") === "dark") ? "light" : "dark";
      setTheme(theme);
      localStorage.setItem("fbf-theme", theme);
    });
  }

  function setTheme(theme) {
    document.documentElement.setAttribute("data-theme", theme);
    const btn = document.getElementById("theme-toggle");
    if (!btn) return;
    const emoji = btn.querySelector(".emoji");
    const label = btn.querySelector(".mode-label");
    const sub = btn.querySelector(".mode-sub");
    if (theme === "dark") {
      emoji.textContent = "🔥";
      label.textContent = "Black Ops";
      sub.textContent = "Tactical Dark Mode";
    } else {
      emoji.textContent = "🌤️";
      label.textContent = "Light Patrol";
      sub.textContent = "Clean Light Mode";
    }
  }

  function initFilters() {
    document.querySelectorAll(".filter-pill").forEach(btn => {
      btn.addEventListener("click", () => {
        const sport = btn.getAttribute("data-sport-filter");
        if (!sport) return;
        activeSportFilter = sport;
        document.querySelectorAll(".filter-pill").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        renderGames();
      });
    });
  }

  function loadData() {
    fetch("combined.json?_=" + Date.now())
      .then(r => r.json())
      .then(j => {
        allGames = Array.isArray(j.data) ? j.data.slice() : [];
        const tsEl = document.getElementById("last-updated");
        if (tsEl && j.timestamp) {
          tsEl.textContent = "Last updated: " + formatTimestampReadable(j.timestamp);
        }
        renderGames();
      })
      .catch(err => {
        console.error(err);
        const container = document.getElementById("game-container");
        if (container) {
          container.innerHTML = "<div style=\"padding:8px 6px;font-size:0.8rem;color:#fca5a5;\">Failed to load combined.json</div>";
        }
      });
  }

  function formatTimestampReadable(ts) {
    if (!ts) return "--";
    if (/^\d{12}$/.test(ts)) {
      const year = ts.slice(0,4);
      const month = ts.slice(4,6);
      const day = ts.slice(6,8);
      const hour = ts.slice(8,10);
      const minute = ts.slice(10,12);
      return year + "-" + month + "-" + day + " " + hour + ":" + minute + " UTC";
    }
    return ts;
  }

  function parseDateSafe(iso) {
    if (!iso) return null;
    const d = new Date(iso);
    if (isNaN(d.getTime())) return null;
    return d;
  }

  function dateKey(d) {
    const y = d.getFullYear();
    const m = String(d.getMonth() + 1).padStart(2, "0");
    const day = String(d.getDate()).padStart(2, "0");
    return y + "-" + m + "-" + day;
  }

  function formatDateHuman(d) {
    const wd = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][d.getDay()];
    const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    const month = months[d.getMonth()];
    const day = d.getDate();
    const year = d.getFullYear();
    return wd + " · " + month + " " + day + ", " + year;
  }

  function formatTime(d) {
    let h = d.getHours();
    const m = String(d.getMinutes()).padStart(2,"0");
    const ampm = h >= 12 ? "PM" : "AM";
    h = h % 12;
    if (h === 0) h = 12;
    return h + ":" + m + " " + ampm;
  }

  function sportOrder(key) {
    return SPORT_META[key] ? SPORT_META[key].order : 99;
  }

  function sportLabel(key) {
    return SPORT_META[key] ? SPORT_META[key].label : key || "Other";
  }

  function sportTag(key) {
    return SPORT_META[key] ? SPORT_META[key].tag : "";
  }

  function teamSlug(name) {
    if (!name) return "";
    return name.toLowerCase().replace(/[^a-z0-9]+/g, "-").replace(/^-+|-+$/g,"");
  }

  function teamInitials(name) {
    if (!name) return "";
    const parts = name.split(/\s+/).filter(Boolean);
    if (!parts.length) return "";
    if (parts.length === 1) {
      return parts[0].slice(0,2).toUpperCase();
    }
    return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();
  }

  function computeConfidence(game) {
    const spread = typeof game.spread === "number" ? game.spread : null;
    const total = typeof game.total === "number" ? game.total : null;
    let su = null;
    let ats = null;
    let ou = null;
    if (spread !== null) {
      const abs = Math.abs(spread);
      const suBoost = Math.min(abs * 3.2, 18);
      su = 50 + suBoost;
      if (su > 70) su = 70;
      if (su < 52) su = 52;
      const atsAdj = Math.max(0, 4 - abs);
      ats = 53 + atsAdj * 1.5;
      if (ats > 60) ats = 60;
    }
    if (total !== null) {
      const mid = 45;
      const diff = Math.abs(total - mid);
      const ouBoost = Math.min(diff * 0.25, 7);
      ou = 53 + ouBoost;
      if (ou > 60) ou = 60;
    }
    return {
      su: su ? Math.round(su) : null,
      ats: ats ? Math.round(ats) : null,
      ou: ou ? Math.round(ou) : null
    };
  }

  function confClass(val) {
    if (val === null || val === undefined) return "none";
    if (val <= 55) return "low";
    if (val <= 69) return "med";
    return "high";
  }

  function hasAnyConfidence(obj) {
    return !!(obj.su || obj.ats || obj.ou);
  }

  function renderGames() {
    const container = document.getElementById("game-container");
    if (!container) return;
    container.innerHTML = "";
    const filtered = allGames.filter(g => {
      if (activeSportFilter === "all") return true;
      return g.sport_key === activeSportFilter;
    });
    const withDates = filtered.map(g => {
      const d = parseDateSafe(g.commence_time);
      return { game: g, date: d };
    }).filter(x => x.date !== null);

    withDates.sort((a,b) => {
      const dkA = dateKey(a.date);
      const dkB = dateKey(b.date);
      if (dkA < dkB) return -1;
      if (dkA > dkB) return 1;
      const soA = sportOrder(a.game.sport_key);
      const soB = sportOrder(b.game.sport_key);
      if (soA !== soB) return soA - soB;
      return a.date - b.date;
    });

    if (!withDates.length) {
      container.innerHTML = "<div style=\"padding:10px 6px;font-size:0.82rem;color:var(--text-soft);\">No games available for this filter.</div>";
      return;
    }

    let currentDateKey = "";
    let currentSportKey = "";
    let currentCardsGrid = null;

    withDates.forEach(item => {
      const g = item.game;
      const dt = item.date;
      const dk = dateKey(dt);
      if (dk !== currentDateKey) {
        currentDateKey = dk;
        currentSportKey = "";
        currentCardsGrid = null;
        const dh = document.createElement("div");
        dh.className = "date-header";
        const title = document.createElement("div");
        title.className = "date-title";
        title.textContent = formatDateHuman(dt);
        const sub = document.createElement("div");
        sub.className = "date-sub";
        sub.textContent = "Sorted by sport, then kickoff";
        dh.appendChild(title);
        dh.appendChild(sub);
        container.appendChild(dh);
      }

      if (g.sport_key !== currentSportKey) {
        currentSportKey = g.sport_key;
        currentCardsGrid = null;
        const sh = document.createElement("div");
        sh.className = "sport-header";
        const pill = document.createElement("div");
        const sportLabelText = sportLabel(g.sport_key);
        const sportTagText = sportTag(g.sport_key);
        pill.className = "sport-pill sport-" + sportLabelText.toLowerCase();
        const dot = document.createElement("div");
        dot.className = "sport-dot";
        const lab = document.createElement("span");
        lab.className = "label";
        lab.textContent = sportLabelText;
        pill.appendChild(dot);
        pill.appendChild(lab);
        const st = document.createElement("div");
        st.className = "sport-subtext";
        st.textContent = sportTagText;
        sh.appendChild(pill);
        sh.appendChild(st);
        container.appendChild(sh);
      }

      if (!currentCardsGrid) {
        currentCardsGrid = document.createElement("div");
        currentCardsGrid.className = "cards-grid";
        container.appendChild(currentCardsGrid);
      }

      currentCardsGrid.appendChild(buildGameCard(g, dt));
    });
  }

  function buildGameCard(game, dt) {
    const card = document.createElement("div");
    const conf = computeConfidence(game);
    const anyConf = hasAnyConfidence(conf);
    card.className = "game-card" + (anyConf ? "" : " no-confidence");

    const bookTag = document.createElement("div");
    bookTag.className = "book-tag";
    bookTag.textContent = (game.book || "book").toUpperCase();
    card.appendChild(bookTag);

    const header = document.createElement("div");
    header.className = "game-card-header";

    const teamsStack = document.createElement("div");
    teamsStack.className = "teams-stack";

    const matchupLine = document.createElement("div");
    matchupLine.className = "matchup-line";
    const awayName = game.away_team || "Away";
    const homeName = game.home_team || "Home";
    const sportLbl = sportLabel(game.sport_key);
    matchupLine.textContent = awayName + " @ " + homeName;

    const teamsLine = document.createElement("div");
    teamsLine.className = "teams-line";
    teamsLine.textContent = sportLbl;

    const timeLine = document.createElement("div");
    timeLine.className = "time-line";
    const timeSpan = document.createElement("span");
    timeSpan.textContent = formatTime(dt);
    const zoneSpan = document.createElement("span");
    zoneSpan.textContent = "Local Time";
    timeLine.appendChild(timeSpan);
    timeLine.appendChild(zoneSpan);

    teamsStack.appendChild(matchupLine);
    teamsStack.appendChild(teamsLine);
    teamsStack.appendChild(timeLine);

    const logoRow = document.createElement("div");
    logoRow.className = "logo-row";
    logoRow.appendChild(buildTeamRow(awayName, "Away"));
    logoRow.appendChild(buildTeamRow(homeName, "Home"));

    header.appendChild(teamsStack);
    header.appendChild(logoRow);
    card.appendChild(header);

    const oddsLine = document.createElement("div");
    oddsLine.className = "odds-line";
    const spreadPart = document.createElement("span");
    spreadPart.className = "value";
    const favorite = game.favorite || "";
    const underdog = game.underdog || "";
    const totalVal = typeof game.total === "number" ? game.total : null;
    let spreadLabel = "";
    if (favorite && underdog) {
      spreadLabel = favorite + " / " + underdog;
    } else if (favorite) {
      spreadLabel = favorite;
    } else if (underdog) {
      spreadLabel = underdog;
    } else {
      spreadLabel = "No line";
    }
    spreadPart.textContent = spreadLabel;
    const totalPart = document.createElement("span");
    totalPart.className = "value";
    totalPart.textContent = totalVal ? "Total " + totalVal.toFixed(1) : "Total --";
    oddsLine.appendChild(spreadPart);
    oddsLine.appendChild(totalPart);
    card.appendChild(oddsLine);

    const pickRow = document.createElement("div");
    pickRow.className = "pick-row";
    pickRow.appendChild(buildPickPill("SU", buildSUPick(game), conf.su));
    pickRow.appendChild(buildPickPill("ATS", buildATSPick(game), conf.ats));
    pickRow.appendChild(buildPickPill("O/U", buildOUPick(game), conf.ou));
    card.appendChild(pickRow);

    return card;
  }

  function buildTeamRow(name, role) {
    const row = document.createElement("div");
    row.className = "team-row";
    const wrap = document.createElement("div");
    wrap.className = "team-logo-wrap";
    const img = document.createElement("img");
    img.className = "team-logo-img";
    const slug = teamSlug(name);
    if (slug) {
      img.src = "logos/" + slug + ".png";
      img.onload = function() {
        img.style.display = "block";
        fallback.style.display = "none";
      };
      img.onerror = function() {
        img.style.display = "none";
        fallback.style.display = "flex";
      };
    }
    const fallback = document.createElement("div");
    fallback.className = "team-logo-fallback";
    fallback.textContent = teamInitials(name);
    wrap.appendChild(img);
    wrap.appendChild(fallback);

    const nameSpan = document.createElement("div");
    nameSpan.className = "team-name";
    nameSpan.textContent = name;

    const roleTag = document.createElement("div");
    roleTag.className = "team-role-tag";
    roleTag.textContent = role;

    row.appendChild(wrap);
    row.appendChild(nameSpan);
    row.appendChild(roleTag);
    return row;
  }

  function buildSUPick(game) {
    const fav = game.fav_team || null;
    const dog = game.dog_team || null;
    if (fav) {
      return fav + " ML";
    }
    if (dog) {
      return dog + " ML";
    }
    return null;
  }

  function buildATSPick(game) {
    const fav = game.fav_team;
    const dog = game.dog_team;
    const favSpread = typeof game.fav_spread === "number" ? game.fav_spread : null;
    const dogSpread = typeof game.dog_spread === "number" ? game.dog_spread : null;
    if (fav && favSpread !== null) {
      const line = favSpread > 0 ? "+" + favSpread : favSpread;
      return fav + " " + line;
    }
    if (dog && dogSpread !== null) {
      const line = dogSpread > 0 ? "+" + dogSpread : dogSpread;
      return dog + " " + line;
    }
    return null;
  }

  function buildOUPick(game) {
    const total = typeof game.total === "number" ? game.total : null;
    if (!total) return null;
    const base = sportLabel(game.sport_key);
    const overLean = total >= 46;
    return (overLean ? "Over " : "Under ") + total.toFixed(1);
  }

  function buildPickPill(type, pickText, confVal) {
    const pill = document.createElement("div");
    const cls = confClass(confVal);
    pill.className = "pick-pill " + cls;
    const labelRow = document.createElement("div");
    labelRow.className = "pick-label-row";
    const typeSpan = document.createElement("div");
    typeSpan.className = "pick-type";
    typeSpan.textContent = type;
    const confSpan = document.createElement("div");
    confSpan.className = "pick-conf";
    confSpan.textContent = confVal ? confVal + "%" : "--";
    labelRow.appendChild(typeSpan);
    labelRow.appendChild(confSpan);
    const main = document.createElement("div");
    main.className = "pick-main";
    main.textContent = pickText || "--";
    pill.appendChild(labelRow);
    pill.appendChild(main);
    return pill;
  }

  document.addEventListener("DOMContentLoaded", function() {
    initTheme();
    initFilters();
    loadData();
    setInterval(function() {
      window.location.reload();
    }, 30 * 60 * 1000);
  });
})();
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forged By Freedom — Live Odds & Picks</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #0f0f0f;
        color: #f2f2f2;
        transition: background 0.3s, color 0.3s;
    }

    /* LIGHT MODE */
    body.light {
        background: #f7f7f7;
        color: #111;
    }

    /* HEADER */
    header {
        padding: 20px;
        text-align: center;
        background: #131313;
        border-bottom: 2px solid #222;
    }

    body.light header {
        background: #e8e8e8;
        border-bottom: 2px solid #ccc;
    }

    h1 { margin: 0; font-size: 32px; }
    h2 { margin: 8px 0; font-size: 18px; font-weight: 300; }

    .subline { opacity: 0.75; font-size: 15px; }

    /* TOGGLE BUTTON */
    #modeToggle {
        position: absolute;
        right: 20px;
        top: 20px;
        padding: 8px 14px;
        background: #222;
        color: #fff;
        border: 1px solid #555;
        cursor: pointer;
        border-radius: 6px;
    }

    body.light #modeToggle {
        background: #ddd;
        color: #000;
        border: 1px solid #aaa;
    }

    /* FILTER BAR */
    #filters {
        display: flex;
        gap: 10px;
        padding: 12px 20px;
        background: #1a1a1a;
        border-bottom: 2px solid #222;
    }

    body.light #filters {
        background: #ececec;
        border-bottom: 2px solid #cfcfcf;
    }

    select {
        padding: 6px;
        border-radius: 6px;
        border: 1px solid #444;
        background: #222;
        color: #fff;
    }
    body.light select {
        background: #fff;
        border: 1px solid #bbb;
        color: #111;
    }

    /* SECTION HEADERS */
    .date-header, .sport-header {
        font-size: 22px;
        margin: 25px 20px 5px;
        opacity: 0.85;
        border-bottom: 1px solid #444;
        padding-bottom: 4px;
    }

    body.light .date-header, body.light .sport-header {
        border-color: #ccc;
    }

    /* GRID */
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(330px, 1fr));
        gap: 15px;
        padding: 20px;
    }

    /* GAME CARD */
    .card {
        background: #161616;
        border: 1px solid #222;
        padding: 12px;
        border-radius: 10px;
        transition: 0.25s;
    }

    body.light .card {
        background: #fff;
        border: 1px solid #ccc;
    }

    .card.grey {
        opacity: 0.35;
        filter: grayscale(100%);
    }

    /* CONFIDENCE COLORS */
    .conf-low { background: rgba(200,40,40,0.25); }
    .conf-med { background: rgba(240,200,0,0.25); }
    .conf-high { background: rgba(0,180,60,0.25); box-shadow: 0 0 8px #00ff7f; }

    /* MATCHUP + LOGO */
    .matchup {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 17px;
        margin-bottom: 8px;
    }
    .team-logo {
        width: 34px;
        height: 34px;
        border-radius: 5px;
        background: #333;
    }

    .row-labels {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        opacity: 0.7;
        margin-top: 4px;
    }

    .row-values {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        font-weight: bold;
        margin-top: 4px;
    }
</style>

</head>
<body>

<header>
    <button id="modeToggle">🌙 Dark</button>
    <h1>Forged By Freedom Strength and Nutrition</h1>
    <h2>Strength - Discipline - Freedom</h2>
    <div class="subline">For all your training, supplementation and nutrition needs — ForgedByFreedom.org</div>
</header>

<!-- FILTERS -->
<div id="filters">
    <select id="filterDate"></select>
    <select id="filterSport"></select>
    <select id="filterConfidence">
        <option value="all">All Confidence</option>
        <option value="high">High (70%+)</option>
        <option value="med">Medium (56–69%)</option>
        <option value="low">Low (0–55%)</option>
    </select>
</div>

<div id="content"></div>

<script>
// ========= AUTO MODE TOGGLE =========
const toggle = document.getElementById("modeToggle");
toggle.onclick = () => {
    document.body.classList.toggle("light");
    toggle.textContent = document.body.classList.contains("light") ? "🌤️ Light" : "🌙 Dark";
};

// ========== LOAD DATA ==========
async function loadData() {
    const res = await fetch("combined.json");
    const json = await res.json();
    render(json.data);
}

function render(data) {
    const container = document.getElementById("content");
    container.innerHTML = "";

    // sort by date → sport → commence
    data.sort((a,b)=> {
        if (a.commence_time !== b.commence_time)
            return a.commence_time.localeCompare(b.commence_time);
        if (a.sport_key !== b.sport_key)
            return a.sport_key.localeCompare(b.sport_key);
        return 0;
    });

    let lastDate = "";
    let lastSport = "";

    data.forEach(game => {
        const date = game.commence_time.split("T")[0];
        if (date !== lastDate) {
            container.innerHTML += `<div class="date-header">${date}</div>`;
            lastDate = date;
            lastSport = "";
        }
        if (game.sport_key !== lastSport) {
            container.innerHTML += `<div class="sport-header">${game.sport_key.toUpperCase()}</div>`;
            lastSport = game.sport_key;
        }

        // pick card color class
        let confClass = "grey";
        const conf = 60; // placeholder until your model gives confidence

        if (conf >= 70) confClass = "conf-high";
        else if (conf >= 56) confClass = "conf-med";
        else confClass = "conf-low";

        container.innerHTML += `
            <div class="grid">
                <div class="card ${confClass}">
                    <div class="matchup">
                        <img class="team-logo" src="logo.png">
                        ${game.matchup}
                    </div>

                    <div class="row-labels">
                        <div>Straight Up</div>
                        <div>ATS</div>
                        <div>O/U</div>
                    </div>

                    <div class="row-values">
                        <div>${game.fav_team || "--"}</div>
                        <div>${game.spread || "--"}</div>
                        <div>${game.total || "--"}</div>
                    </div>
                </div>
            </div>
        `;
    });
}

// Auto reload every 30 min
setInterval(loadData, 30 * 60 * 1000);

loadData();
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Forged By Freedom — Live Odds & Picks</title>

<!-- Main Styles -->
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #0d0d0d;
        color: #e4e4e4;
    }

    /* === TOP NAVIGATION BAR === */
    .topbar {
        background: #131313;
        border-bottom: 2px solid #ff0000;
        padding: 20px;
        text-align: center;
    }

    .topbar h1 {
        margin: 0;
        font-size: 34px;
        font-weight: 800;
        color: #ffffff;
        letter-spacing: 1px;
        text-transform: uppercase;
    }

    .topbar h2 {
        margin: 6px 0 0 0;
        font-size: 16px;
        font-weight: 400;
        color: #d1d1d1;
        font-style: italic;
    }

    /* === CONTAINER === */
    .container {
        width: 90%;
        max-width: 1100px;
        margin: 20px auto;
    }

    /* === INFO PANEL === */
    .info-box {
        background: #1a1a1a;
        padding: 12px;
        border-left: 4px solid #ff0000;
        margin-bottom: 25px;
    }

    .info-box strong {
        color: #ffffff;
    }

    /* === GAME CARD === */
    .game-box {
        background: #141414;
        border: 1px solid #2a2a2a;
        padding: 18px;
        margin-bottom: 18px;
        border-radius: 8px;
        transition: 0.2s;
    }

    .game-box:hover {
        background: #1e1e1e;
    }

    .matchup {
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 10px;
        color: #ffffff;
    }

    /* === TABLE === */
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 8px;
    }

    th {
        text-align: left;
        padding-bottom: 6px;
        font-size: 14px;
        color: #e4e4e4;
    }

    td {
        padding: 6px 0;
        font-size: 16px;
    }

    /* === CONFIDENCE COLORS === */
    .conf-box {
        font-weight: bold;
        padding: 5px 10px;
        border-radius: 6px;
        display: inline-block;
        min-width: 95px;
        text-align: center;
        color: #000;
    }

    .green {
        background: #33ff57;
    }

    .yellow {
        background: #fff724;
    }

    .red {
        background: #ff4242;
    }

</style>
</head>
<body>

<!-- HEADER -->
<div class="topbar">
    <h1>Forged By Freedom</h1>
    <h2>Live Sports Odds — No Politics. No Bullshit. Just Data.</h2>
</div>

<div class="container">

    <!-- Confidence Legend -->
    <div class="info-box">
        <strong>Confidence Levels:</strong><br>
        <span class="conf-box red">0–55%</span> Low &nbsp;
        <span class="conf-box yellow">56–69%</span> Medium &nbsp;
        <span class="conf-box green">70%+</span> High
    </div>

    <div id="games"></div>

</div>

<!-- === SCRIPT SECTION === -->
<script>
async function loadData() {
    try {
        const response = await fetch("combined.json");
        const data = await response.json();
        displayGames(data.data);
    } catch (err) {
        console.error("Error loading combined.json:", err);
    }
}

function confColor(num) {
    if (num >= 70) return "green";
    if (num >= 56) return "yellow";
    return "red";
}

function format(num) {
    return (num === null || num === undefined)
        ? "--"
        : num.toFixed(1) + "%";
}

function displayGames(games) {
    const container = document.getElementById("games");
    container.innerHTML = "";

    games.forEach(g => {
        const su = g.su_conf ?? null;
        const ats = g.ats_conf ?? null;
        const ou = g.ou_conf ?? null;

        const box = document.createElement("div");
        box.className = "game-box";

        box.innerHTML = `
            <div class="matchup">${g.matchup}</div>

            <table>
                <tr>
                    <th>Straight Up</th>
                    <th>ATS</th>
                    <th>O/U</th>
                </tr>
                <tr>
                    <td><span class="conf-box ${confColor(su)}">${format(su)}</span></td>
                    <td><span class="conf-box ${confColor(ats)}">${format(ats)}</span></td>
                    <td><span class="conf-box ${confColor(ou)}">${format(ou)}</span></td>
                </tr>
            </table>
        `;

        container.appendChild(box);
    });
}

loadData();
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forged By Freedom — Live Odds & Picks</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body {
    background: #0e0e0e;
    color: #e0e0e0;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
  }
  h1 {
    color: #fff;
    text-align: center;
    margin-top: 10px;
    font-size: 32px;
  }
  .logo {
    display: block;
    margin: 0 auto 20px auto;
    height: 110px;
  }
  .confidence-box {
    padding: 14px;
    margin-bottom: 25px;
    background: #1a1a1a;
    border-radius: 10px;
    border: 1px solid #333;
    font-size: 15px;
    line-height: 1.6;
  }
  .sport-section {
    margin-top: 25px;
    margin-bottom: 10px;
    font-size: 22px;
    font-weight: bold;
    color: #58a6ff;
    border-bottom: 2px solid #333;
    padding-bottom: 6px;
  }
  .game {
    background: #161616;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 10px;
    border-left: 6px solid #444;
    box-shadow: 0 0 6px rgba(0,0,0,0.4);
  }
  .title {
    font-size: 20px;
    color: #fff;
    margin-bottom: 10px;
    font-weight: bold;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 6px;
  }
  th, td {
    padding: 7px;
    text-align: center;
    border: 1px solid #333;
  }
  th {
    background: #333;
    color: #fff;
    font-size: 14px;
  }
  /* FIXED yellow — cleaner, bright, no brown */
  .red    { background-color: #8a0000; }
  .yellow { background-color: #d6c400; color: #000; }
  .green  { background-color: #0f7d0f; }
</style>
<script>
async function loadData() {
  const response = await fetch("combined.json?cache=" + Math.random());
  const json = await response.json();
  const data = json.data || [];
  const container = document.getElementById("games");
  container.innerHTML = "";

  const sportsOrder = {
    "americanfootball_nfl": "NFL",
    "americanfootball_ncaaf": "NCAA Football",
    "basketball_nba": "NBA",
    "basketball_ncaab": "NCAA Basketball",
    "icehockey_nhl": "NHL",
    "mma_mixed_martial_arts": "UFC"
  };

  const grouped = {};
  data.forEach(game => {
    if (!grouped[game.sport_key]) grouped[game.sport_key] = [];
    grouped[game.sport_key].push(game);
  });

  Object.keys(sportsOrder).forEach(sportKey => {
    if (!grouped[sportKey]) return;

    container.innerHTML += `<div class="sport-section">${sportsOrder[sportKey]}</div>`;

    grouped[sportKey].forEach(game => {
      const su = game.su_confidence;
      const ats = game.ats_confidence;
      const ou = game.ou_confidence;

      function cc(v){
        if (v === null || v === undefined) return "";
        if (v >= 70) return "green";
        if (v >= 56) return "yellow";
        return "red";
      }

      container.innerHTML += `
        <div class="game ${cc(su)}">
          <div class="title">${game.matchup}</div>
          <table>
            <tr>
              <th>Straight Up</th>
              <th>ATS (${game.fav_spread !== null ? game.fav_spread : "--"})</th>
              <th>O/U (${game.total !== null ? game.total : "--"})</th>
            </tr>
            <tr>
              <td>${game.su_pick || "--"} (${su || "--"}%)</td>
              <td>${game.ats_pick || "--"} (${ats || "--"}%)</td>
              <td>${game.ou_pick || "--"} (${ou || "--"}%)</td>
            </tr>
          </table>
        </div>
      `;
    });
  });
}
</script>
</head>
<body onload="loadData()">
<img src="logo.png" class="logo">
<h1>Forged By Freedom — Live Odds & Picks</h1>
<div class="confidence-box">
  <strong>Low Confidence (0–55%)</strong> — Red<br>
  <strong>Medium Confidence (56–69%)</strong> — Yellow<br>
  <strong>High Confidence (70%+)</strong> — Green
</div>
<div id="games"></div>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forged By Freedom — Live Odds & Picks</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        background: #111;
        color: #ddd;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
    }
    h1 {
        color: #fff;
        text-align: center;
        margin-top: 10px;
    }
    .logo {
        display: block;
        margin: 0 auto 20px auto;
        height: 100px;
    }
    .confidence-box {
        padding: 10px;
        margin-bottom: 20px;
        background: #222;
        border-radius: 8px;
    }
    .game {
        background: #1c1c1c;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 8px;
        border-left: 5px solid #444;
    }
    .title {
        font-size: 20px;
        color: #fff;
        margin-bottom: 8px;
        font-weight: bold;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 6px;
    }
    th, td {
        padding: 6px;
        text-align: center;
        border: 1px solid #333;
    }
    th {
        background: #333;
        color: #fff;
    }
    .red    { background-color: #7a0000; }
    .yellow { background-color: #7a6a00; }
    .green  { background-color: #005f00; }
</style>

<script>
async function loadData() {
    const response = await fetch("combined.json?cache=" + Math.random());
    const json = await response.json();
    const data = json.data || [];

    const container = document.getElementById("games");
    container.innerHTML = "";

    data.forEach(game => {
        const su_conf = game.su_confidence || null;
        const ats_conf = game.ats_confidence || null;
        const ou_conf = game.ou_confidence || null;

        function colorClass(val) {
            if (val === null || val === undefined) return "";
            if (val >= 70) return "green";
            if (val >= 56) return "yellow";
            return "red";
        }

        const html = `
        <div class="game ${colorClass(su_conf)}">
            <div class="title">${game.matchup}</div>
            <table>
                <tr>
                    <th>Straight Up</th>
                    <th>ATS</th>
                    <th>O/U</th>
                </tr>
                <tr>
                    <td>${game.su_pick || "--"} (${su_conf || "--"}%)</td>
                    <td>${game.ats_pick || "--"} (${ats_conf || "--"}%)</td>
                    <td>${game.ou_pick || "--"} (${ou_conf || "--"}%)</td>
                </tr>
            </table>
        </div>`;
        container.innerHTML += html;
    });
}
</script>

</head>
<body onload="loadData()">

<img src="logo.png" class="logo">

<h1>Forged By Freedom — Live Game Odds & Picks</h1>

<div class="confidence-box">
    <strong>Low Confidence (0–55%)</strong> — Red<br>
    <strong>Medium Confidence (56–69%)</strong> — Yellow<br>
    <strong>High Confidence (70%+)</strong> — Green
</div>

<div id="games"></div>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forged By Freedom — Live Game Odds & Picks</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    background: #111;
    color: #eee;
}

/* Header */
#header {
    display: flex;
    align-items: center;
    padding: 10px 20px;
    background: #000;
    border-bottom: 3px solid #444;
}
#header img {
    height: 50px;
    margin-right: 15px;
}
#title-text {
    font-size: 24px;
    font-weight: bold;
}

/* Confidence legend */
.confidence-box { padding: 8px; border-radius: 6px; margin-bottom: 10px; }
.low { background: #662222; }
.medium { background: #664422; }
.high { background: #336622; }

/* Game card */
.game {
    background: #1c1c1c;
    margin: 12px;
    padding: 12px;
    border-radius: 8px;
}
.game h3 { margin: 0 0 6px 0; }

/* Table */
table {
    width: 100%;
    border-collapse: collapse;
}
td, th {
    padding: 6px;
    border-bottom: 1px solid #333;
}

/* Mobile */
@media (max-width: 600px) {
    #header img { height: 40px; }
    #title-text { font-size: 18px; }
    table, tr, td, th {
        font-size: 14px;
    }
}
</style>
</head>
<body>

<div id="header">
    <img src="logo.png" alt="Logo">
    <div id="title-text">Forged By Freedom — Live Game Odds & Picks</div>
</div>

<div class="confidence-box low">Low Confidence (0–55%) — Red</div>
<div class="confidence-box medium">Medium Confidence (56–69%) — Yellow</div>
<div class="confidence-box high">High Confidence (70%+) — Green</div>

<div id="games"></div>

<script>
// Color function
function color(pct) {
    if (pct >= 70) return 'high';
    if (pct >= 56) return 'medium';
    return 'low';
}

fetch("combined.json")
    .then(resp => resp.json())
    .then(json => {
        const container = document.getElementById("games");

        json.data.forEach(g => {
            // Simple confidence placeholders until we add the model
            const su_conf = (55 + Math.random() * 30).toFixed(1);
            const ats_conf = (55 + Math.random() * 30).toFixed(1);
            const ou_conf = (55 + Math.random() * 30).toFixed(1);

            const pick_su = g.favorite;
            const pick_ats = g.favorite + " (" + g.fav_spread + ")";
            const pick_ou = g.total ? "Over " + g.total : "—";

            container.innerHTML += `
                <div class="game">
                    <h3>${g.matchup}</h3>
                    <table>
                        <tr><th>Straight Up</th><th>ATS</th><th>O/U</th></tr>
                        <tr>
                            <td class="${color(su_conf)}">${pick_su} (${su_conf}%)</td>
                            <td class="${color(ats_conf)}">${pick_ats} (${ats_conf}%)</td>
                            <td class="${color(ou_conf)}">${pick_ou} (${ou_conf}%)</td>
                        </tr>
                    </table>
                </div>
            `;
        });
    });
</script>

</body>
</html>

