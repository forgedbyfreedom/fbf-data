<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forged By Freedom â€” Live Odds & Picks</title>

<style>
    body {
        background: #111;
        color: #fff;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
    }

    /* Header section */
    .header {
        text-align: center;
        padding: 20px 0 10px 0;
        background: #000;
        border-bottom: 3px solid #c00;
        position: relative;
    }

    /* Logo top-left */
    .logo {
        position: absolute;
        top: 10px;
        left: 15px;
        height: 90px;
    }

    h1 {
        font-size: 40px;
        margin: 0;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    .tagline {
        font-size: 18px;
        color: #ffcc66;
        margin-top: 5px;
    }

    .brand {
        margin-top: 10px;
        font-size: 20px;
        font-weight: bold;
        color: #ff3333;
    }

    /* Table formatting */
    table {
        width: 96%;
        margin: 20px auto;
        background: #222;
        border-collapse: collapse;
        border: 1px solid #444;
    }
    th, td {
        padding: 10px;
        border: 1px solid #444;
    }
    th {
        background: #333;
        font-size: 16px;
    }

    /* Color-coded picks */
    .pick-good     { background: rgba(0, 255, 0, 0.28); }
    .pick-medium   { background: rgba(255, 255, 0, 0.30); }
    .pick-bad      { background: rgba(255, 0, 0, 0.28); }

    /* Section headers */
    .sport-header {
        font-size: 26px;
        background: #551111;
        padding: 10px;
        margin-top: 40px;
        text-align: center;
        border-top: 3px solid #aa0000;
        border-bottom: 3px solid #aa0000;
    }

    .day-header {
        font-size: 22px;
        background: #333;
        padding: 8px;
        margin: 20px 0 0 0;
        text-align: left;
        border-left: 6px solid #ff3333;
    }
</style>
</head>

<body>

<!-- Logo -->
<img src="fbf_logo.png" class="logo">

<!-- Header -->
<div class="header">
    <h1>FORGED BY FREEDOM</h1>
    <div class="tagline">STRENGTH Â· DISCIPLINE Â· FREEDOM</div>
    <div class="brand">FORGEDBYFREEDOM.org</div>
</div>

<!-- Container -->
<div id="content" style="padding-bottom: 40px;"></div>

<script>
// Load combined odds
fetch("combined.json")
    .then(r => r.json())
    .then(json => render(json.data));

function render(games) {
    if (!games || games.length === 0) {
        document.getElementById("content").innerHTML =
            "<h2 style='text-align:center;margin-top:40px;'>No games available.</h2>";
        return;
    }

    // Sort:
    // 1) NFL + NCAAF first
    // 2) Then by start date
    games.sort((a, b) => {
        const priA = priority(a.sport_key);
        const priB = priority(b.sport_key);
        if (priA !== priB) return priA - priB;
        return new Date(a.commence_time) - new Date(b.commence_time);
    });

    let html = "";

    // Group by day + sport
    const groups = {};

    for (const g of games) {
        const day = g.commence_time.split("T")[0];
        if (!groups[day]) groups[day] = {};
        if (!groups[day][g.sport_key]) groups[day][g.sport_key] = [];
        groups[day][g.sport_key].push(g);
    }

    for (const day of Object.keys(groups)) {
        html += `<div class="day-header">ðŸ“… ${day}</div>`;

        for (const sport of Object.keys(groups[day])) {
            html += `<div class="sport-header">${sportName(sport)}</div>`;
            html += buildTable(groups[day][sport]);
        }
    }

    document.getElementById("content").innerHTML = html;
}

function priority(key) {
    if (key === "americanfootball_nfl") return 1;
    if (key === "americanfootball_ncaaf") return 2;
    return 10;
}

function sportName(key) {
    return {
        "americanfootball_nfl": "NFL Football",
        "americanfootball_ncaaf": "NCAA Football",
        "basketball_nba": "NBA Basketball",
        "basketball_ncaab": "NCAA Basketball",
        "icehockey_nhl": "NHL Hockey",
        "baseball_mlb": "MLB Baseball"
    }[key] || key.toUpperCase();
}

function buildTable(games) {
    let html = `
    <table>
    <tr>
        <th>Matchup</th>
        <th>Straight Up</th>
        <th>ATS</th>
        <th>O/U</th>
    </tr>
    `;

    for (const g of games) {
        // Spread is already attached to name
        const fav = g.favorite_team;
        const dog = g.dog_team;

        const spread = g.fav_spread;
        const total = g.total;

        // Predict picks using favorite + total
        const su_pick = fav;
        const ats_pick = fav + " " + (spread ?? 0);
        const ou_pick = total ? ("Over " + total) : "â€”";

        const su_conf = g.confidence?.su ?? 55;
        const ats_conf = g.confidence?.ats ?? 55;
        const ou_conf = g.confidence?.ou ?? 55;

        html += `
        <tr>
            <td>${g.away_team} @ ${g.home_team}<br>
                <span style="color:#0f0;">Fav:</span> ${fav} (${spread})
            </td>

            <td class="${color(su_conf)}">${su_pick} (${su_conf}%)</td>
            <td class="${color(ats_conf)}">${ats_pick} (${ats_conf}%)</td>
            <td class="${color(ou_conf)}">${ou_pick} (${ou_conf}%)</td>
        </tr>
        `;
    }

    html += "</table>";
    return html;
}

function color(c) {
    if (c >= 70) return "pick-good";
    if (c >= 55) return "pick-medium";
    return "pick-bad";
}
</script>

</body>
</html>

