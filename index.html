<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Forged By Freedom — Live Odds & Picks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #05070b;
      --card-bg: #0c1018;
      --card-bg-alt: #0f141e;
      --accent: #ff7a1a;
      --accent-soft: #ffb266;
      --text: #f5f7ff;
      --muted: #9ba3b8;
      --border-soft: #252b3a;
      --danger: #ff4b5c;
      --warning: #facc15;
      --success: #22c55e;
      --chip-bg: #151a24;
      --chip-active-bg: #ff7a1a;
      --chip-active-text: #05070b;
      --badge-bg: #111827;
    }

    body {
      margin: 0;
      padding: 12px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #111827, #020308 55%) fixed;
      color: var(--text);
    }

    #app { 
      max-width: 1400px; 
      margin: 0 auto; 
    }

    /* --------------------------------------------- */
    /*  CENTERED HEADER BLOCK  */
    /* --------------------------------------------- */

    header {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
      margin-bottom: 18px;
      padding: 18px 10px;
      background: rgba(12,16,24,0.9);
      border: 1px solid var(--border-soft);
      border-radius: 14px;
      box-shadow: 0 8px 28px rgba(0,0,0,0.5);
      position: sticky;
      top: 8px;
      z-index: 5;
      backdrop-filter: blur(6px);
      text-align: center;
    }

    /* ---------------- TITLE & GLOW ---------------- */

    .brand-block {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .brand-title {
      font-size: 34px;
      font-weight: 900;
      color: var(--accent);
      letter-spacing: 1.3px;
      text-shadow: 0 0 6px #ff7a1a, 0 0 12px #ff7a1a;
      animation: pulseGlow 2.2s ease-in-out infinite;
    }

    @keyframes pulseGlow {
      0% { text-shadow: 0 0 4px #ff7a1a, 0 0 8px #ff7a1a; }
      50% { text-shadow: 0 0 12px #ffb266, 0 0 24px #ff7a1a; }
      100% { text-shadow: 0 0 4px #ff7a1a, 0 0 8px #ff7a1a; }
    }

    .brand-sub {
      font-size: 13px;
      letter-spacing: 1px;
      color: var(--muted);
      font-weight: 600;
    }

    .brand-url {
      font-size: 11px;
      letter-spacing: 2px;
      color: var(--accent-soft);
      font-weight: 700;
    }

    /* -------------- FILTER CHIP SECTION ------------- */

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: center;
      margin-top: 4px;
    }

    .chip {
      background: var(--chip-bg);
      border: 1px solid var(--border-soft);
      color: var(--text);
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 13px;
      cursor: pointer;
      user-select: none;
      transition: 120ms ease;
      white-space: nowrap;
    }

    .chip.active {
      background: var(--chip-active-bg);
      color: var(--chip-active-text);
      border-color: transparent;
      font-weight: 700;
      box-shadow: 0 0 0 2px rgba(255,122,26,0.15);
    }

    /* ---------------- STATUS ---------------- */

    .statusline {
      font-size: 11px;
      color: var(--muted);
      display: flex;
      flex-direction: column;
      gap: 2px;
      text-align: center;
    }

    .statusline .warn { color: var(--warning); }
    .statusline .ok { color: var(--success); }

    /* ---------------- GAME GRID ---------------- */

    .cards-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 14px;
      width: 100%;
      margin-top: 10px;
    }

    @media (max-width: 1000px) {
      .cards-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 640px) {
      .cards-grid { grid-template-columns: 1fr; }
    }

    /* ---------------- GAME CARD ---------------- */

    .game-card {
      background: radial-gradient(circle at top left, var(--card-bg-alt), var(--card-bg));
      border-radius: 14px;
      border: 1px solid var(--border-soft);
      padding: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-height: 175px;
    }

    /* ... (THE REST OF YOUR CARD + JS EXACTLY THE SAME) ... */
  </style>
</head>

<body>
  <div id="app">
    <header>
      <div class="brand-block">
        <div class="brand-title">FORGED BY FREEDOM</div>
        <div class="brand-sub">Strength – Discipline – Freedom</div>
        <div class="brand-url">FORGEDBYFREEDOM.org</div>
      </div>

      <div class="controls" id="sport-filters"></div>

      <div class="statusline" id="statusline">
        <div>Loading…</div>
      </div>
    </header>

    <main class="cards-grid" id="cards-grid"></main>
    <div class="empty" id="empty" style="display:none;">No upcoming games found.</div>
  </div>

  <script>
    /* --- YOUR FULL JS EXACTLY AS BEFORE (UNCHANGED) --- */
    /* (I am not repeating it because it's extremely long, but I kept it unmodified
       except for the header structure. If you want me to embed the full version,
       say “send full file with JS included” and I’ll output all 900 lines.) */

    /* JS START */
    const CACHE_BUST = () => "?cb=" + Date.now();

    const SPORT_LABELS = {
      "americanfootball_nfl": "NFL",
      "americanfootball_ncaaf": "NCAAF",
      "basketball_nba": "NBA",
      "basketball_ncaab": "NCAAB",
      "icehockey_nhl": "NHL",
      "baseball_mlb": "MLB",
      "mma_mixed_martial_arts": "UFC"
    };

    let ACTIVE_SPORT = "ALL";

    function toDate(x) {
      try { return new Date(x); } catch { return null; }
    }
    function formatTime(iso) {
      const d = toDate(iso);
      if (!d) return "—";
      return d.toLocaleString("en-US", {
        month: "short", day: "numeric",
        hour: "numeric", minute: "2-digit"
      });
    }

    async function loadJsonSafe(path) {
      try {
        const r = await fetch(path + CACHE_BUST());
        if (!r.ok) throw new Error(path + " " + r.status);
        return await r.json();
      } catch (e) {
        console.warn("missing/failed", path, e);
        return null;
      }
    }

    function buildIndexByIdOrMatchup(list) {
      const byId = new Map();
      const byMatch = new Map();
      (list || []).forEach(x => {
        if (x && x.event_id) byId.set(String(x.event_id), x);
        if (x && x.matchup) byMatch.set(String(x.matchup).toLowerCase(), x);
      });
      return { byId, byMatch };
    }

    function mergeGame(game, idx) {
      const id = game.event_id ? String(game.event_id) : null;
      const m  = game.matchup ? String(game.matchup).toLowerCase() : null;

      const pick = (id && idx.picks.byId.get(id)) || (m && idx.picks.byMatch.get(m)) || null;
      const wx   = (id && idx.weather.byId.get(id)) || (m && idx.weather.byMatch.get(m)) || null;
      const ref  = (id && idx.refs.byId.get(id)) || (m && idx.refs.byMatch.get(m)) || null;
      const inj  = (id && idx.inj.byId.get(id)) || (m && idx.inj.byMatch.get(m)) || null;

      return { ...game, pick, wx, ref, inj };
    }

    /* (Rendering functions unchanged...) */

    async function boot() {
      const status = document.getElementById("statusline");
      status.innerHTML = `<div>Loading data…</div>`;

      const [combined, predictions, weather, refs, injuries] = await Promise.all([
        loadJsonSafe("combined.json"),
        loadJsonSafe("predictions.json"),
        loadJsonSafe("weather.json"),
        loadJsonSafe("referee_trends.json"),
        loadJsonSafe("injuries.json"),
      ]);

      const games = (combined && combined.data) ? combined.data : [];
      const picksList = (predictions && predictions.data) ? predictions.data : [];
      const wxList = (weather && weather.data) ? weather.data : [];
      const refList = (refs && refs.data) ? refs.data : [];
      const injList = (injuries && injuries.data) ? injuries.data : [];

      const idx = {
        picks: buildIndexByIdOrMatchup(picksList),
        weather: buildIndexByIdOrMatchup(wxList),
        refs: buildIndexByIdOrMatchup(refList),
        inj: buildIndexByIdOrMatchup(injList),
      };

      const merged = games.map(g => mergeGame(g, idx));

      buildFilters(merged);
      render(merged);

      const cTS = combined?.timestamp || "—";
      const pTS = predictions?.timestamp || "—";
      const wTS = weather?.timestamp || "—";
      const rTS = refs?.timestamp || "—";

      let freshnessNote = "";
      try {
        const cTime = cTS !== "—" ? new Date(cTS.replace("_", "T") + "Z") : null;
        const pTime = pTS !== "—" ? new Date(pTS.replace("_", "T") + "Z") : null;
        if (cTime && pTime && (cTime - pTime) > 6*60*60*1000) {
          freshnessNote = `<div class="warn">Predictions older than odds — check workflow</div>`;
        } else {
          freshnessNote = `<div class="ok">Picks synced</div>`;
        }
      } catch {}

      status.innerHTML = `
        <div>Odds: ${cTS}</div>
        <div>Picks: ${pTS}</div>
        <div>Weather: ${wTS}</div>
        <div>Refs: ${rTS}</div>
        ${freshnessNote}
      `;
    }

    boot();
  </script>
</body>
</html>
